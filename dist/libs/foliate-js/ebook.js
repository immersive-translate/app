(()=>{var Ll=Object.defineProperty;var Fl=(n,e)=>{for(var t in e)Ll(n,t,{get:e[t],enumerable:!0})};var Ol=(n,e)=>n.map((t,r,i)=>e(t,r,i)?r:null).filter(t=>t!=null),Qi=(n,e)=>[-1,...e,n.length].reduce(({xs:t,a:r},i)=>({xs:t?.concat([n.slice(r+1,i)])??[],a:i}),{}).xs,Ml=(n,e)=>n.slice(0,-1).concat([n[n.length-1].concat(e[0])]).concat(e.slice(1)),xr=/\d/,qt=/^epubcfi\((.*)\)$/,Yi=n=>n.replace(/[\^[\](),;=]/g,"^$&"),Ul=n=>qt.test(n)?n:`epubcfi(${n})`,Bl=n=>n.match(qt)?.[1]??n,Nl=n=>(...e)=>`epubcfi(${n(...e.map(t=>t.match(qt)?.[1]??t))})`,es=Nl((...n)=>n.join("!")),Pl=n=>{let e=[],t,r,i="",s=o=>(e.push(o),t=null,i=""),a=o=>(i+=o,r=!1);for(let o of Array.from(n.trim()).concat("")){if(o==="^"&&!r){r=!0;continue}if(t==="!")s(["!"]);else if(t===",")s([","]);else if(t==="/"||t===":")if(xr.test(o)){a(o);continue}else s([t,parseInt(i)]);else if(t==="~")if(xr.test(o)||o==="."){a(o);continue}else s(["~",parseFloat(i)]);else if(t==="@"){if(o===":"){s(["@",parseFloat(i)]),t="@";continue}if(xr.test(o)||o==="."){a(o);continue}else s(["@",parseFloat(i)])}else if(t==="["){o===";"&&!r?(s(["[",i]),t=";"):o===","&&!r?(s(["[",i]),t="["):o==="]"&&!r?s(["[",i]):a(o);continue}else if(t?.startsWith(";")){o==="="&&!r?(t=`;${i}`,i=""):o===";"&&!r?(s([t,i]),t=";"):o==="]"&&!r?s([t,i]):a(o);continue}(o==="/"||o===":"||o==="~"||o==="@"||o==="["||o==="!"||o===",")&&(t=o)}return e},ts=(n,e)=>Ol(n,([t])=>t===e),Hl=n=>{let e=[],t;for(let[r,i]of n){if(r==="/")e.push({index:i});else{let s=e[e.length-1];if(r===":")s.offset=i;else if(r==="~")s.temporal=i;else if(r==="@")s.spatial=(s.spatial??[]).concat(i);else if(r===";s")s.side=i;else if(r==="[")if(t==="/"&&i)s.id=i;else{s.text=(s.text??[]).concat(i);continue}}t=r}return e},Ji=n=>Qi(n,ts(n,"!")).map(Hl),at=n=>{let e=Pl(Bl(n)),t=ts(e,",");if(!t.length)return Ji(e);let[r,i,s]=Qi(e,t).map(Ji);return{parent:r,start:i,end:s}},$l=({index:n,id:e,offset:t,temporal:r,spatial:i,text:s,side:a})=>{let o=a?`;s=${a}`:"";return`/${n}`+(e?`[${Yi(e)}${o}]`:"")+(t!=null&&n%2?`:${t}`:"")+(r?`~${r}`:"")+(i?`@${i.join(":")}`:"")+(s||!e&&a?"["+(s?.map(Yi)?.join(",")??"")+o+"]":"")},ns=n=>n.parent?[n.parent,n.start,n.end].map(ns).join(","):n.map(e=>e.map($l).join("")).join("!"),mn=n=>Ul(ns(n)),Je=(n,e)=>typeof n=="string"?mn(Je(at(n),e)):n.parent?Ml(n.parent,n[e?"end":"start"]):n,Wl=(n,e)=>{typeof n=="string"&&(n=at(n)),typeof e=="string"&&(e=at(e)),n=Je(n),e=Je(e,!0);let t=n[n.length-1],r=e[e.length-1],i=[],s=[],a=[],o=!0,l=Math.max(t.length,r.length);for(let u=0;u<l;u++){let d=t[u],h=r[u];o&&=d?.index===h?.index&&!d?.offset&&!h?.offset,o?i.push(d):(d&&s.push(d),h&&a.push(h))}let c=n.slice(0,-1).concat([i]);return mn({parent:c,start:[s],end:[a]})},Vt=(n,e)=>{if(typeof n=="string"&&(n=at(n)),typeof e=="string"&&(e=at(e)),n.start||e.start)return Vt(Je(n),Je(e))||Vt(Je(n,!0),Je(e,!0));for(let t=0;t<Math.max(n.length,e.length);t++){let r=n[t],i=e[t],s=Math.max(r.length,i.length)-1;for(let a=0;a<=s;a++){let o=r[a],l=i[a];if(!o)return-1;if(!l||o.index>l.index)return 1;if(o.index<l.index)return-1;if(a===s){if(o.offset>l.offset)return 1;if(o.offset<l.offset)return-1}}}return 0},_r=({nodeType:n})=>n===3||n===4,pn=({nodeType:n})=>n===1,Sr=n=>{let e=Array.from(n.childNodes).filter(t=>_r(t)||pn(t)).reduce((t,r)=>{let i=t[t.length-1];return i?_r(r)?Array.isArray(i)?i.push(r):_r(i)?t[t.length-1]=[i,r]:t.push(r):pn(i)?t.push(null,r):t.push(r):t.push(r),t},[]);return pn(e[0])&&e.unshift("first"),pn(e[e.length-1])&&e.push("last"),e.unshift("before"),e.push("after"),e},jl=(n,e)=>n?Sr(n)[e]:null,Ar=(n,e)=>{let{id:t}=e[e.length-1];if(t){let s=n.ownerDocument.getElementById(t);if(s)return{node:s,offset:0}}for(let{index:s}of e){let a=jl(n,s);if(a==="first")return{node:n.firstChild??n};if(a==="last")return{node:n.lastChild??n};if(a==="before")return{node:n,before:!0};if(a==="after")return{node:n,after:!0};n=a}let{offset:r}=e[e.length-1];if(!Array.isArray(n))return{node:n,offset:r};let i=0;for(let s of n){let{length:a}=s.nodeValue;if(i+a>=r)return{node:s,offset:r-i};i+=a}},gn=(n,e)=>{let{parentNode:t,id:r}=n,i=Sr(t),s=i.findIndex(l=>Array.isArray(l)?l.some(c=>c===n):l===n),a=i[s];if(Array.isArray(a)){let l=0;for(let c of a)if(c===n){l+=e;break}else l+=c.nodeValue.length;e=l}let o={id:r,index:s,offset:e};return t!==n.ownerDocument.documentElement?gn(t).concat(o):[o]},rs=n=>{let{startContainer:e,startOffset:t,endContainer:r,endOffset:i}=n,s=gn(e,t);if(n.collapsed)return mn([s]);let a=gn(r,i);return Wl([s],[a])},wn=(n,e)=>{let t=Je(e),r=Je(e,!0),i=n.documentElement,s=Ar(i,t[0]),a=Ar(i,r[0]),o=n.createRange();return s.before?o.setStartBefore(s.node):s.after?o.setStartAfter(s.node):o.setStart(s.node,s.offset),a.before?o.setEndBefore(a.node):a.after?o.setEndAfter(a.node):o.setEnd(a.node,a.offset),o},is=n=>{let e=[],{parentNode:t}=n[0],r=gn(t);for(let[i,s]of Sr(t).entries()){let a=n[e.length];s===a&&e.push(mn([r.concat({id:a.id,index:i})]))}return e},Er=(n,e)=>Ar(n.documentElement,Je(e)).node,kr={fromIndex:n=>`/6/${(n+1)*2}`,toIndex:n=>n?.at(-1).index/2-1};function ft(n,e){var t=(n&65535)+(e&65535),r=(n>>16)+(e>>16)+(t>>16);return r<<16|t&65535}function Vl(n,e){return n<<e|n>>>32-e}function yn(n,e,t,r,i,s){return ft(Vl(ft(ft(e,n),ft(r,s)),i),t)}function ve(n,e,t,r,i,s,a){return yn(e&t|~e&r,n,e,i,s,a)}function xe(n,e,t,r,i,s,a){return yn(e&r|t&~r,n,e,i,s,a)}function _e(n,e,t,r,i,s,a){return yn(e^t^r,n,e,i,s,a)}function Ae(n,e,t,r,i,s,a){return yn(t^(e|~r),n,e,i,s,a)}function bn(n,e){n[e>>5]|=128<<e%32,n[(e+64>>>9<<4)+14]=e;var t,r,i,s,a,o=1732584193,l=-271733879,c=-1732584194,u=271733878;for(t=0;t<n.length;t+=16)r=o,i=l,s=c,a=u,o=ve(o,l,c,u,n[t],7,-680876936),u=ve(u,o,l,c,n[t+1],12,-389564586),c=ve(c,u,o,l,n[t+2],17,606105819),l=ve(l,c,u,o,n[t+3],22,-1044525330),o=ve(o,l,c,u,n[t+4],7,-176418897),u=ve(u,o,l,c,n[t+5],12,1200080426),c=ve(c,u,o,l,n[t+6],17,-1473231341),l=ve(l,c,u,o,n[t+7],22,-45705983),o=ve(o,l,c,u,n[t+8],7,1770035416),u=ve(u,o,l,c,n[t+9],12,-1958414417),c=ve(c,u,o,l,n[t+10],17,-42063),l=ve(l,c,u,o,n[t+11],22,-1990404162),o=ve(o,l,c,u,n[t+12],7,1804603682),u=ve(u,o,l,c,n[t+13],12,-40341101),c=ve(c,u,o,l,n[t+14],17,-1502002290),l=ve(l,c,u,o,n[t+15],22,1236535329),o=xe(o,l,c,u,n[t+1],5,-165796510),u=xe(u,o,l,c,n[t+6],9,-1069501632),c=xe(c,u,o,l,n[t+11],14,643717713),l=xe(l,c,u,o,n[t],20,-373897302),o=xe(o,l,c,u,n[t+5],5,-701558691),u=xe(u,o,l,c,n[t+10],9,38016083),c=xe(c,u,o,l,n[t+15],14,-660478335),l=xe(l,c,u,o,n[t+4],20,-405537848),o=xe(o,l,c,u,n[t+9],5,568446438),u=xe(u,o,l,c,n[t+14],9,-1019803690),c=xe(c,u,o,l,n[t+3],14,-187363961),l=xe(l,c,u,o,n[t+8],20,1163531501),o=xe(o,l,c,u,n[t+13],5,-1444681467),u=xe(u,o,l,c,n[t+2],9,-51403784),c=xe(c,u,o,l,n[t+7],14,1735328473),l=xe(l,c,u,o,n[t+12],20,-1926607734),o=_e(o,l,c,u,n[t+5],4,-378558),u=_e(u,o,l,c,n[t+8],11,-2022574463),c=_e(c,u,o,l,n[t+11],16,1839030562),l=_e(l,c,u,o,n[t+14],23,-35309556),o=_e(o,l,c,u,n[t+1],4,-1530992060),u=_e(u,o,l,c,n[t+4],11,1272893353),c=_e(c,u,o,l,n[t+7],16,-155497632),l=_e(l,c,u,o,n[t+10],23,-1094730640),o=_e(o,l,c,u,n[t+13],4,681279174),u=_e(u,o,l,c,n[t],11,-358537222),c=_e(c,u,o,l,n[t+3],16,-722521979),l=_e(l,c,u,o,n[t+6],23,76029189),o=_e(o,l,c,u,n[t+9],4,-640364487),u=_e(u,o,l,c,n[t+12],11,-421815835),c=_e(c,u,o,l,n[t+15],16,530742520),l=_e(l,c,u,o,n[t+2],23,-995338651),o=Ae(o,l,c,u,n[t],6,-198630844),u=Ae(u,o,l,c,n[t+7],10,1126891415),c=Ae(c,u,o,l,n[t+14],15,-1416354905),l=Ae(l,c,u,o,n[t+5],21,-57434055),o=Ae(o,l,c,u,n[t+12],6,1700485571),u=Ae(u,o,l,c,n[t+3],10,-1894986606),c=Ae(c,u,o,l,n[t+10],15,-1051523),l=Ae(l,c,u,o,n[t+1],21,-2054922799),o=Ae(o,l,c,u,n[t+8],6,1873313359),u=Ae(u,o,l,c,n[t+15],10,-30611744),c=Ae(c,u,o,l,n[t+6],15,-1560198380),l=Ae(l,c,u,o,n[t+13],21,1309151649),o=Ae(o,l,c,u,n[t+4],6,-145523070),u=Ae(u,o,l,c,n[t+11],10,-1120210379),c=Ae(c,u,o,l,n[t+2],15,718787259),l=Ae(l,c,u,o,n[t+9],21,-343485551),o=ft(o,r),l=ft(l,i),c=ft(c,s),u=ft(u,a);return[o,l,c,u]}function as(n){var e,t="",r=n.length*32;for(e=0;e<r;e+=8)t+=String.fromCharCode(n[e>>5]>>>e%32&255);return t}function Tr(n){var e,t=[];for(t[(n.length>>2)-1]=void 0,e=0;e<t.length;e+=1)t[e]=0;var r=n.length*8;for(e=0;e<r;e+=8)t[e>>5]|=(n.charCodeAt(e/8)&255)<<e%32;return t}function ql(n){return as(bn(Tr(n),n.length*8))}function Xl(n,e){var t,r=Tr(n),i=[],s=[],a;for(i[15]=s[15]=void 0,r.length>16&&(r=bn(r,n.length*8)),t=0;t<16;t+=1)i[t]=r[t]^909522486,s[t]=r[t]^1549556828;return a=bn(i.concat(Tr(e)),512+e.length*8),as(bn(s.concat(a),512+128))}function os(n){var e="0123456789abcdef",t="",r,i;for(i=0;i<n.length;i+=1)r=n.charCodeAt(i),t+=e.charAt(r>>>4&15)+e.charAt(r&15);return t}function Cr(n){return unescape(encodeURIComponent(n))}function ls(n){return ql(Cr(n))}function Gl(n){return os(ls(n))}function cs(n,e){return Xl(Cr(n),Cr(e))}function Zl(n,e){return os(cs(n,e))}function us(n,e,t){return e?t?cs(e,n):Zl(e,n):t?ls(n):Gl(n)}var Kl=n=>{let e=0,t=r=>{if(r.id=e++,r.subitems)for(let i of r.subitems)t(i)};for(let r of n)t(r);return n},ds=n=>n.map(e=>e.subitems?.length?[e,ds(e.subitems)].flat():e).flat(),Xt=class{constructor({toc:e,ids:t,splitHref:r,getFragment:i}){Kl(e);let s=ds(e),a=new Map;for(let[l,c]of s.entries()){let[u,d]=r(c?.href)??[],h={fragment:d,item:c};a.has(u)?a.get(u).items.push(h):a.set(u,{prev:s[l-1],items:[h]})}let o=new Map;for(let[l,c]of t.entries())a.has(c)?o.set(c,a.get(c)):o.set(c,o.get(t[l-1]));this.ids=t,this.map=o,this.getFragment=i}getProgress(e,t){let r=this.ids[e],i=this.map.get(r);if(!i)return null;let{prev:s,items:a}=i;if(!a)return s;if(!t||a.length===1&&!a[0].fragment)return a[0].item;let o=t.startContainer.getRootNode();for(let[l,{fragment:c}]of a.entries()){let u=this.getFragment(o,c);if(u&&t.comparePoint(u,0)>0)return a[l-1]?.item??s}return a[a.length-1].item}},vn=class{constructor(e,t,r){this.sizes=e.map(i=>i.linear==="no"?0:i.size),this.sizePerLoc=t,this.sizePerTimeUnit=r,this.sizeTotal=this.sizes.reduce((i,s)=>i+s,0)}getProgress(e,t){let{sizes:r,sizePerLoc:i,sizePerTimeUnit:s,sizeTotal:a}=this,o=r[e]??0,c=r.slice(0,e).reduce((h,m)=>h+m,0)+t*o,u=a-c,d=(1-t)*o;return{fraction:c/a,section:{current:e,total:r.length},location:{current:Math.floor(c/i),total:Math.ceil(a/i)},time:{section:d/s,total:u/s}}}getSection(e){let{sizes:t,sizeTotal:r}=this,i=e*r,s=-1,a=0,o=0;for(let[l,c]of t.entries()){let u=o+c;if(u>i){s=l,a=(i-o)/c;break}o=u}return[s,a]}};var It=n=>document.createElementNS("http://www.w3.org/2000/svg",n),xn=class{#e=It("svg");#t=new Map;constructor(){Object.assign(this.#e.style,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",pointerEvents:"none"});let e=matchMedia("(prefers-color-scheme: dark)"),t=()=>this.#e.style.mixBlendMode=e.matches?"normal":"multiply";e.addEventListener("change",t),t()}get element(){return this.#e}add(e,t,r,i){this.#t.has(e)&&this.remove(e),typeof t=="function"&&(t=t(this.#e.getRootNode()));let s=t.getClientRects(),a=r(s,i);this.#e.append(a),this.#t.set(e,{range:t,draw:r,options:i,element:a,rects:s})}remove(e){this.#t.has(e)&&(this.#e.removeChild(this.#t.get(e).element),this.#t.delete(e))}redraw(){for(let e of this.#t.values()){let{range:t,draw:r,options:i,element:s}=e;this.#e.removeChild(s);let a=t.getClientRects(),o=r(a,i);this.#e.append(o),e.element=o,e.rects=a}}hitTest({x:e,y:t}){let r=Array.from(this.#t.entries());for(let i=r.length-1;i>=0;i--){let[s,a]=r[i];for(let{left:o,top:l,right:c,bottom:u}of a.rects)if(l<=t&&o<=e&&u>t&&c>e)return[s,a.range]}return[]}static underline(e,t={}){let{color:r="red",width:i=2}=t,s=It("g");s.setAttribute("fill",r);for(let{left:a,bottom:o,width:l}of e){let c=It("rect");c.setAttribute("x",a),c.setAttribute("y",o-i),c.setAttribute("height",i),c.setAttribute("width",l),s.append(c)}return s}static highlight(e,t={}){let{color:r="red"}=t,i=It("g");i.setAttribute("fill",r),i.setAttribute("fill-opacity",.3);for(let{left:s,top:a,height:o,width:l}of e){let c=It("rect");c.setAttribute("x",s),c.setAttribute("y",a),c.setAttribute("height",o),c.setAttribute("width",l),i.append(c)}return i}static copyImage([e],t={}){let{src:r}=t,i=It("image"),{left:s,top:a,height:o,width:l}=e;return i.setAttribute("href",r),i.setAttribute("x",s),i.setAttribute("y",a),i.setAttribute("height",o),i.setAttribute("width",l),i}};var _n=class{#e=new Map;#t=new Map;#n=new Map;#r=new Map;constructor({resolve:e,compare:t,onAdd:r,onDelete:i,onUpdate:s}){this.resolve=e,this.compare=t,this.onAdd=r,this.onDelete=i,this.onUpdate=s}async add(e,t){let{value:r}=e;if(this.#t.has(r))return;let{index:i,anchor:s}=await this.resolve(r);if(this.#t.set(r,e),this.#r.set(r,i),this.#n.set(r,s),this.#e.has(i)){let a=this.#e.get(i);if(t)a.push(e),this.onAdd?.(e,i,a.length-1);else{let o=0;for(let l=0;l<a.length;l++){let c=a[l].value;if(this.compare(r,c)<=0)break;o=l+1}a.splice(o,0,e),this.onAdd?.(e,i,o)}}else this.#e.set(i,[e]),this.onAdd?.(e,i,0)}update(e){let t=this.#r.get(e.value),r=this.#t.get(e.value);Object.assign(r,e),this.onUpdate?.(e,t)}delete(e){let t=this.#r.get(e),r=this.#e.get(t),i=r.findIndex(s=>s.value===e);r.splice(i,1),this.#t.delete(e),this.#r.delete(e),this.#n.delete(e),this.onDelete?.(e,t,i)}getByIndex(e){return this.#e.get(e)??[]}getAnchor(e){return this.#n.get(e)}};var Yl=n=>new Promise(e=>setTimeout(e,n)),Jl=(n,e,t)=>{let r;return(...i)=>{let s=()=>{r=null,t||n(...i)},a=t&&!r;r&&clearTimeout(r),r=setTimeout(s,e),a&&n(...i)}},Ql=n=>{if(!n?.collapsed)return n;let{endOffset:e,endContainer:t}=n;if(t.nodeType===1)return t;if(e+1<t.length)n.setEnd(t,e+1);else if(e>1)n.setStart(t,e-1);else return t.parentNode;return n},An=(n,e,t,r=t)=>{let i=n.createRange();return i.setStart(e,t),i.setEnd(e,r),i},Sn=(n,e,t,r=0,i=e.nodeValue.length)=>{if(i-r===1)return t(An(n,e,r),An(n,e,i))<0?r:i;let s=Math.floor(r+(i-r)/2),a=t(An(n,e,r,s),An(n,e,s,i));return a<0?Sn(n,e,t,r,s):a>0?Sn(n,e,t,s,i):s},{SHOW_ELEMENT:ec,SHOW_TEXT:tc,SHOW_CDATA_SECTION:nc,FILTER_ACCEPT:hs,FILTER_REJECT:fs,FILTER_SKIP:ps}=NodeFilter,rc=ec|tc|nc,ic=(n,e,t,r)=>{let i=h=>{let m=h.localName?.toLowerCase();if(m==="script"||m==="style")return fs;if(h.nodeType===1){let{left:w,right:f}=r(h.getBoundingClientRect());if(f<e||w>t)return fs;if(w>=e&&f<=t)return hs}else{if(!h.nodeValue?.trim())return ps;let w=n.createRange();w.selectNodeContents(h);let{left:f,right:p}=r(w.getBoundingClientRect());if(p>=e&&f<=t)return hs}return ps},s=n.createTreeWalker(n.body,rc,{acceptNode:i}),a=[];for(let h=s.nextNode();h;h=s.nextNode())a.push(h);let o=a[0]??n.body,l=a[a.length-1]??o,c=o.nodeType===1?0:Sn(n,o,(h,m)=>{let w=r(h.getBoundingClientRect()),f=r(m.getBoundingClientRect());return w.right<e&&f.left>e?0:f.left>e?-1:1}),u=l.nodeType===1?0:Sn(n,l,(h,m)=>{let w=r(h.getBoundingClientRect()),f=r(m.getBoundingClientRect());return w.right<t&&f.left>t?0:f.left>t?-1:1}),d=n.createRange();return d.setStart(o,c),d.setEnd(l,u),d},sc=n=>{let{defaultView:e}=n,{writingMode:t,direction:r}=e.getComputedStyle(n.body),i=t==="vertical-rl"||t==="vertical-lr",s=n.body.dir==="rtl"||r==="rtl"||n.documentElement.dir==="rtl";return{vertical:i,rtl:s}},ac=n=>{let e=n.defaultView.getComputedStyle(n.body);return e.backgroundColor==="rgba(0, 0, 0, 0)"&&e.backgroundImage==="none"?n.defaultView.getComputedStyle(n.documentElement).background:e.background},Rr=class{#e=document.createElement("div");#t=document.createElement("iframe");#n=document.createRange();#r;#i=!1;#s=!1;#a=!0;#o;#l={};constructor({container:e}){this.container=e,this.#t.classList.add("filter"),this.#e.append(this.#t),Object.assign(this.#e.style,{position:"relative",overflow:"hidden",flex:"0 0 auto",width:"100%",height:"100%"}),Object.assign(this.#t.style,{overflow:"hidden",border:"0",display:"none",width:"100%",height:"100%"}),this.#t.setAttribute("sandbox","allow-same-origin allow-scripts"),this.#t.setAttribute("scrolling","no")}get element(){return this.#e}get document(){return this.#t.contentDocument}async load(e,t,r){if(typeof e!="string")throw new Error(`${e} is not string`);return new Promise(i=>{this.#t.addEventListener("load",()=>{let s=this.document;t?.(s),this.#t.style.display="block";let{vertical:a,rtl:o}=sc(s),l=ac(s);this.#t.style.display="none",this.#i=a,this.#s=o,this.#n.selectNodeContents(s.body);let c=r?.({vertical:a,rtl:o,background:l});this.#t.style.display="block",this.render(c),new ResizeObserver(()=>this.expand()).observe(s.body),i()},{once:!0}),this.#t.src=e})}render(e){this.#a=e.flow!=="scrolled",this.#l=e,this.#a?this.columnize(e):this.scrolled(e)}scrolled({gap:e,columnWidth:t}){let r=this.#i,i=this.document;Object.assign(i.documentElement.style,{boxSizing:"border-box",padding:r?`${e}px 0`:`0 ${e}px`,columnWidth:"auto",height:"auto",width:"auto"}),Object.assign(i.body.style,{[r?"maxHeight":"maxWidth"]:`${t}px`,margin:"auto"}),this.setImageSize(),this.expand()}columnize({width:e,height:t,gap:r,columnWidth:i}){let s=this.#i;this.#o=s?t:e;let a=this.document;Object.assign(a.documentElement.style,{boxSizing:"border-box",columnWidth:`${i}px`,columnGap:`${r}px`,columnFill:"auto",...s?{width:`${e}px`}:{height:`${t}px`},padding:s?`${r/2}px 0`:`0 ${r/2}px`,overflow:"hidden",overflowWrap:"anywhere",position:"static",border:"0",margin:"0",maxHeight:"none",maxWidth:"none",minHeight:"none",minWidth:"none",webkitLineBoxContain:"block glyphs replaced"}),Object.assign(a.body.style,{maxHeight:"none",maxWidth:"none",margin:"0"}),this.setImageSize(),this.expand()}setImageSize(){let{width:e,height:t,margin:r}=this.#l,i=this.#i,s=this.document;for(let a of s.body.querySelectorAll("img, svg, video")){let{maxHeight:o,maxWidth:l}=s.defaultView.getComputedStyle(a);Object.assign(a.style,{maxHeight:i?o!=="none"&&o!=="0px"?o:"100%":`${t-r*2}px`,maxWidth:i?`${e-r*2}px`:l!=="none"&&l!=="0px"?l:"100%",objectFit:"contain",pageBreakInside:"avoid",breakInside:"avoid",boxSizing:"border-box"})}}expand(){if(this.#a){let e=this.#i?"height":"width",t=this.#i?"width":"height",r=this.#n.getBoundingClientRect()[e],s=Math.ceil(r/this.#o)*this.#o;this.#e.style.padding="0",this.#t.style[e]=`${s}px`,this.#e.style[e]=`${s}px`,this.#t.style[t]="100%",this.#e.style[t]="100%",this.document&&(this.document.documentElement.style[e]=`${s}px`),this.#r&&(this.#r.element.style.margin="0",this.#r.element.style[e]=`${s}px`,this.#r.redraw())}else{let e=this.#i?"width":"height",t=this.#i?"height":"width",s=this.document?.documentElement?.getBoundingClientRect()?.[e],{margin:a}=this.#l,o=this.#i?`0 ${a}px`:`${a}px 0`;this.#e.style.padding=o,this.#t.style[e]=`${s}px`,this.#e.style[e]=`${s}px`,this.#t.style[t]="100%",this.#e.style[t]="100%",this.#r&&(this.#r.element.style.margin=o,this.#r.element.style[e]=`${s}px`,this.#r.redraw())}}set overlayer(e){this.#r=e,this.#e.append(e.element)}get overlayer(){return this.#r}},En=class{#e=document.createElement("div");#t=document.createElement("div");#n;#r=!1;#i=!1;#s=-1;#a=0;#o=!1;#l=new WeakMap;layout={margin:48,gap:40,maxColumnWidth:700};constructor({book:e,onLoad:t,onRelocated:r,createOverlayer:i}){this.sections=e.sections,this.onLoad=t,this.onRelocated=r,this.createOverlayer=i,Object.assign(this.#e.style,{boxSizing:"border-box",width:"100%",height:"100%",position:"absolute"}),this.#e.append(this.#t),Object.assign(this.#t.style,{width:"100%",height:"100%"}),new ResizeObserver(()=>this.render()).observe(this.#e),this.#t.addEventListener("scroll",Jl(()=>{this.scrolled&&this.#w("scroll")},250))}get element(){return this.#e}#d(){return this.#n&&this.#t.removeChild(this.#n.element),this.#n=new Rr({container:this.#e}),this.#t.append(this.#n.element),this.#n}#c({vertical:e,rtl:t,background:r}){this.#r=e,this.#i=t,this.#e.style.background=r;let{flow:i,margin:s,gap:a,maxColumnWidth:o}=this.layout;if(i==="scrolled"){this.#e.setAttribute("dir",e?"rtl":"ltr"),this.#e.style.padding="0",this.#t.style.overflow="scroll";let f=this.layout.maxColumnWidth;return{flow:i,margin:s,gap:a,columnWidth:f}}let{width:l,height:c}=this.#t.getBoundingClientRect(),u=e?c:l,d=Math.ceil(u/o),h=u/d-a;this.#e.setAttribute("dir",t?"rtl":"ltr");let m=`${e?a:a/2}px`,w=`${e?s-a/2:s}px`;return this.#e.style.padding=`${w} ${m}`,this.#t.style.overflow="hidden",{height:c,width:l,margin:s,gap:a,columnWidth:h}}render(){this.#n&&(this.#n.render(this.#c({vertical:this.#r,rtl:this.#i})),this.#m())}get scrolled(){return this.layout.flow==="scrolled"}get scrollProp(){let{scrolled:e}=this;return this.#r?e?"scrollLeft":"scrollTop":e?"scrollTop":"scrollLeft"}get sideProp(){let{scrolled:e}=this;return this.#r?e?"width":"height":e?"height":"width"}get size(){return this.#t.getBoundingClientRect()[this.sideProp]}get viewSize(){return this.#n.element.getBoundingClientRect()[this.sideProp]}get start(){return Math.abs(this.#t[this.scrollProp])}get end(){return this.start+this.size}get page(){return Math.floor((this.start+this.end)/2/this.size)}get pages(){return Math.round(this.viewSize/this.size)}#u(){if(this.scrolled){let t=this.viewSize,r=this.layout.margin;return this.#r?({left:i,right:s})=>({left:t-s-r,right:t-i-r}):({top:i,bottom:s})=>({left:i+r,right:s+r})}let e=this.pages*this.size;return this.#i?({left:t,right:r})=>({left:e-r,right:e-t}):this.#r?({top:t,bottom:r})=>({left:t,right:r}):t=>t}async#f(e,t){if(this.scrolled){let i=this.#u()(e).left;return this.#h(i,t)}let r=this.#u()(e).left+this.layout.margin/2;return this.#p(Math.floor(r/this.size),t)}async#h(e,t){let r=this.#t,{scrollProp:i}=this;if(r[i]===e){this.#w(t);return}this.scrolled&&this.#r&&(e=-e),r[i]=e,this.#w(t)}async#p(e,t){let r=this.size*(this.#i?-e:e);return this.#h(r,t)}async#m(e){let t=Ql(this.#a).getBoundingClientRect?.();if(t){await this.#f(t,"anchor"),e&&this.#_();return}if(this.scrolled){await this.#h(this.#a*this.viewSize,"anchor");return}let{pages:r}=this;if(!r)return;let i=Math.round(this.#a*(r-1));await this.#p(i,"anchor")}#_(){let{defaultView:e}=this.#n.document;if(this.#a instanceof e.Range){let t=e.getSelection();t.removeAllRanges(),t.addRange(this.#a)}}#A(){return ic(this.#n.document,this.start,this.end,this.#u(),this.scrolled)}#w(e){let t=this.#A();e!=="anchor"&&(this.#a=t);let r=this.#s;this.scrolled?this.onRelocated?.(t,r,this.end/this.viewSize):this.pages>0&&this.onRelocated?.(t,r,(this.page+1)/this.pages)}async#y(e){let{index:t,src:r,anchor:i,onLoad:s,select:a}=await e;if(this.#s=t,r){let o=this.#d(),l=d=>{if(d.head){let h=d.createElement("style");d.head.append(h),this.#l.set(d,h)}s?.(d,t)},c=this.#c.bind(this);await o.load(r,l,c);let u=this.createOverlayer?.(o.document,t);u&&(o.overlayer=u),this.#n=o}this.#a=(typeof i=="function"?i(this.#n.document):i)??0,await this.#m(a)}#v(e){return e>-1&&e<this.pages}scrollPrev(){if(!this.#n)return null;if(this.scrolled)return this.start>0?this.#h(Math.max(0,this.start-this.size)):null;let e=this.page-1;return this.#v(e)?this.#p(e):null}scrollNext(){if(!this.#n)return null;if(this.scrolled)return this.viewSize-this.end>60?this.#h(Math.min(this.viewSize,this.end)):null;let e=this.page+1;return this.#v(e)?this.#p(e):null}#x(e){return e>=0&&e<=this.sections.length-1}async#b(e,t,r){if(this.#o)return;r&&(this.#o=!0);let i=e?.();if(i)await i;else{let{index:s,anchor:a,select:o}=await t;if(!this.#x(s))return this.#o=!1,null;if(s===this.#s)await this.#y({index:s,anchor:a,select:o});else{let l=this.#s,c=(...u)=>{this.sections[l]?.unload?.(),this.onLoad?.(...u)};await this.#y(Promise.resolve(this.sections[s].load()).then(u=>({index:s,src:u,anchor:a,onLoad:c,select:o})).catch(u=>({})))}}r&&(await Yl(100),this.#o=!1)}async goTo(e){return this.#b(null,e)}#g(e){for(let t=this.#s+e;this.#x(t);t+=e)if(this.sections[t]?.linear!=="no")return t}prev(){let e=this.#g(-1);return this.#b(()=>this.scrollPrev(),{index:e,anchor:()=>1},!0)}next(){let e=this.#g(1);return this.#b(()=>this.scrollNext(),{index:e},!0)}prevSection(){return this.goTo({index:this.#g(-1)})}nextSection(){return this.goTo({index:this.#g(1)})}firstSection(){let e=this.sections.findIndex(t=>t.linear!=="no");return this.goTo({index:e})}lastSection(){let e=this.sections.findLastIndex(t=>t.linear!=="no");return this.goTo({index:e})}getOverlayer(){if(this.#n)return{index:this.#s,overlayer:this.#n.overlayer,doc:this.#n.document}}setStyle(e){let t=this.#l.get(this.#n?.document);t&&(t.textContent=e)}async#S(e,t){this.#a=e,await this.#m(t)}};var gs=n=>n?.split(/[,;\s]/)?.filter(e=>e)?.map(e=>e.split("=").map(t=>t.trim())),oc=(n,e)=>{if(n.documentElement.nodeName==="svg"){let[,,i,s]=n.documentElement.getAttribute("viewBox")?.split(/\s/)??[];return{width:i,height:s}}let t=gs(n.querySelector('meta[name="viewport"]')?.getAttribute("content"));if(t)return Object.fromEntries(t);if(typeof e=="string")return gs(e);if(e)return e;let r=n.querySelector("img");return r?{width:r.naturalWidth,height:r.naturalHeight}:{width:1e3,height:2e3}},Ir=class{#e=document.createElement("div");defaultViewport;spread;#t=!1;#n;#r;#i;#s;constructor(){Object.assign(this.#e.style,{width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center"}),new ResizeObserver(()=>this.render()).observe(this.#e)}get element(){return this.#e}get side(){return this.#s}async#a(e){let t=document.createElement("div"),r=document.createElement("iframe");return t.append(r),Object.assign(r.style,{border:"0",display:"none",overflow:"hidden"}),r.setAttribute("scrolling","no"),r.classList.add("filter"),this.#e.append(t),e?new Promise(i=>{let s=()=>{r.removeEventListener("load",s),this.onLoad?.(r);let a=r.contentDocument,{width:o,height:l}=oc(a,this.defaultViewport);i({element:t,iframe:r,width:parseFloat(o),height:parseFloat(l)})};r.addEventListener("load",s),r.src=e}):{blank:!0,element:t,iframe:r}}render(e=this.#s){if(!e)return;let t=this.#n??{},r=this.#i??this.#r,i=e==="left"?t:r,{width:s,height:a}=this.#e.getBoundingClientRect(),o=this.spread!=="both"&&this.spread!=="portrait"&&a>s;this.#t=o;let l=t.width??r.width,c=t.height??r.height,u=o?Math.min(s/(i.width??l),a/(i.height??c)):Math.min(s/((t.width??l)+(r.width??l)),a/Math.max(t.height??c,r.height??c)),d=h=>{let{element:m,iframe:w,width:f,height:p}=h;Object.assign(w.style,{width:`${f}px`,height:`${p}px`,transform:`scale(${u})`,transformOrigin:"top left",display:"block"}),Object.assign(m.style,{width:`${(f??l)*u}px`,height:`${(p??c)*u}px`,overflow:"hidden",display:"block"}),o&&h!==i&&(m.style.display="none")};this.#i?d(this.#i):(d(t),d(r))}async showSpread({left:e,right:t,center:r,side:i}){this.#e.replaceChildren(),this.#n=null,this.#r=null,this.#i=null,r?(this.#i=await this.#a(r),this.#s="center",this.render()):(this.#n=await this.#a(e),this.#r=await this.#a(t),this.#s=i,this.render())}goLeft(){if(!this.#i){if(this.#n?.blank)return!0;if(this.#t&&this.#n?.element?.style?.display==="none")return this.#r.element.style.display="none",this.#n.element.style.display="block",this.#s="left",!0}}goRight(){if(!this.#i){if(this.#r?.blank)return!0;if(this.#t&&this.#r?.element?.style?.display==="none")return this.#n.element.style.display="none",this.#r.element.style.display="block",this.#s="right",!0}}},kn=class{#e;#t=-1;#n=new Ir;constructor({book:e,onLoad:t,onRelocated:r}){this.book=e,this.onLoad=t,this.onRelocated=r;let{rendition:i}=e;this.#n.spread=i?.spread,this.#n.defaultViewport=i?.viewport;let s=e.dir==="rtl",a=!s;this.rtl=s,i?.spread==="none"?this.#e=e.sections.map(o=>({center:o})):this.#e=e.sections.reduce((o,l)=>{let c=o[o.length-1],{linear:u,pageSpread:d}=l;if(u==="no")return o;let h=()=>{let m={};return o.push(m),m};if(d==="center")h().center=l;else if(d==="left"){let m=c.center||c.left||a?h():c;m.left=l}else if(d==="right"){let m=c.center||c.right||s?h():c;m.right=l}else a?c.center||c.right?h().left=l:c.left?c.right=l:c.left=l:c.center||c.left?h().right=l:c.right?c.left=l:c.right=l;return o},[{}])}get element(){return this.#n.element}get index(){let e=this.#e[this.#t],t=e?.center??(this.#n.side==="left"?e.left??e.right:e.right??e.left);return this.book.sections.indexOf(t)}getSpreadOf(e){let t=this.#e;for(let r=0;r<t.length;r++){let{left:i,right:s,center:a}=t[r];if(i===e)return{index:r,side:"left"};if(s===e)return{index:r,side:"right"};if(a===e)return{index:r,side:"center"}}}async goToSpread(e,t){if(e<0||e>this.#e.length-1)return;if(e===this.#t){this.#n.render(t);return}this.#t=e;let r=this.#e[e];if(r.center){let i=await r.center?.load?.();await this.#n.showSpread({center:i})}else{let i=await r.left?.load?.(),s=await r.right?.load?.();await this.#n.showSpread({left:i,right:s,side:t})}this.onRelocated?.(null,this.index,0,1)}async select(e){await this.goTo(e)}async goTo(e){let{book:t}=this,r=await e,i=t.sections[r.index];if(!i)return;let{index:s,side:a}=this.getSpreadOf(i);await this.goToSpread(s,a)}async next(){if(this.rtl?this.#n.goLeft():this.#n.goRight())this.onRelocated?.(null,this.index,0,1);else return this.goToSpread(this.#t+1,this.rtl?"right":"left")}async prev(){if(this.rtl?this.#n.goRight():this.#n.goLeft())this.onRelocated?.(null,this.index,0,1);else return this.goToSpread(this.#t-1,this.rtl?"left":"right")}};var ms=n=>n.replace(/\s+/g," "),lc=(n,{startIndex:e,startOffset:t,endIndex:r,endOffset:i})=>{let s=n[e],a=n[r],o=s===a?s.slice(t,i):s.slice(t)+n.slice(s+1,a).join("")+a.slice(0,i),l=ms(s.slice(0,t)).trimStart(),c=ms(a.slice(i)).trimEnd(),u=l.length<50?"":"\u2026",d=c.length<50?"":"\u2026",h=`${u}${l.slice(-50)}`,m=`${c.slice(0,50)}${d}`;return{pre:h,match:o,post:m}},cc=function*(n,e,t={}){let{locales:r="en",granularity:i="word",sensitivity:s="base"}=t,a,o;try{a=new Intl.Segmenter(r,{usage:"search",granularity:i}),o=new Intl.Collator(r,{sensitivity:s})}catch{a=new Intl.Segmenter("en",{usage:"search",granularity:i}),o=new Intl.Collator("en",{sensitivity:s})}let l=Array.from(a.segment(e)).length,c=[],u=0,d=a.segment(n[u])[Symbol.iterator]();e:for(;u<n.length;){for(;c.length<l;){let{done:m,value:w}=d.next();if(m)if(u++,u<n.length){d=a.segment(n[u])[Symbol.iterator]();continue}else break e;let{index:f,segment:p}=w;if(/[^\p{Format}]/u.test(p)){if(/\s/u.test(p)){/\s/u.test(c[c.length-1]?.segment)||c.push({strIndex:u,index:f,segment:" "});continue}w.strIndex=u,c.push(w)}}let h=c.map(m=>m.segment).join("");if(o.compare(e,h)===0){let m=u,w=c[c.length-1],f=w.index+w.segment.length,p=c[0].strIndex,g=c[0].index,b={startIndex:p,startOffset:g,endIndex:m,endOffset:f};yield{range:b,excerpt:lc(n,b)}}c.shift()}},ws=(n,e)=>{let{defalutLocale:t,matchCase:r,matchDiacritics:i,matchWholeWords:s}=e;return function*(a,o){let l=n(a,function*(c,u){for(let d of cc(c,o,{locales:a.body.lang||a.documentElement.lang||t||"en",granularity:s?"word":"grapheme",sensitivity:i&&r?"variant":i&&!r?"accent":!i&&r?"case":"base"})){let{startIndex:h,startOffset:m,endIndex:w,endOffset:f}=d.range;d.range=u(h,m,w,f),yield d}});for(let c of l)yield c}};var uc=function*(n,e){let t=NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT|NodeFilter.SHOW_CDATA_SECTION,{FILTER_ACCEPT:r,FILTER_REJECT:i,FILTER_SKIP:s}=NodeFilter,a=d=>{let h=d.localName?.toLowerCase();return h==="script"||h==="style"?i:d.nodeType===1?s:r},o=n.createTreeWalker(n.body,t,{acceptNode:a}),l=[];for(let d=o.nextNode();d;d=o.nextNode())l.push(d);let c=l.map(d=>d.nodeValue),u=(d,h,m,w)=>{let f=n.createRange();return f.setStart(l[d],h),f.setEnd(l[m],w),f};for(let d of e(c,u))yield d},bs=(n,e)=>{let t=e.left+n.left,r=e.right+n.left,i=e.top+n.top,s=e.bottom+n.top;return{left:t,right:r,top:i,bottom:s}},ys=({x:n,y:e})=>n>0&&e>0&&n<window.innerWidth&&e<window.innerHeight,xs=n=>{let t=(n.getRootNode?.()??n?.endContainer?.getRootNode?.())?.defaultView?.frameElement?.getBoundingClientRect()??{top:0,left:0},r=Array.from(n.getClientRects()),i=bs(t,r[0]),s=bs(t,r.at(-1)),a={point:{x:(i.left+i.right)/2,y:i.top},dir:"up"},o={point:{x:(s.left+s.right)/2,y:s.bottom},dir:"down"},l=ys(a.point),c=ys(o.point);return!l&&!c?{point:{x:0,y:0}}:l?c?a.point.y>window.innerHeight-o.point.y?a:o:a:o},vs=Object.fromEntries(Array.from(Object.entries({isRef:["annoref","biblioref","glossref","noteref"],isLink:["backlink"],isNote:["annotation","note","footnote","endnote","rearnote"]}),([n,e])=>[n,t=>t.getAttributeNS("http://www.idpf.org/2007/ops","type")?.split(/s/)?.some(r=>e.includes(r))])),Tn=class{#e;#t;#n;#r;language="en";textDirection="";isCJK=!1;isFixedLayout=!1;annotations=new _n({resolve:e=>this.resolveCFI(e),compare:Vt,onAdd:(e,t,r)=>{let i=this.#o(t);i&&this.#a(i.doc,i.overlayer,e);let s=this.#t.getProgress(t)?.label??"";this?.emit({type:"add-annotation",annotation:e,label:s,index:t,position:r})},onDelete:(e,t,r)=>{this.#o(t)?.overlayer?.remove(e),this?.emit({type:"delete-annotation",index:t,position:r})},onUpdate:(e,t)=>{let r=this.#o(t);r&&(r.overlayer.remove(e.value),this.#a(r.doc,r.overlayer,e))}});constructor(e,t){if(this.book=e,this.emit=t,e.metadata?.language)try{let r=e.metadata.language;e.metadata.language=Intl.getCanonicalLocales(r)[0];let i=typeof r=="string"?r:r[0],s=new Intl.Locale(i);this.isCJK=["zh","ja","kr"].includes(s.language),s.textInfo&&s.textInfo.direction&&(this.textDirection=s.textInfo.direction)}catch{}if(e.splitTOCHref&&e.getTOCFragment){let r=e.sections.map(a=>a.id);this.#e=new vn(e.sections,150,1600);let i=e.splitTOCHref.bind(e),s=e.getTOCFragment.bind(e);this.#t=new Xt({toc:e.toc??[],ids:r,splitHref:i,getFragment:s}),this.#n=new Xt({toc:e.pageList??[],ids:r,splitHref:i,getFragment:s})}}async display(){let e={book:this.book,onLoad:this.#s.bind(this),onRelocated:this.#i.bind(this),createOverlayer:this.#l.bind(this)};return this.isFixedLayout=this.book.rendition?.layout==="pre-paginated",this.isFixedLayout?this.renderer=new kn(e):this.renderer=new En(e),this.renderer.element}async init({lastLocation:e,annotations:t}){if(e){let r=this.resolveNavigation(e);r?await this.renderer.goTo(r):await this.renderer.next()}else await this.renderer.next();if(t){t.sort((r,i)=>Vt(r.value,i.value));for(let r of t)await this.annotations.add(r,!0)}}#i(e,t,r){if(!this.#e)return;let i=this.#e.getProgress(t,r),s=this.#t.getProgress(t,e),a=this.#n.getProgress(t,e),o=this.getCFI(t,e);this.emit?.({type:"relocated",...i,tocItem:s,pageItem:a,cfi:o})}#s(e,t){let{book:r}=this;e.documentElement.lang||=this.language,e.documentElement.dir||=this.isCJK?"":this.textDirection,this.book&&this.book._hash&&e.documentElement.setAttribute("data-immersive-translate-hash",this.book._hash),this.renderer.setStyle(this.#r);let i=r.sections[t];for(let s of e.querySelectorAll("a[href]"))s.addEventListener("click",a=>{a.preventDefault();let o=s.getAttribute("href"),l=i?.resolveHref?.(o)??o;if(r?.isExternal?.(l))this.emit?.({type:"external-link",uri:l});else if(vs.isRef(s)){let{index:c,anchor:u}=r.resolveHref(l);Promise.resolve(r.sections[c].createDocument()).then(d=>[u(d),d.contentType]).then(([d,h])=>[d?.innerHTML,h,vs.isNote(d)]).then(([d,h,m])=>d?this.emit?.({type:"reference",href:m?null:l,content:d,contentType:h,element:s}):null).catch(d=>{});return}else this.goTo(l)});this.emit?.({type:"loaded",doc:e,index:t})}#a(e,t,r){let{value:i}=r,s=this.annotations.getAnchor(i),a=e?s(e):s,[o,l]=this.emit({type:"draw-annotation",annotation:r});t.add(i,a,o,l)}#o(e){let t=this.renderer.getOverlayer();if(t.index===e)return t}#l(e,t){let r=new xn;for(let i of this.annotations.getByIndex(t))this.#a(e,r,i);return e.addEventListener("click",i=>{let[s,a]=r.hitTest(i);s&&this.emit?.({type:"show-annotation",value:s,range:a})},!1),r}async showAnnotation(e){let{value:t}=e,{index:r,anchor:i}=await this.goTo(t),{doc:s}=this.#o(r),a=i(s);this.emit?.({type:"show-annotation",value:t,range:a})}getCFI(e,t){if(!t)return"";let r=this.book.sections[e].cfi??kr.fromIndex(e);return es(r,rs(t))}resolveCFI(e){if(this.book.resolveCFI)return this.book.resolveCFI(e);{let t=at(e);return{index:kr.toIndex((t.parent??t).shift()),anchor:s=>wn(s,t)}}}resolveNavigation(e){try{return typeof e=="number"?{index:e}:qt.test(e)?this.resolveCFI(e):this.book.resolveHref(e)}catch{}}async goTo(e){let t=this.resolveNavigation(e);try{return await this.renderer.goTo(t),t}catch{}}async goToFraction(e){let[t,r]=this.#e.getSection(e);return this.renderer.goTo({index:t,anchor:r})}async select(e){try{let t=await this.resolveNavigation(e);await this.renderer.goTo({...t,select:!0})}catch{}}goLeft(){return this.book.dir==="rtl"?this.renderer.next():this.renderer.prev()}goRight(){return this.book.dir==="rtl"?this.renderer.prev():this.renderer.next()}setAppearance({layout:e,css:t}){this.isFixedLayout||(Object.assign(this.renderer.layout,e),this.#r=t,this.renderer.setStyle(t),this.renderer.render())}async*#d(e,t,r){let i=await this.book.sections[r].createDocument();for(let{range:s,excerpt:a}of e(i,t))yield{cfi:this.getCFI(r,s),excerpt:a}}async*#c(e,t){let{sections:r}=this.book;for(let[i,{createDocument:s}]of r.entries()){if(!s)continue;let a=await s(),o=Array.from(e(a,t),({range:c,excerpt:u})=>({cfi:this.getCFI(i,c),excerpt:u}));yield{progress:(i+1)/r.length},o.length&&(yield{index:i,subitems:o})}}async*search(e){let{query:t,index:r}=e,i=ws(uc,{defaultLocale:this.language,...e}),s=r!=null?this.#d(i,t,r):this.#c(i,t);for await(let a of s)yield"subitems"in a?{label:this.#t.getProgress(a.index)?.label??"",subitems:a.subitems}:a}};var _s=n=>document.createElementNS("http://www.w3.org/2000/svg",n),dc=()=>{let n=_s("svg");n.setAttribute("viewBox","0 0 13 10"),n.setAttribute("width","13"),n.setAttribute("height","13");let e=_s("polygon");return e.setAttribute("points","2 1, 12 1, 7 9"),n.append(e),n},hc=(n,e,t)=>{let r=0,i=()=>`toc-element-${r++}`,s=({label:a,href:o,subitems:l},c=0)=>{let u=document.createElement(o?"a":"span");u.innerText=a,u.setAttribute("role","treeitem"),u.tabIndex=-1,u.style.paddingInlineStart=`${(c+1)*24}px`,n.push(u),o?(e.has(o)||e.set(o,u),u.href=o,u.onclick=h=>{h.preventDefault(),t(o)}):u.onclick=h=>u.firstElementChild?.onclick(h);let d=document.createElement("li");if(d.setAttribute("role","none"),d.append(u),l?.length){u.setAttribute("aria-expanded","false");let h=dc();h.onclick=w=>{w.preventDefault(),w.stopPropagation();let f=u.getAttribute("aria-expanded");u.setAttribute("aria-expanded",f==="true"?"false":"true")},u.prepend(h);let m=document.createElement("ol");m.id=i(),m.setAttribute("role","group"),u.setAttribute("aria-owns",m.id),m.replaceChildren(...l.map(w=>s(w,c+1))),d.append(m)}return d};return s},As=(n,e)=>{let t=document.createElement("ol");t.setAttribute("role","tree");let r=[],i=new Map,s=hc(r,i,e);t.replaceChildren(...n.map(w=>s(w)));let a=w=>w?.getAttribute("role")==="treeitem",o=function*(w){for(let f=w.parentNode;f!==t;f=f.parentNode){let p=f.previousElementSibling;a(p)&&(yield p)}},l,c;t.addEventListener("focusout",()=>{if(l){if(c&&(c.tabIndex=-1),l.offsetParent){l.tabIndex=0;return}for(let w of o(l))if(w.offsetParent){w.tabIndex=0,c=w;break}}});let u=w=>{l&&(l.removeAttribute("aria-current"),l.tabIndex=-1);let f=i.get(w);if(!f){l=r[0],l.tabIndex=0;return}for(let p of o(f))p.setAttribute("aria-expanded","true");f.setAttribute("aria-current","page"),f.tabIndex=0,f.scrollIntoView({behavior:"auto",block:"center"}),l=f},d=w=>a(w)&&w.offsetParent?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP,h=document.createTreeWalker(t,1,{acceptNode:d}),m=w=>(h.currentNode=w,h);for(let w of r)w.addEventListener("keydown",f=>{let p=!1,{currentTarget:g,key:b}=f;switch(b){case" ":case"Enter":g.click(),p=!0;break;case"ArrowDown":m(g).nextNode()?.focus(),p=!0;break;case"ArrowUp":m(g).previousNode()?.focus(),p=!0;break;case"ArrowLeft":g.getAttribute("aria-expanded")==="true"?g.setAttribute("aria-expanded","false"):o(g).next()?.value?.focus(),p=!0;break;case"ArrowRight":g.getAttribute("aria-expanded")==="true"?m(g).nextNode()?.focus():g.getAttribute("aria-owns")&&g.setAttribute("aria-expanded","true"),p=!0;break;case"Home":r[0].focus(),p=!0;break;case"End":{let y=r[r.length-1];y.offsetParent?y.focus():m(y).previousNode()?.focus(),p=!0;break}}p&&(f.preventDefault(),f.stopPropagation())});return{element:t,setCurrentHref:u}};var fc=(n,e,t)=>{let r=document.createElement("ul");r.setAttribute("role","group"),r.setAttribute("aria-label",n);let i=new Map,s=a=>{t(a);let o=i.get(a);for(let l of r.children)l.setAttribute("aria-checked",l===o?"true":"false")};for(let[a,o]of e){let l=document.createElement("li");l.setAttribute("role","menuitemradio"),l.innerText=a,l.onclick=()=>s(o),i.set(o,l),r.append(l)}return{element:r,select:s}},Ss=n=>{let e={},t=document.createElement("ul");t.setAttribute("role","menu");let r=()=>t.classList.remove("show"),i=s=>(...a)=>(r(),s(...a));for(let{name:s,label:a,type:o,items:l,onclick:c}of n){let u=o==="radio"?fc(a,l,i(c)):null;s&&(e[s]=u),t.append(u.element)}return window.addEventListener("blur",()=>r()),window.addEventListener("click",s=>{t.parentNode.contains(s.target)||r()}),{element:t,groups:e}};var zr=(n,e,t)=>Math.min(e,Math.max(n,t));var Es=n=>document.createElementNS("http://www.w3.org/2000/svg",n),pc=n=>{let t=Es("svg");t.setAttribute("aria-hidden","true"),t.setAttribute("width",20),t.setAttribute("height",10);let r=Es("polygon");return r.setAttribute("points",n?"0 11, 10 0, 20 11":"0 0, 10 11, 20 0"),t.classList.add(n?"popover-arrow-down":"popover-arrow-up"),t.append(r),t},ks=(n,e,{x:t,y:r},i)=>{let s=i==="down",a=e+10,o=document.createElement("div");Object.assign(o.style,{position:"absolute",left:"0",top:"0",width:"100vw",height:"100vh"});let l=pc(s),c=zr(0,window.innerHeight-(s?e:a),s?r+10:r-a);Object.assign(l.style,{position:"absolute",left:`${zr(6,window.innerWidth-20-6,t-10)}px`,top:`${s?c-10:c+e}px`});let u=document.createElement("div");return u.setAttribute("role","dialog"),u.classList.add("popover"),Object.assign(u.style,{position:"absolute",boxSizing:"border-box",overflow:"hidden",left:`${zr(0,window.innerWidth-n,t-n/2)}px`,top:`${c}px`,width:`${n}px`,height:`${e}px`}),o.addEventListener("click",()=>{o.parentNode.removeChild(o),l.parentNode.removeChild(l),u.parentNode.removeChild(u)}),{popover:u,arrow:l,overlay:o}};var Ts=({entries:n,loadBlob:e,getSize:t},r)=>{let i=new Map,s=new Map,a=async d=>{if(i.has(d))return i.get(d);let h=URL.createObjectURL(await e(d)),m=URL.createObjectURL(new Blob([`<img src="${h}">`],{type:"text/html"}));return s.set(d,[h,m]),i.set(d,m),m},o=d=>{s.get(d)?.forEach?.(h=>URL.revokeObjectURL(h)),s.delete(d),i.delete(d)},l=[".jpg",".jpeg",".png",".gif",".bmp",".webp",".svg"],c=n.map(d=>d.filename).filter(d=>l.some(h=>d.endsWith(h))).sort(),u={};return u.getCover=()=>e(c[0]),u.metadata={title:r.name},u.sections=c.map(d=>({id:d,load:()=>a(d),unload:()=>o(d),size:t(d)})),u.toc=c.map(d=>({label:d,href:d})),u.rendition={layout:"pre-paginated"},u.resolveHref=d=>({index:u.sections.findIndex(h=>h.id===d)}),u.splitTOCHref=d=>[d,null],u.getTOCFragment=d=>d.documentElement,u};var Cs=n=>n?.trim()?.replace(/\s{2,}/g," "),Pe=n=>Cs(n?.textContent),Cn={XLINK:"http://www.w3.org/1999/xlink",EPUB:"http://www.idpf.org/2007/ops"},Rn={XML:"application/xml",XHTML:"application/xhtml+xml"},Ge={strong:["strong","self"],emphasis:["em","self"],style:["span","self"],a:"anchor",strikethrough:["s","self"],sub:["sub","self"],sup:["sup","self"],code:["code","self"],image:"image"},gc={tr:["tr",["align"]],th:["th",["colspan","rowspan","align","valign"]],td:["td",["colspan","rowspan","align","valign"]]},Rs={epigraph:["blockquote"],subtitle:["h2",Ge],"text-author":["p",Ge],date:["p",Ge],stanza:"stanza"},In={title:["header",{p:["h1",Ge],"empty-line":["br"]}],epigraph:["blockquote","self"],image:"image",annotation:["aside"],section:["section","self"],p:["p",Ge],poem:["blockquote",Rs],subtitle:["h2",Ge],cite:["blockquote","self"],"empty-line":["br"],table:["table",gc],"text-author":["p",Ge]};Rs.epigraph.push(In);var mc={image:"image",title:["section",{p:["h1",Ge],"empty-line":["br"]}],epigraph:["section",In],section:["section",In]},Is=n=>{let e=n.getAttributeNS(Cn.XLINK,"href"),[,t]=e.split("#"),r=n.getRootNode().getElementById(t);return r?`data:${r.getAttribute("content-type")};base64,${r.textContent}`:e},Lr=class{constructor(e){this.fb2=e,this.doc=document.implementation.createDocument(Cn.XHTML,"html")}image(e){let t=this.doc.createElement("img");return t.alt=e.getAttribute("alt"),t.title=e.getAttribute("title"),t.setAttribute("src",Is(e)),t}anchor(e){let t=this.convert(e,{a:["a",Ge]});return t.setAttribute("href",e.getAttributeNS(Cn.XLINK,"href")),e.getAttribute("type")==="note"&&t.setAttributeNS(Cn.EPUB,"epub:type","noteref"),t}stanza(e){let t=this.convert(e,{stanza:["p",{title:["header",{p:["strong",Ge],"empty-line":["br"]}],subtitle:["p",Ge]}]});for(let r of e.children)r.nodeName==="v"&&(t.append(this.doc.createTextNode(r.textContent)),t.append(this.doc.createElement("br")));return t}convert(e,t){if(e.nodeType===3)return this.doc.createTextNode(e.textContent);if(e.nodeType===4)return this.doc.createCDATASection(e.textContent);if(e.nodeType===8)return this.doc.createComment(e.textContent);let r=t?.[e.nodeName];if(!r)return null;if(typeof r=="string")return this[r](e);let[i,s]=r,a=this.doc.createElement(i);if(e.id&&(a.id=e.id),a.classList.add(e.nodeName),Array.isArray(s))for(let c of s)a.setAttribute(c,e.getAttribute(c));let o=s==="self"?t:Array.isArray(s)?null:s,l=e.firstChild;for(;l;){let c=this.convert(l,o);c&&a.append(c),l=l.nextSibling}return a}},wc=async n=>{let e=await n.arrayBuffer(),t=new TextDecoder("utf-8").decode(e),r=new DOMParser,i=r.parseFromString(t,Rn.XML),s=i.xmlEncoding||t.match(/^<\?xml\s+version\s*=\s*["']1.\d+"\s+encoding\s*=\s*["']([A-Za-z0-9._-]*)["']/)?.[1];if(s&&s.toLowerCase()!=="utf-8"){let a=new TextDecoder(s).decode(e);return r.parseFromString(a,Rn.XML)}return i},bc=URL.createObjectURL(new Blob([`
@namespace epub "http://www.idpf.org/2007/ops";
body > img, section > img {
    display: block;
    margin: auto;
}
.title {
    text-align: center;
}
body > section > .title, body.notesBodyType > .title {
    margin: 3em 0;
}
body.notesBodyType > section .title {
    text-align: left;
    margin: 1em 0;
}
p {
    text-indent: 1em;
    margin: 0;
}
:not(p) + p, p:first-child {
    text-indent: 0;
}
.poem p {
    text-indent: 0;
    margin: 1em 0;
}
.text-author, .date {
    text-align: end;
}
.text-author:before {
    content: "\u2014";
}
table {
    border-collapse: collapse;
}
td, th {
    padding: .25em;
}
a[epub|type~="noteref"] {
    font-size: .75em;
    vertical-align: super;
}
body:not(.notesBodyType) > .title, body:not(.notesBodyType) > .epigraph {
    margin: 3em 0;
}
`],{type:"text/css"})),yc=n=>`<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head><link href="${bc}" rel="stylesheet" type="text/css"/></head>
    <body>${n}</body>
</html>`,Dr="data-foliate-id",Fr=async n=>{let e={},t=await wc(n),r=new Lr(t),i=h=>t.querySelector(h),s=h=>[...t.querySelectorAll(h)],a=h=>{let m=Pe(h.querySelector("nickname"));if(m)return m;let w=Pe(h.querySelector("first-name")),f=Pe(h.querySelector("middle-name")),p=Pe(h.querySelector("last-name")),g=[w,f,p].filter(y=>y).join(" "),b=p?[p,[w,f].filter(y=>y).join(" ")].join(", "):null;return{name:g,sortAs:b}},o=h=>h?.getAttribute("value")??Pe(h),l=i("title-info annotation");e.metadata={title:Pe(i("title-info book-title")),identifier:Pe(i("document-info id")),language:Pe(i("title-info lang")),author:s("title-info author").map(a),translator:s("title-info translator").map(a),producer:s("document-info author").map(a).concat(s("document-info program-used").map(Pe)),publisher:Pe(i("publish-info publisher")),published:o(i("title-info date")),modified:o(i("document-info date")),description:l?r.convert(l,{annotation:["div",In]}).innerHTML:null,subject:s("title-info genre").map(Pe)},e.getCover=()=>fetch(Is(i("coverpage image"))).then(h=>h.blob());let c=Array.from(t.querySelectorAll("body"),h=>{let m=r.convert(h,{body:["body",mc]});return[Array.from(m.children,w=>{let f=[w,...w.querySelectorAll("[id]")].map(p=>p.id);return{el:w,ids:f}}),m]}),u=c[0][0].map(({el:h,ids:m})=>{let w=Array.from(h.querySelectorAll(":scope > section > .title"),(f,p)=>(f.setAttribute(Dr,p),{title:Pe(f),index:p}));return{ids:m,titles:w,el:h}}).concat(c.slice(1).map(([h,m])=>{let w=h.map(f=>f.ids).flat();return m.classList.add("notesBodyType"),{ids:w,el:m,linear:"no"}})).map(({ids:h,titles:m,el:w,linear:f})=>{let p=yc(w.outerHTML),g=new Blob([p],{type:Rn.XHTML}),b=URL.createObjectURL(g),y=Cs(w.querySelector(".title, .subtitle, p")?.textContent??(w.classList.contains("title")?w.textContent:""));return{ids:h,title:y,titles:m,load:()=>b,createDocument:()=>new DOMParser().parseFromString(p,Rn.XHTML),size:g.size-Array.from(w.querySelectorAll("[src]"),E=>E.getAttribute("src")?.length??0).reduce((E,_)=>E+_,0),linear:f}}),d=new Map;return e.sections=u.map((h,m)=>{let{ids:w,load:f,createDocument:p,size:g,linear:b}=h;for(let y of w)y&&d.set(y,m);return{id:m,load:f,createDocument:p,size:g,linear:b}}),e.toc=u.map(({title:h,titles:m},w)=>{let f=w.toString();return{label:h,href:f,subitems:m?.length?m.map(({title:p,index:g})=>({label:p,href:`${f}#${g}`})):null}}).filter(h=>h),e.resolveHref=h=>{let[m,w]=h.split("#");return m?{index:Number(m),anchor:f=>f.querySelector(`[${Dr}="${w}"]`)}:{index:d.get(w),anchor:f=>f.getElementById(w)}},e.splitTOCHref=h=>h?.split("#")?.map(m=>Number(m))??[],e.getTOCFragment=(h,m)=>h.querySelector(`[${Dr}="${m}"]`),e};var pt=n=>{if(!n)return"";let e=document.createElement("textarea");return e.innerHTML=n,e.value},Et={XML:"application/xml",XHTML:"application/xhtml+xml",HTML:"text/html",CSS:"text/css",SVG:"image/svg+xml"},vc={name:[0,32,"string"],type:[60,4,"string"],creator:[64,4,"string"],numRecords:[76,2,"uint"]},xc={compression:[0,2,"uint"],numTextRecords:[8,2,"uint"],recordSize:[10,2,"uint"],encryption:[12,2,"uint"]},_c={magic:[16,4,"string"],length:[20,4,"uint"],type:[24,4,"uint"],encoding:[28,4,"uint"],uid:[32,4,"uint"],version:[36,4,"uint"],titleOffset:[84,4,"uint"],titleLength:[88,4,"uint"],localeRegion:[94,1,"uint"],localeLanguage:[95,1,"uint"],resourceStart:[108,4,"uint"],huffcdic:[112,4,"uint"],numHuffcdic:[116,4,"uint"],exthFlag:[128,4,"uint"],trailingFlags:[240,4,"uint"],indx:[244,4,"uint"]},Ac={resourceStart:[108,4,"uint"],fdst:[192,4,"uint"],numFdst:[196,4,"uint"],frag:[248,4,"uint"],skel:[252,4,"uint"],guide:[260,4,"uint"]},Sc={magic:[0,4,"string"],length:[4,4,"uint"],count:[8,4,"uint"]},zs={magic:[0,4,"string"],length:[4,4,"uint"],type:[8,4,"uint"],idxt:[20,4,"uint"],numRecords:[24,4,"uint"],encoding:[28,4,"uint"],language:[32,4,"uint"],total:[36,4,"uint"],ordt:[40,4,"uint"],ligt:[44,4,"uint"],numLigt:[48,4,"uint"],numCncx:[52,4,"uint"]},Ec={magic:[0,4,"string"],length:[4,4,"uint"],numControlBytes:[8,4,"uint"]},kc={magic:[0,4,"string"],offset1:[8,4,"uint"],offset2:[12,4,"uint"]},Tc={magic:[0,4,"string"],length:[4,4,"uint"],numEntries:[8,4,"uint"],codeLength:[12,4,"uint"]},Cc={magic:[0,4,"string"],numEntries:[8,4,"uint"]},Rc={flags:[8,4,"uint"],dataStart:[12,4,"uint"],keyLength:[16,4,"uint"],keyStart:[20,4,"uint"]},Ic={1252:"windows-1252",65001:"utf-8"},Ds={100:["creator","string",!0],101:["publisher"],103:["description"],104:["isbn"],105:["subject","string",!0],106:["date"],108:["contributor","string",!0],109:["rights"],110:["subjectCode","string",!0],112:["source","string",!0],113:["asin"],121:["boundary","uint"],122:["fixedLayout"],125:["numResources","uint"],126:["originalResolution"],127:["zeroGutter"],128:["zeroMargin"],129:["coverURI"],132:["regionMagnification"],201:["coverOffset","uint"],202:["thumbnailOffset","uint"],503:["title"],524:["language","string",!0],527:["pageProgressionDirection"]},zc={1:["ar","ar-SA","ar-IQ","ar-EG","ar-LY","ar-DZ","ar-MA","ar-TN","ar-OM","ar-YE","ar-SY","ar-JO","ar-LB","ar-KW","ar-AE","ar-BH","ar-QA"],2:["bg"],3:["ca"],4:["zh","zh-TW","zh-CN","zh-HK","zh-SG"],5:["cs"],6:["da"],7:["de","de-DE","de-CH","de-AT","de-LU","de-LI"],8:["el"],9:["en","en-US","en-GB","en-AU","en-CA","en-NZ","en-IE","en-ZA","en-JM",null,"en-BZ","en-TT","en-ZW","en-PH"],10:["es","es-ES","es-MX",null,"es-GT","es-CR","es-PA","es-DO","es-VE","es-CO","es-PE","es-AR","es-EC","es-CL","es-UY","es-PY","es-BO","es-SV","es-HN","es-NI","es-PR"],11:["fi"],12:["fr","fr-FR","fr-BE","fr-CA","fr-CH","fr-LU","fr-MC"],13:["he"],14:["hu"],15:["is"],16:["it","it-IT","it-CH"],17:["ja"],18:["ko"],19:["nl","nl-NL","nl-BE"],20:["no","nb","nn"],21:["pl"],22:["pt","pt-BR","pt-PT"],23:["rm"],24:["ro"],25:["ru"],26:["hr",null,"sr"],27:["sk"],28:["sq"],29:["sv","sv-SE","sv-FI"],30:["th"],31:["tr"],32:["ur"],33:["id"],34:["uk"],35:["be"],36:["sl"],37:["et"],38:["lv"],39:["lt"],41:["fa"],42:["vi"],43:["hy"],44:["az"],45:["eu"],46:["hsb"],47:["mk"],48:["st"],49:["ts"],50:["tn"],52:["xh"],53:["zu"],54:["af"],55:["ka"],56:["fo"],57:["hi"],58:["mt"],59:["se"],62:["ms"],63:["kk"],65:["sw"],67:["uz",null,"uz-UZ"],68:["tt"],69:["bn"],70:["pa"],71:["gu"],72:["or"],73:["ta"],74:["te"],75:["kn"],76:["ml"],77:["as"],78:["mr"],79:["sa"],82:["cy","cy-GB"],83:["gl","gl-ES"],87:["kok"],97:["ne"],98:["fy"]},Ln=(n,e)=>{let t=new n.constructor(n.length+e.length);return t.set(n),t.set(e,n.length),t},Us=(n,e,t)=>{let r=new n.constructor(n.length+e.length+t.length);return r.set(n),r.set(e,n.length),r.set(t,n.length+e.length),r},Dc=new TextDecoder,Gt=n=>Dc.decode(n),Ce=n=>{if(!n)return;let e=n.byteLength,t=e===4?"getUint32":e===2?"getUint16":"getUint8";return new DataView(n)[t](0)},He=(n,e)=>Object.fromEntries(Array.from(Object.entries(n)).map(([t,[r,i,s]])=>[t,(s==="string"?Gt:Ce)(e.slice(r,r+i))])),Br=n=>new TextDecoder(Ic[n]),zn=(n,e=0)=>{let t=0,r=0;for(let i of n.subarray(e,e+4))if(t=t<<7|(i&127)>>>0,r++,i&128)break;return{value:t,length:r}},Lc=n=>{let e=0;for(let t of n.subarray(-4))t&128&&(e=0),e=e<<7|t&127;return e},Bs=n=>{let e=0;for(;n>0;n=n>>1)(n&1)===1&&e++;return e},Fc=n=>{let e=0;for(;!(n&1);)n=n>>1,e++;return e},Oc=n=>{let e=[];for(let t=0;t<n.length;t++){let r=n[t];if(r===0)e.push(0);else if(r<=8)for(let i of n.subarray(t+1,(t+=r)+1))e.push(i);else if(r<=127)e.push(r);else if(r<=191){let i=r<<8|n[t+++1],s=(i&16383)>>>3,a=(i&7)+3;for(let o=0;o<a;o++)e.push(e[e.length-s])}else e.push(32,r^128)}return Uint8Array.from(e)},Mc=(n,e)=>{let t=e>>3,r=e+32,i=r>>3,s=0n;for(let a=t;a<=i;a++)s=s<<8n|BigInt(n[a]??0);return s>>8n-BigInt(r&7)&0xffffffffn},Uc=async(n,e)=>{let t=await e(n.huffcdic),{magic:r,offset1:i,offset2:s}=He(kc,t);if(r!=="HUFF")throw new Error("Invalid HUFF record");let a=Array.from({length:256},(u,d)=>i+d*4).map(u=>Ce(t.slice(u,u+4))).map(u=>[u&128,u&31,u>>>8]),o=[null].concat(Array.from({length:32},(u,d)=>s+d*8).map(u=>[Ce(t.slice(u,u+4)),Ce(t.slice(u+4,u+8))])),l=[];for(let u=1;u<n.numHuffcdic;u++){let d=await e(n.huffcdic+u),h=He(Tc,d);if(h.magic!=="CDIC")throw new Error("Invalid CDIC record");let m=Math.min(1<<h.codeLength,h.numEntries-l.length),w=d.slice(h.length);for(let f=0;f<m;f++){let p=Ce(w.slice(f*2,f*2+2)),g=Ce(w.slice(p,p+2)),b=g&32767,y=g&32768,E=new Uint8Array(w.slice(p+2,p+2+b));l.push([E,y])}}let c=u=>{let d=new Uint8Array,h=u.byteLength*8;for(let m=0;m<h;){let w=Number(Mc(u,m)),[f,p,g]=a[w>>>24];if(!f){for(;w>>>32-p<o[p][0];)p+=1;g=o[p][1]}if((m+=p)>h)break;let b=g-(w>>>32-p),[y,E]=l[b];E||(y=c(y),l[b]=[y,!0]),d=Ln(d,y)}return d};return c},Dn=async(n,e)=>{let t=await e(n),r=He(zs,t);if(r.magic!=="INDX")throw new Error("Invalid INDX record");let i=Br(r.encoding),s=t.slice(r.length),a=He(Ec,s);if(a.magic!=="TAGX")throw new Error("Invalid TAGX section");let o=(a.length-12)/4,l=Array.from({length:o},(h,m)=>new Uint8Array(s.slice(12+m*4,12+m*4+4))),c={},u=0;for(let h=0;h<r.numCncx;h++){let m=await e(n+r.numRecords+h+1),w=new Uint8Array(m);for(let f=0;f<w.byteLength;){let p=f,{value:g,length:b}=zn(w,f);f+=b;let y=m.slice(f,f+g);f+=g,c[u+p]=i.decode(y)}u+=65536}let d=[];for(let h=0;h<r.numRecords;h++){let m=await e(n+1+h),w=new Uint8Array(m),f=He(zs,m);if(f.magic!=="INDX")throw new Error("Invalid INDX record");for(let p=0;p<f.numRecords;p++){let g=f.idxt+4+2*p,b=Ce(m.slice(g,g+2)),y=Ce(m.slice(b,b+1)),E=Gt(m.slice(b+1,b+1+y)),_=[],v=b+1+y,A=0,x=v+a.numControlBytes;for(let[S,T,D,R]of l){if(R&1){A++;continue}let U=v+A,z=Ce(m.slice(U,U+1))&D;if(z===D)if(Bs(D)>1){let{value:O,length:M}=zn(w,x);_.push([S,null,O,T]),x+=M}else _.push([S,1,null,T]);else _.push([S,z>>Fc(D),null,T])}let k={};for(let[S,T,D,R]of _){let U=[];if(T!=null)for(let z=0;z<T*R;z++){let{value:O,length:M}=zn(w,x);U.push(O),x+=M}else{let z=0;for(;z<D;){let{value:O,length:M}=zn(w,x);U.push(O),x+=M,z+=M}}k[S]=U}d.push({name:E,tagMap:k})}}return{table:d,cncx:c}},Bc=async(n,e)=>{let{table:t,cncx:r}=await Dn(n,e),i=t.map(({tagMap:a},o)=>({index:o,offset:a[1]?.[0],size:a[2]?.[0],label:r[a[3]]??"",headingLevel:a[4]?.[0],pos:a[6],parent:a[21]?.[0],firstChild:a[22]?.[0],lastChild:a[23]?.[0]})),s=a=>(a.firstChild==null||(a.children=i.filter(o=>o.parent===a.index).map(s)),a);return i.filter(a=>a.headingLevel===0).map(s)},Nc=(n,e)=>{let{magic:t,count:r}=He(Sc,n);if(t!=="EXTH")throw new Error("Invalid EXTH header");let i=Br(e),s={},a=12;for(let o=0;o<r;o++){let l=Ce(n.slice(a,a+4)),c=Ce(n.slice(a+4,a+8));if(l in Ds){let[u,d,h]=Ds[l],m=n.slice(a+8,a+c),w=d==="uint"?Ce(m):i.decode(m);h?(s[u]??=[],s[u].push(w)):s[u]=w}a+=c}return s},Pc=async(n,e)=>{let{flags:t,dataStart:r,keyLength:i,keyStart:s}=He(Rc,n),a=new Uint8Array(n.slice(r));if(t&2){let l=i===16?1024:1040,c=new Uint8Array(n.slice(s,s+i)),u=Math.min(l,a.length);for(var o=0;o<u;o++)a[o]=a[o]^c[o%c.length]}if(t&1)try{return await e(a)}catch{}return a},Ns=async n=>Gt(await n.slice(60,68).arrayBuffer())==="BOOKMOBI",Or=class{#e;#t;pdb;async open(e){this.#e=e;let t=He(vc,await e.slice(0,78).arrayBuffer());this.pdb=t;let r=await e.slice(78,78+t.numRecords*8).arrayBuffer();this.#t=Array.from({length:t.numRecords},(i,s)=>Ce(r.slice(s*8,s*8+4))).map((i,s,a)=>[i,a[s+1]])}loadRecord(e){let t=this.#t[e];if(!t)throw new RangeError("Record index out of bounds");return this.#e.slice(...t).arrayBuffer()}async loadMagic(e){let t=this.#t[e][0];return Gt(await this.#e.slice(t,t+4).arrayBuffer())}},Fn=class extends Or{#e=0;#t;#n;#r;#i;#s;constructor({unzlib:e}){super(),this.unzlib=e}async open(e){await super.open(e),this.headers=this.#a(await super.loadRecord(0)),this.#t=this.headers.mobi.resourceStart;let t=this.headers.mobi.version>=8;if(!t){let r=this.headers.exth?.boundary;if(r<4294967295)try{this.headers=this.#a(await super.loadRecord(r)),this.#e=r,t=!0}catch{}}return await this.#o(),t?new Ur(this).init():new Mr(this).init()}#a(e){let t=He(xc,e),r=He(_c,e);if(r.magic!=="MOBI")throw new Error("Missing MOBI header");let{titleOffset:i,titleLength:s,localeLanguage:a,localeRegion:o}=r;r.title=e.slice(i,i+s);let l=zc[a];r.language=l?.[o>>2]??l?.[0];let c=r.exthFlag&64?Nc(e.slice(r.length+16),r.encoding):null,u=r.version>=8?He(Ac,e):null;return{palmdoc:t,mobi:r,exth:c,kf8:u}}async#o(){let{palmdoc:e,mobi:t}=this.headers;this.#n=Br(t.encoding),this.#r=new TextEncoder;let{compression:r}=e;if(this.#i=r===1?o=>o:r===2?Oc:r===17480?await Uc(t,this.loadRecord.bind(this)):null,!this.#i)throw new Error("Unknown compression type");let{trailingFlags:i}=t,s=i&1,a=Bs(i>>>1);this.#s=o=>{for(let l=0;l<a;l++){let c=Lc(o);o=o.subarray(0,-c)}if(s){let l=(o[o.length-1]&3)+1;o=o.subarray(0,-l)}return o}}decode(...e){return this.#n.decode(...e)}encode(...e){return this.#r.encode(...e)}loadRecord(e){return super.loadRecord(this.#e+e)}loadMagic(e){return super.loadMagic(this.#e+e)}loadText(e){return this.loadRecord(e+1).then(t=>new Uint8Array(t)).then(this.#s).then(this.#i)}async loadResource(e){let t=await super.loadRecord(this.#t+e),r=Gt(t.slice(0,4));return r==="FONT"?Pc(t,this.unzlib):r==="VIDE"||r==="AUDI"?t.slice(12):t}getNCX(){let e=this.headers.mobi.indx;if(e<4294967295)return Bc(e,this.loadRecord.bind(this))}getMetadata(){let{mobi:e,exth:t}=this.headers;return{identifier:e.uid.toString(),title:pt(t?.title||this.decode(e.title)),author:t?.creator?.map(pt),publisher:pt(t?.publisher),language:t?.language??e.language,published:t?.date,description:pt(t?.description),subject:t?.subject?.map(pt),rights:pt(t?.rights)}}async getCover(){let{exth:e}=this.headers,t=e?.coverOffset<4294967295?e?.coverOffset:e?.thumbnailOffset<4294967295?e?.thumbnailOffset:null;if(t!=null){let r=await this.loadResource(t);return new Blob([r])}}},Ls=/<\s*(?:mbp:)?pagebreak[^>]*>/gi,Hc=/<[^<>]+filepos=['"]{0,1}(\d+)[^<>]*>/gi,Mr=class{parser=new DOMParser;serializer=new XMLSerializer;#e=new Map;#t=new Map;#n=new Map;#r;#i=[];#s=Et.HTML;constructor(e){this.mobi=e}async init(){let e=new Uint8Array;for(let i=0;i<this.mobi.headers.palmdoc.numTextRecords;i++)e=Ln(e,await this.mobi.loadText(i));let t=Array.from(new Uint8Array(e),i=>String.fromCharCode(i)).join("");this.#r=[0].concat(Array.from(t.matchAll(Ls),i=>i.index)).map((i,s,a)=>t.slice(i,a[s+1])).map(i=>Uint8Array.from(i,s=>s.charCodeAt(0))).map(i=>({book:this,raw:i})).reduce((i,s)=>{let a=i[i.length-1];return s.start=a?.end??0,s.end=s.start+s.raw.byteLength,i.concat(s)},[]),this.sections=this.#r.map((i,s)=>({id:s,load:()=>this.loadSection(i),createDocument:()=>this.createDocument(i),size:i.end-i.start}));let r=[];try{let i=await this.mobi.getNCX(),s=({label:a,offset:o,children:l})=>{let c=o.toString().padStart(10,"0"),u=`filepos:${c}`;return r.push(c),a=pt(a),{label:a,href:u,subitems:l?.map(s)}};if(this.toc=i?.map(s),this.landmarks=await this.getGuide(),!this.toc){let a=this.landmarks.find(({type:o})=>o?.includes("toc"))?.href;if(a){let{index:o}=this.resolveHref(a),l=await this.sections[o].createDocument();this.toc=Array.from(l.querySelectorAll("a[filepos]"),c=>({label:c.innerText?.trim(),href:`filepos:${c.getAttribute("filepos")}`}))}}}catch{}return this.#i=[...new Set(r.concat(Array.from(t.matchAll(Hc),i=>i[1])))].map(i=>({filepos:i,number:Number(i)})).sort((i,s)=>i.number-s.number),this.metadata=this.mobi.getMetadata(),this.getCover=this.mobi.getCover.bind(this.mobi),this}async getGuide(){let e=await this.createDocument(this.#r[0]);return Array.from(e.getElementsByTagName("reference"),t=>({label:t.getAttribute("title"),type:t.getAttribute("type")?.split(/\s/),href:`filepos:${t.getAttribute("filepos")}`}))}async loadResource(e){if(this.#e.has(e))return this.#e.get(e);let t=await this.mobi.loadResource(e),r=URL.createObjectURL(new Blob([t]));return this.#e.set(e,r),r}async loadRecindex(e){return this.loadResource(Number(e)-1)}async replaceResources(e){for(let t of e.querySelectorAll("img[recindex]")){let r=t.getAttribute("recindex");try{t.src=await this.loadRecindex(r)}catch{}}for(let t of e.querySelectorAll("[mediarecindex]")){let r=t.getAttribute("mediarecindex"),i=t.getAttribute("recindex");try{t.src=await this.loadRecindex(r),i&&(t.poster=await this.loadRecindex(i))}catch{}}for(let t of e.querySelectorAll("[filepos]")){let r=t.getAttribute("filepos");t.href=`filepos:${r}`}}async loadText(e){if(this.#t.has(e))return this.#t.get(e);let{raw:t}=e,r=this.#i.filter(({number:a})=>a>=e.start&&a<e.end).map(a=>({...a,offset:a.number-e.start})),i=t;r.length&&(i=t.subarray(0,r[0].offset),r.forEach(({filepos:a,offset:o},l)=>{let c=r[l+1],u=this.mobi.encode(`<a id="filepos${a}"></a>`);i=Us(i,u,t.subarray(o,c?.offset))}));let s=this.mobi.decode(i).replaceAll(Ls,"");return this.#t.set(e,s),s}async createDocument(e){let t=await this.loadText(e);return this.parser.parseFromString(t,this.#s)}async loadSection(e){if(this.#n.has(e))return this.#n.get(e);let t=await this.createDocument(e),r=t.createElement("style");t.head.append(r),r.append(t.createTextNode(`blockquote {
            margin-block-start: 0;
            margin-block-end: 0;
            margin-inline-start: 1em;
            margin-inline-end: 0;
        }`)),await this.replaceResources(t);let i=this.serializer.serializeToString(t),s=URL.createObjectURL(new Blob([i],{type:this.#s}));return this.#n.set(e,s),s}resolveHref(e){let t=e.match(/filepos:(.*)/)[1],r=Number(t);return{index:this.#r.findIndex(a=>a.end>r),anchor:a=>a.getElementById(`filepos${t}`)}}splitTOCHref(e){let t=e.match(/filepos:(.*)/)[1],r=Number(t);return[this.#r.findIndex(s=>s.end>r),`filepos${t}`]}getTOCFragment(e,t){return e.getElementById(t)}isExternal(e){return/^(?!blob|filepos)\w+:/i.test(e)}},Ps=/kindle:(flow|embed):(\w+)(?:\?mime=(\w+\/[-+.\w]+))?/,$c=/kindle:pos:fid:(\w+):off:(\w+)/,Wc=n=>{let[e,t,r]=n.match(Ps).slice(1);return{resourceType:e,id:parseInt(t,32),type:r}},Fs=n=>{let[e,t]=n.match($c).slice(1);return{fid:parseInt(e,32),off:parseInt(t,32)}},Os=(n=0,e=0)=>`kindle:pos:fid:${n.toString(32).toUpperCase().padStart(4,"0")}:off:${e.toString(32).toUpperCase().padStart(10,"0")}`,Ms=n=>{let e=n.match(/\s(id|name|aid)\s*=\s*['"]([^'"]*)['"]/i);if(!e)return;let[,t,r]=e;return`[${t}="${CSS.escape(r)}"]`},jc=async(n,e,t)=>{let r=[];n.replace(e,(...s)=>(r.push(s),null));let i=[];for(let s of r)i.push(await t(...s));return n.replace(e,()=>i.shift())},Ur=class{parser=new DOMParser;#e=new Map;#t=new Map;#n=new Map;#r={};#i;#s;#a=new Uint8Array;#o=new Uint8Array;#l=-1;#d=-1;#c=!0;#u=Et.XHTML;constructor(e){this.mobi=e}async init(){let e=this.mobi.loadRecord.bind(this.mobi),{kf8:t}=this.mobi.headers;try{let o=await e(t.fdst),l=He(Cc,o);if(l.magic!=="FDST")throw new Error("Missing FDST record");let c=Array.from({length:l.numEntries},(u,d)=>12+d*8).map(u=>[Ce(o.slice(u,u+4)),Ce(o.slice(u+4,u+8))]);this.#r.fdstTable=c,this.#s=c[c.length-1][1]}catch{}let r=(await Dn(t.skel,e)).table.map(({name:o,tagMap:l},c)=>({index:c,name:o,numFrag:l[1][0],offset:l[6][0],length:l[6][1]})),i=await Dn(t.frag,e),s=i.table.map(({name:o,tagMap:l})=>({insertOffset:parseInt(o),selector:i.cncx[l[2][0]],index:l[4][0],offset:l[6][0],length:l[6][1]}));this.#r.skelTable=r,this.#r.fragTable=s,this.#i=r.reduce((o,l)=>{let c=o[o.length-1],u=c?.fragEnd??0,d=u+l.numFrag,h=s.slice(u,d),m=l.length+h.map(f=>f.length).reduce((f,p)=>f+p),w=(c?.totalLength??0)+m;return o.concat({skel:l,frags:h,fragEnd:d,length:m,totalLength:w})},[]),this.#i.unshift({frags:[]}),this.sections=this.#i.map((o,l)=>o.frags.length?{id:l,load:()=>this.loadSection(o),createDocument:()=>this.createDocument(o),size:o.length}:{linear:"no"});try{let o=await this.mobi.getNCX(),l=({label:c,pos:u,children:d})=>{let[h,m]=u,w=Os(h,m),f=this.#t.get(h);return f?f.push(m):this.#t.set(h,[m]),{label:pt(c),href:w,subitems:d?.map(l)}};this.toc=o?.map(l),this.landmarks=await this.getGuide()}catch{}let{exth:a}=this.mobi.headers;return this.dir=a.pageProgressionDirection,this.rendition={layout:a.fixedLayout==="true"?"pre-paginated":"reflowable",viewport:Object.fromEntries(a.originalResolution?.split("x")?.slice(0,2)?.map((o,l)=>[l?"height":"width",o])??[])},this.metadata=this.mobi.getMetadata(),this.getCover=this.mobi.getCover.bind(this.mobi),this}async getResourcesByMagic(e){let t={},r=this.mobi.headers.kf8.resourceStart,i=this.mobi.pdb.numRecords;for(let s=r;s<i;s++)try{let a=await this.mobi.loadMagic(s),o=e.find(l=>l===a);o&&(t[o]=s)}catch{}return t}async getGuide(){let e=this.mobi.headers.kf8.guide;if(e<4294967295){let t=this.mobi.loadRecord.bind(this.mobi),{table:r,cncx:i}=await Dn(e,t);return r.map(({name:s,tagMap:a})=>({label:i[a[1][0]]??"",type:s?.split(/\s/),href:Os(a[6]?.[0]??a[3]?.[0])}))}}async loadResourceBlob(e){let{resourceType:t,id:r,type:i}=Wc(e),s=t==="flow"?await this.loadFlow(r):await this.mobi.loadResource(r-1),a=[Et.XHTML,Et.HTML,Et.CSS,Et.SVG].includes(i)?await this.replaceResources(this.mobi.decode(s)):s;return new Blob([a],{type:i})}async loadResource(e){if(this.#e.has(e))return this.#e.get(e);let t=await this.loadResourceBlob(e),r=URL.createObjectURL(t);return this.#e.set(e,r),r}replaceResources(e){let t=new RegExp(Ps,"g");return jc(e,t,this.loadResource.bind(this))}async loadRaw(e,t){let r=t-this.#a.length,i=this.#s==null?1/0:this.#s-this.#o.length-e;if(r<0||r<i){for(;this.#a.length<t;){let a=++this.#l,o=await this.mobi.loadText(a);this.#a=Ln(this.#a,o)}return this.#a.slice(e,t)}for(;this.#s-this.#o.length>e;){let a=this.mobi.headers.palmdoc.numTextRecords-1-++this.#d,o=await this.mobi.loadText(a);this.#o=Ln(o,this.#o)}let s=this.#s-this.#o.length;return this.#o.slice(e-s,t-s)}loadFlow(e){if(e<4294967295)return this.loadRaw(...this.#r.fdstTable[e])}async loadText(e){let{skel:t,frags:r,length:i}=e,s=await this.loadRaw(t.offset,t.offset+i),a=s.slice(0,t.length);for(let o of r){let l=o.insertOffset-t.offset,c=t.length+o.offset,u=s.slice(c,c+o.length);a=Us(a.slice(0,l),u,a.slice(l));let d=this.#t.get(o.index);if(d)for(let h of d){let m=this.mobi.decode(u).slice(h),w=Ms(m);this.#f(o.index,h,w)}}return this.mobi.decode(a)}async createDocument(e){let t=await this.loadText(e);return this.parser.parseFromString(t,this.#u)}async loadSection(e){if(this.#e.has(e))return this.#e.get(e);let t=await this.loadText(e);this.#c&&this.parser.parseFromString(t,this.#u).querySelector("parsererror")&&(this.#u=Et.HTML),this.#c&&(this.#c=!1);let r=await this.replaceResources(t),i=URL.createObjectURL(new Blob([r],{type:this.#u}));return this.#e.set(e,i),i}getIndexByFID(e){return this.#i.findIndex(t=>t.frags.some(r=>r.index===e))}#f(e,t,r){let i=this.#n.get(e);if(i)i.set(t,r);else{let s=new Map;this.#n.set(e,s),s.set(t,r)}}async resolveHref(e){let{fid:t,off:r}=Fs(e),i=this.getIndexByFID(t);if(i<0)return;let s=this.#n.get(t)?.get(r);if(s)return{index:i,anchor:w=>w.querySelector(s)};let{skel:a,frags:o}=this.#i[i],l=o.find(w=>w.index===t),c=a.offset+a.length+l.offset,u=await this.loadRaw(c,c+l.length),d=this.mobi.decode(u).slice(r),h=Ms(d);return this.#f(t,r,h),{index:i,anchor:w=>w.querySelector(h)}}splitTOCHref(e){let t=Fs(e);return[this.getIndexByFID(t.fid),t]}getTOCFragment(e,{fid:t,off:r}){let i=this.#n.get(t)?.get(r);return e.querySelector(i)}isExternal(e){return/^(?!blob|kindle)\w+:/i.test(e)}};var we={CONTAINER:"urn:oasis:names:tc:opendocument:xmlns:container",XHTML:"http://www.w3.org/1999/xhtml",OPF:"http://www.idpf.org/2007/opf",EPUB:"http://www.idpf.org/2007/ops",DC:"http://purl.org/dc/elements/1.1/",DCTERMS:"http://purl.org/dc/terms/",ENC:"http://www.w3.org/2001/04/xmlenc#",NCX:"http://www.daisy.org/z3986/2005/ncx/",XLINK:"http://www.w3.org/1999/xlink",SMIL:"http://www.w3.org/ns/SMIL"},Re={XML:"application/xml",NCX:"application/x-dtbncx+xml",XHTML:"application/xhtml+xml",HTML:"text/html",CSS:"text/css",SVG:"image/svg+xml",JS:/\/(x-)?(javascript|ecmascript)/},Mn=n=>n.toLowerCase().replace(/[-:](.)/g,(e,t)=>t.toUpperCase()),Vc=n=>n?n.trim().replace(/\s{2,}/g," "):"",Zt=(n,e,t)=>t?r=>r.getAttribute(n)?.split(/\s/)?.includes(e):typeof e=="function"?r=>e(r.getAttribute(n)):r=>r.getAttribute(n)===e,Un=(...n)=>e=>e?Object.fromEntries(n.map(t=>[Mn(t),e.getAttribute(t)])):null,mt=n=>Vc(n?.textContent),Yt=(n,e)=>{let t=n.lookupNamespaceURI(null)===e||n.lookupPrefix(e),r=t?(i,s)=>a=>a.namespaceURI===e&&a.localName===s:(i,s)=>a=>a.localName===s;return{$:(i,s)=>[...i.children].find(r(i,s)),$$:(i,s)=>[...i.children].filter(r(i,s)),$$$:t?(i,s)=>[...i.getElementsByTagNameNS(e,s)]:(i,s)=>[...i.getElementsByTagName(e,s)]}},zt=(n,e)=>{try{if(e.includes(":"))return new URL(n,e);let t="file:///";return decodeURI(new URL(n,t+e).href.replace(t,""))}catch{return n}},Ws=n=>/^(?!blob)\w+:/i.test(n),qc=(n,e)=>{if(!n)return e;let t=n.replace(/\/$/,"").split("/"),r=e.replace(/\/$/,"").split("/"),i=(t.length>r.length?t:r).findIndex((s,a)=>t[a]!==r[a]);return i<0?"":Array(t.length-i).fill("..").concat(r.slice(i)).join("/")},Xc=n=>n.slice(0,n.lastIndexOf("/")+1),On=async(n,e,t)=>{let r=[];n.replace(e,(...s)=>(r.push(s),null));let i=[];for(let s of r)i.push(await t(...s));return n.replace(e,()=>i.shift())},Gc=n=>n.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),gt={attrs:["dir","xml:lang"]},kt={name:"alternate-script",many:!0,...gt,props:["file-as"]},Hs={many:!0,...gt,props:[{name:"role",many:!0,attrs:["scheme"]},"file-as",kt]},Zc=[{name:"title",many:!0,...gt,props:["title-type","display-seq","file-as",kt]},{name:"identifier",many:!0,props:[{name:"identifier-type",attrs:["scheme"]}]},{name:"language",many:!0},{name:"creator",...Hs},{name:"contributor",...Hs},{name:"publisher",...gt,props:["file-as",kt]},{name:"description",...gt,props:[kt]},{name:"rights",...gt,props:[kt]},{name:"date"},{name:"dcterms:modified",type:"meta"},{name:"subject",many:!0,...gt,props:["term","authority",kt]},{name:"belongs-to-collection",type:"meta",many:!0,...gt,props:["collection-type","group-position","dcterms:identifier","file-as",kt,{name:"belongs-to-collection",recursive:!0}]}],Kc=n=>{let{$:e,$$:t}=Yt(n,we.OPF),r=e(n.documentElement,"metadata"),i=Array.from(r.children),s=(d,h)=>{if(!h)return null;let{props:m=[],attrs:w=[]}=d,f=mt(h);if(!m.length&&!w.length)return f;let p=h.getAttribute("id"),g=p?i.filter(Zt("refines","#"+p)):[];return Object.fromEntries([["value",f]].concat(m.map(b=>{let{many:y,recursive:E}=b,_=typeof b=="string"?b:b.name,v=Zt("property",_),A=E?d:b;return[Mn(_),y?g.filter(v).map(x=>s(A,x)):s(A,g.find(v))]})).concat(w.map(b=>[Mn(b),h.getAttribute(b)])))},a=i.filter(Zt("refines",null)),o=Object.fromEntries(Zc.map(d=>{let{type:h,name:m,many:w}=d,f=h==="meta"?p=>p.namespaceURI===we.OPF&&p.getAttribute("property")===m:p=>p.namespaceURI===we.DC&&p.localName===m;return[Mn(m),w?a.filter(f).map(p=>s(d,p)):s(d,a.find(f))]})),l=d=>Object.fromEntries(t(r,"meta").filter(Zt("property",h=>h?.startsWith(d))).map(h=>[h.getAttribute("property").replace(d,""),mt(h)])),c=l("rendition:"),u=l("media:");return{metadata:o,rendition:c,media:u}},Yc=(n,e=t=>t)=>{let{$:t,$$:r,$$$:i}=Yt(n,we.XHTML),s=w=>w?decodeURI(e(w)):null,a=w=>f=>{let p=t(f,"a")??t(f,"span"),g=t(f,"ol"),b=s(p?.getAttribute("href")),E={label:mt(p)||p?.getAttribute("title"),href:b,subitems:o(g)};return w&&(E.type=p?.getAttributeNS(we.EPUB,"type")?.split(/\s/)),E},o=(w,f)=>w?r(w,"li").map(a(f)):null,l=(w,f)=>o(t(w,"ol"),f),c=i(n,"nav"),u=null,d=null,h=null,m=[];for(let w of c){let f=w.getAttributeNS(we.EPUB,"type")?.split(/\s/)??[];f.includes("toc")?u??=l(w):f.includes("page-list")?d??=l(w):f.includes("landmarks")?h??=l(w,!0):m.push({label:mt(w.firstElementChild),type:f,list:l(w)})}return{toc:u,pageList:d,landmarks:h,others:m}},Jc=(n,e=t=>t)=>{let{$:t,$$:r}=Yt(n,we.NCX),i=l=>l?decodeURI(e(l)):null,s=l=>{let c=t(l,"navLabel"),u=t(l,"content"),d=mt(c),h=i(u.getAttribute("src"));if(l.localName==="navPoint"){let m=r(l,"navPoint");return{label:d,href:h,subitems:m.length?m.map(s):null}}return{label:d,href:h}},a=(l,c)=>r(l,c).map(s),o=(l,c)=>{let u=t(n.documentElement,l);return u?a(u,c):null};return{toc:o("navMap","navPoint"),pageList:o("pageList","pageTarget"),others:r(n.documentElement,"navList").map(l=>({label:mt(t(l,"navLabel")),list:a(l,"navTarget")}))}},Nr=n=>{if(!n)return;let e=n.split(":").map(a=>parseFloat(a));if(e.length===3){let[a,o,l]=e;return a*60*60+o*60+l}if(e.length===2){let[a,o]=e;return a*60+o}let[t,r]=n.split(/(?=[^\d.])/),i=parseFloat(t),s=r==="h"?60*60:r==="min"?60:r==="ms"?.001:1;return i*s},Qc=(n,e=t=>t)=>{let{$:t,$$$:r}=Yt(n,we.SMIL),i=s=>s?decodeURI(e(s)):null;return r(n,"par").map(s=>{let a=t(s,"text")?.getAttribute("src")?.split("#")?.[1],o=t(s,"audio");return o?{id:a,audio:{src:i(o.getAttribute("src")),clipBegin:Nr(o.getAttribute("clipBegin")),clipEnd:Nr(o.getAttribute("clipEnd"))}}:{id:a}})},eu=/([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})/,tu=n=>{for(let e of n.getElementsByTagNameNS(we.DC,"identifier")){let[t]=mt(e).split(":").slice(-1);if(eu.test(t))return t}return""},js=n=>mt(n.getElementById(n.documentElement.getAttribute("unique-identifier"))??n.getElementsByTagNameNS(we.DC,"identifier")[0]),$s=async(n,e,t)=>{let r=new Uint8Array(await t.slice(0,e).arrayBuffer());e=Math.min(e,r.length);for(var i=0;i<e;i++)r[i]=r[i]^n[i%n.length];return new Blob([r,t.slice(e)],{type:t.type})},nu=async n=>{let e=new TextEncoder().encode(n),t=await globalThis.crypto.subtle.digest("SHA-1",e);return new Uint8Array(t)},ru=(n=nu)=>({"http://www.idpf.org/2008/embedding":{key:e=>n(js(e).replaceAll(/[\u0020\u0009\u000d\u000a]/g,"")),decode:(e,t)=>$s(e,1040,t)},"http://ns.adobe.com/pdf/enc#RC":{key:e=>{let t=tu(e).replaceAll("-","");return Uint8Array.from({length:16},(r,i)=>parseInt(t.slice(i*2,i*2+2),16))},decode:(e,t)=>$s(e,1024,t)}}),Pr=class{#e=new Map;#t=new Map;#n;constructor(e){this.#n=e}async init(e,t){if(!e)return;let r=Array.from(e.getElementsByTagNameNS(we.ENC,"EncryptedData"),i=>({algorithm:i.getElementsByTagNameNS(we.ENC,"EncryptionMethod")[0]?.getAttribute("Algorithm"),uri:i.getElementsByTagNameNS(we.ENC,"CipherReference")[0]?.getAttribute("URI")}));for(let{algorithm:i,uri:s}of r){if(!this.#t.has(i)){let a=this.#n[i];if(!a)continue;let o=await a.key(t);this.#t.set(i,l=>a.decode(o,l))}this.#e.set(s,i)}}getDecoder(e){return this.#t.get(this.#e.get(e))??(t=>t)}},Hr=class{constructor({opf:e,resolveHref:t}){this.opf=e;let{$:r,$$:i,$$$:s}=Yt(e,we.OPF),a=r(e.documentElement,"manifest"),o=r(e.documentElement,"spine"),l=i(o,"itemref");this.manifest=i(a,"item").map(Un("href","id","media-type","properties","media-overlay")).map(u=>(u.href=t(u.href),u.properties=u.properties?.split(/\s/),u)),this.spine=l.map(Un("idref","id","linear","properties")).map(u=>(u.properties=u.properties?.split(/\s/),u)),this.pageProgressionDirection=o.getAttribute("page-progression-direction"),this.navPath=this.getItemByProperty("nav")?.href,this.ncxPath=(this.getItemByID(o.getAttribute("toc"))??this.manifest.find(u=>u.mediaType===Re.NCX))?.href;let c=r(e.documentElement,"guide");c&&(this.guide=i(c,"reference").map(Un("type","title","href")).map(({type:u,title:d,href:h})=>({label:d,type:u.split(/\s/),href:t(h)}))),this.cover=this.getItemByProperty("cover-image")??this.getItemByID(s(e,"meta").find(Zt("name","cover"))?.getAttribute("content"))??this.getItemByHref(this.guide?.find(u=>u.type.includes("cover"))?.href),this.cfis=is(l)}getItemByID(e){return this.manifest.find(t=>t.id===e)}getItemByHref(e){return this.manifest.find(t=>t.href===e)}getItemByProperty(e){return this.manifest.find(t=>t.properties?.includes(e))}resolveCFI(e){let t=at(e),r=(t.parent??t).shift(),i=Er(this.opf,r);i&&i.nodeName!=="idref"&&(r.at(-1).id=null,i=Er(this.opf,r));let s=i?.getAttribute("idref");return{index:this.spine.findIndex(l=>l.idref===s),anchor:l=>wn(l,t)}}},$r=class{#e=new Map;#t=new Map;#n=new Map;allowScript=!1;constructor({loadText:e,loadBlob:t,resources:r}){this.loadText=e,this.loadBlob=t,this.manifest=r.manifest,this.assets=r.manifest}createURL(e,t,r,i){if(!t)return"";let s=URL.createObjectURL(new Blob([t],{type:r}));if(this.#e.set(e,s),this.#n.set(e,1),i){let a=this.#t.get(i);a?a.push(e):this.#t.set(i,[e])}return s}ref(e,t){let r=this.#t.get(t);return r?.includes(e)||(this.#n.set(e,this.#n.get(e)+1),r?r.push(e):this.#t.set(t,[e])),this.#e.get(e)}unref(e){if(!this.#n.has(e))return;let t=this.#n.get(e)-1;if(t<1){URL.revokeObjectURL(this.#e.get(e)),this.#e.delete(e),this.#n.delete(e);let r=this.#t.get(e);if(r)for(;r.length;)this.unref(r.pop());this.#t.delete(e)}else this.#n.set(e,t)}async loadItem(e,t=[]){if(!e)return null;let{href:r,mediaType:i}=e,s=Re.JS.test(e.mediaType);if(s&&!this.allowScript)return null;let a=t.at(-1);return this.#e.has(r)?this.ref(r,a):(s||[Re.XHTML,Re.HTML,Re.CSS,Re.SVG].includes(i))&&t.every(l=>l!==r)?this.loadReplaced(e,t):this.createURL(r,await this.loadBlob(r),i,a)}async loadHref(e,t,r=[]){if(Ws(e))return e;let i=zt(e,t),s=this.manifest.find(a=>a.href===i);return s?this.loadItem(s,r.concat(t)):e}async loadReplaced(e,t=[]){let{href:r,mediaType:i}=e,s=t.at(-1),a=await this.loadText(r);if(!a)return null;if([Re.XHTML,Re.HTML,Re.SVG].includes(i)){let l=new DOMParser().parseFromString(a,i);if(i===Re.XHTML&&l.querySelector("parsererror")&&(e.mediaType=Re.HTML,l=new DOMParser().parseFromString(a,e.mediaType)),[Re.XHTML,Re.SVG].includes(e.mediaType)){let d=l.firstChild;for(;d instanceof ProcessingInstruction;){if(d.data){let h=await On(d.data,/(?:^|\s*)(href\s*=\s*['"])([^'"]*)(['"])/i,(m,w,f,p)=>this.loadHref(f,r,t).then(g=>`${w}${g}${p}`));d.replaceWith(l.createProcessingInstruction(d.target,h))}d=d.nextSibling}}let c=async(d,h)=>d.setAttribute(h,await this.loadHref(d.getAttribute(h),r,t));for(let d of l.querySelectorAll("link[href]"))await c(d,"href");for(let d of l.querySelectorAll("[src]"))await c(d,"src");for(let d of l.querySelectorAll("[poster]"))await c(d,"poster");for(let d of l.querySelectorAll("object[data]"))await c(d,"data");for(let d of l.querySelectorAll("[*|href]:not([href]"))d.setAttributeNS(we.XLINK,"href",await this.loadHref(d.getAttributeNS(we.XLINK,"href"),r,t));for(let d of l.querySelectorAll("style"))d.textContent&&(d.textContent=await this.replaceCSS(d.textContent,r,t));for(let d of l.querySelectorAll("[style]"))d.setAttribute("style",await this.replaceCSS(d.getAttribute("style"),r,t));let u=new XMLSerializer().serializeToString(l);return this.createURL(r,u,e.mediaType,s)}let o=i===Re.CSS?await this.replaceCSS(a,r,t):await this.replaceString(a,r,t);return this.createURL(r,o,i,s)}async replaceCSS(e,t,r=[]){let i=await On(e,/url\(\s*["']?([^'"\n]*?)\s*["']?\s*\)/gi,(l,c)=>this.loadHref(c,t,r).then(u=>`url("${u}")`)),s=await On(i,/@import\s*["']([^"'\n]*?)["']/gi,(l,c)=>this.loadHref(c,t,r).then(u=>`@import "${u}"`)),a=window?.innerWidth??800,o=window?.innerHeight??600;return s.replace(/-epub-/gi,"").replace(/(\d*\.?\d+)vw/gi,(l,c)=>parseFloat(c)*a/100+"px").replace(/(\d*\.?\d+)vh/gi,(l,c)=>parseFloat(c)*o/100+"px").replace(/page-break-(after|before|inside)/gi,(l,c)=>`-webkit-column-break-${c}`)}replaceString(e,t,r=[]){let i=new Map,s=this.assets.map(o=>{if(o.href===t)return;let l=qc(Xc(t),o.href),c=encodeURI(l),u="/"+o.href,d=encodeURI(u),h=new Set([l,c,u,d]);for(let m of h)i.set(m,o);return Array.from(h)}).flat().filter(o=>o);if(!s.length)return e;let a=new RegExp(s.map(Gc).join("|"),"g");return On(e,a,async o=>this.loadItem(i.get(o.replace(/^\//,"")),r.concat(t)))}unloadItem(e){this.unref(e?.href)}},iu=(n,e)=>n.getElementById(e)??n.querySelector(`[name="${CSS.escape(e)}"]`),su=n=>{for(let e of n){if(e==="page-spread-left"||e==="rendition:page-spread-left")return"left";if(e==="page-spread-right"||e==="rendition:page-spread-right")return"right";if(e==="rendition:page-spread-center")return"center"}},Kt=class{parser=new DOMParser;#e;constructor({loadText:e,loadBlob:t,getSize:r,sha1:i}){this.loadText=e,this.loadBlob=t,this.getSize=r,this.#e=new Pr(ru(i))}#t(e){return e?this.parser.parseFromString(e,Re.XML):null}async#n(e){return this.#t(await this.loadText(e))}opfPath=null;async init(){let e=await this.#n("META-INF/container.xml");if(!e)throw new Error("Failed to load container file");let t=Array.from(e.getElementsByTagNameNS(we.CONTAINER,"rootfile"),Un("full-path","media-type")).filter(f=>f.mediaType==="application/oebps-package+xml");if(!t.length)throw new Error("No package document defined in container");let r=t[0].fullPath;this.opfPath=r;let i=await this.#n(r);if(!i)throw new Error("Failed to load package document");let s=await this.#n("META-INF/encryption.xml");await this.#e.init(s,i),this.resources=new Hr({opf:i,resolveHref:f=>zt(f,r)});let a=new $r({loadText:this.loadText,loadBlob:f=>Promise.resolve(this.loadBlob(f)).then(this.#e.getDecoder(f)),resources:this.resources});this.sections=this.resources.spine.map((f,p)=>{let{idref:g,linear:b,properties:y=[]}=f,E=this.resources.getItemByID(g);return E?{id:this.resources.getItemByID(g)?.href,load:()=>a.loadItem(E),unload:()=>a.unloadItem(E),createDocument:()=>this.loadDocument(E),size:this.getSize(E.href),cfi:this.resources.cfis[p],linear:b,pageSpread:su(y),resolveHref:_=>zt(_,E.href),loadMediaOverlay:()=>this.loadMediaOverlay(E)}:null}).filter(f=>f);let{navPath:o,ncxPath:l}=this.resources;if(o)try{let f=g=>zt(g,o),p=Yc(await this.#n(o),f);this.toc=p.toc,this.pageList=p.pageList,this.landmarks=p.landmarks}catch{}if(!this.toc&&l)try{let f=g=>zt(g,l),p=Jc(await this.#n(l),f);this.toc=p.toc,this.pageList=p.pageList}catch{}this.landmarks??=this.resources.guide;let{metadata:c,rendition:u,media:d}=Kc(i);this.rendition=u,this.media=d,d.duration=Nr(d.duration),this.dir=this.resources.pageProgressionDirection,this.rawMetadata=c;let h=c?.title?.[0];this.metadata={title:h?.value,sortAs:h?.fileAs,language:c?.language,identifier:js(i),description:c?.description?.value,publisher:c?.publisher?.value,published:c?.date,modified:c?.dctermsModified,subject:c?.subject?.filter(({value:f,code:p})=>f||p)?.map(({value:f,code:p,scheme:g})=>({name:f,code:p,scheme:g})),rights:c?.rights?.value};let m={art:"artist",aut:"author",bkp:"producer",clr:"colorist",edt:"editor",ill:"illustrator",trl:"translator",pbl:"publisher"},w=f=>p=>{let g=[...new Set(p.role?.map(({value:y,scheme:E})=>(!E||E==="marc:relators"?m[y]:null)??f))],b={name:p.value,sortAs:p.fileAs};return[g?.length?g:[f],b]};return c?.creator?.map(w("author"))?.concat(c?.contributor?.map?.(w("contributor")))?.forEach(([f,p])=>f.forEach(g=>{this.metadata[g]?this.metadata[g].push(p):this.metadata[g]=[p]})),this}async loadDocument(e){let t=await this.loadText(e.href);return this.parser.parseFromString(t,e.mediaType)}async loadMediaOverlay(e){let t=e.mediaOverlay;if(!t)return null;let r=this.resources.getItemByID(t),i=await this.#n(r.href);return Qc(i,a=>zt(a,r.href))}resolveCFI(e){return this.resources.resolveCFI(e)}resolveHref(e){let[t,r]=e.split("#"),i=this.resources.getItemByHref(decodeURI(t));return i?{index:this.resources.spine.findIndex(({idref:o})=>o===i.id),anchor:r?o=>iu(o,r):()=>0}:null}splitTOCHref(e){return e?.split("#")??[]}getTOCFragment(e,t){return e.getElementById(t)??e.querySelector(`[name="${CSS.escape(t)}"]`)}isExternal(e){return Ws(e)}async getCover(){let e=this.resources?.cover;return e?.href?new Blob([await this.loadBlob(e.href)],{type:e.mediaType}):null}async getCalibreBookmarks(){let e=await this.loadText("META-INF/calibre_bookmarks.txt"),t="encoding=json+base64:";if(e?.startsWith(t)){let r=atob(e.slice(t.length));return JSON.parse(r)}}};var Ii={};Fl(Ii,{BlobReader:()=>xi,BlobWriter:()=>_i,Data64URIReader:()=>zd,Data64URIWriter:()=>Dd,ERR_BAD_FORMAT:()=>Zn,ERR_CENTRAL_DIRECTORY_NOT_FOUND:()=>Lo,ERR_DUPLICATED_NAME:()=>Po,ERR_ENCRYPTED:()=>Mo,ERR_EOCDR_LOCATOR_ZIP64_NOT_FOUND:()=>Do,ERR_EOCDR_NOT_FOUND:()=>Io,ERR_EOCDR_ZIP64_NOT_FOUND:()=>zo,ERR_EXTRAFIELD_ZIP64_NOT_FOUND:()=>Oo,ERR_HTTP_RANGE:()=>ln,ERR_INVALID_COMMENT:()=>Ho,ERR_INVALID_ENCRYPTION_STRENGTH:()=>jo,ERR_INVALID_ENTRY_COMMENT:()=>$o,ERR_INVALID_ENTRY_NAME:()=>Wo,ERR_INVALID_EXTRAFIELD_DATA:()=>qo,ERR_INVALID_EXTRAFIELD_TYPE:()=>Vo,ERR_INVALID_PASSWORD:()=>pi,ERR_INVALID_SIGNATURE:()=>gi,ERR_INVALID_VERSION:()=>hi,ERR_ITERATOR_COMPLETED_TOO_SOON:()=>lo,ERR_LOCAL_FILE_HEADER_NOT_FOUND:()=>Fo,ERR_SPLIT_ZIP_FILE:()=>di,ERR_UNSUPPORTED_COMPRESSION:()=>ui,ERR_UNSUPPORTED_ENCRYPTION:()=>Uo,ERR_UNSUPPORTED_FORMAT:()=>or,HttpRangeReader:()=>Ud,HttpReader:()=>mo,Reader:()=>At,SplitDataReader:()=>Si,SplitDataWriter:()=>an,SplitZipReader:()=>Hd,SplitZipWriter:()=>$d,TextReader:()=>Ld,TextWriter:()=>Fd,Uint8ArrayReader:()=>Bd,Uint8ArrayWriter:()=>Nd,Writer:()=>vi,ZipReader:()=>Kd,ZipWriter:()=>sh,configure:()=>ir,getMimeType:()=>Bu,initReader:()=>Ei,initStream:()=>ot,initWriter:()=>ki,readUint8Array:()=>Se,terminateWorkers:()=>_d});function nr(n){return rr(n.map(([e,t])=>new Array(e).fill(t,0,e)))}function rr(n){return n.reduce((e,t)=>e.concat(Array.isArray(t)?rr(t):t),[])}var Vs=[0,1,2,3].concat(...nr([[2,4],[2,5],[4,6],[4,7],[8,8],[8,9],[16,10],[16,11],[32,12],[32,13],[64,14],[64,15],[2,0],[1,16],[1,17],[2,18],[2,19],[4,20],[4,21],[8,22],[8,23],[16,24],[16,25],[32,26],[32,27],[64,28],[64,29]]));function se(){let n=this;function e(i){let s=n.dyn_tree,a=n.stat_desc.static_tree,o=n.stat_desc.extra_bits,l=n.stat_desc.extra_base,c=n.stat_desc.max_length,u,d,h,m,w,f,p=0;for(m=0;m<=15;m++)i.bl_count[m]=0;for(s[i.heap[i.heap_max]*2+1]=0,u=i.heap_max+1;u<573;u++)d=i.heap[u],m=s[s[d*2+1]*2+1]+1,m>c&&(m=c,p++),s[d*2+1]=m,!(d>n.max_code)&&(i.bl_count[m]++,w=0,d>=l&&(w=o[d-l]),f=s[d*2],i.opt_len+=f*(m+w),a&&(i.static_len+=f*(a[d*2+1]+w)));if(p!==0){do{for(m=c-1;i.bl_count[m]===0;)m--;i.bl_count[m]--,i.bl_count[m+1]+=2,i.bl_count[c]--,p-=2}while(p>0);for(m=c;m!==0;m--)for(d=i.bl_count[m];d!==0;)h=i.heap[--u],!(h>n.max_code)&&(s[h*2+1]!=m&&(i.opt_len+=(m-s[h*2+1])*s[h*2],s[h*2+1]=m),d--)}}function t(i,s){let a=0;do a|=i&1,i>>>=1,a<<=1;while(--s>0);return a>>>1}function r(i,s,a){let o=[],l=0,c,u,d;for(c=1;c<=15;c++)o[c]=l=l+a[c-1]<<1;for(u=0;u<=s;u++)d=i[u*2+1],d!==0&&(i[u*2]=t(o[d]++,d))}n.build_tree=function(i){let s=n.dyn_tree,a=n.stat_desc.static_tree,o=n.stat_desc.elems,l,c,u=-1,d;for(i.heap_len=0,i.heap_max=573,l=0;l<o;l++)s[l*2]!==0?(i.heap[++i.heap_len]=u=l,i.depth[l]=0):s[l*2+1]=0;for(;i.heap_len<2;)d=i.heap[++i.heap_len]=u<2?++u:0,s[d*2]=1,i.depth[d]=0,i.opt_len--,a&&(i.static_len-=a[d*2+1]);for(n.max_code=u,l=Math.floor(i.heap_len/2);l>=1;l--)i.pqdownheap(s,l);d=o;do l=i.heap[1],i.heap[1]=i.heap[i.heap_len--],i.pqdownheap(s,1),c=i.heap[1],i.heap[--i.heap_max]=l,i.heap[--i.heap_max]=c,s[d*2]=s[l*2]+s[c*2],i.depth[d]=Math.max(i.depth[l],i.depth[c])+1,s[l*2+1]=s[c*2+1]=d,i.heap[1]=d++,i.pqdownheap(s,1);while(i.heap_len>=2);i.heap[--i.heap_max]=i.heap[1],e(i),r(s,n.max_code,i.bl_count)}}se._length_code=[0,1,2,3,4,5,6,7].concat(...nr([[2,8],[2,9],[2,10],[2,11],[4,12],[4,13],[4,14],[4,15],[8,16],[8,17],[8,18],[8,19],[16,20],[16,21],[16,22],[16,23],[32,24],[32,25],[32,26],[31,27],[1,28]]));se.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0];se.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576];se.d_code=function(n){return n<256?Vs[n]:Vs[256+(n>>>7)]};se.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0];se.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];se.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7];se.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function be(n,e,t,r,i){let s=this;s.static_tree=n,s.extra_bits=e,s.extra_base=t,s.elems=r,s.max_length=i}var au=[12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,19,275,147,403,83,339,211,467,51,307,179,435,115,371,243,499,11,267,139,395,75,331,203,459,43,299,171,427,107,363,235,491,27,283,155,411,91,347,219,475,59,315,187,443,123,379,251,507,7,263,135,391,71,327,199,455,39,295,167,423,103,359,231,487,23,279,151,407,87,343,215,471,55,311,183,439,119,375,247,503,15,271,143,399,79,335,207,463,47,303,175,431,111,367,239,495,31,287,159,415,95,351,223,479,63,319,191,447,127,383,255,511,0,64,32,96,16,80,48,112,8,72,40,104,24,88,56,120,4,68,36,100,20,84,52,116,3,131,67,195,35,163,99,227],ou=nr([[144,8],[112,9],[24,7],[8,8]]);be.static_ltree=rr(au.map((n,e)=>[n,ou[e]]));var lu=[0,16,8,24,4,20,12,28,2,18,10,26,6,22,14,30,1,17,9,25,5,21,13,29,3,19,11,27,7,23],cu=nr([[30,5]]);be.static_dtree=rr(lu.map((n,e)=>[n,cu[e]]));be.static_l_desc=new be(be.static_ltree,se.extra_lbits,257,286,15);be.static_d_desc=new be(be.static_dtree,se.extra_dbits,0,30,15);be.static_bl_desc=new be(null,se.extra_blbits,0,19,7);var uu=9,du=8;function Qe(n,e,t,r,i){let s=this;s.good_length=n,s.max_lazy=e,s.nice_length=t,s.max_chain=r,s.func=i}var La=0,qn=1,Ct=2,Ze=[new Qe(0,0,0,0,La),new Qe(4,4,8,4,qn),new Qe(4,5,16,8,qn),new Qe(4,6,32,32,qn),new Qe(4,4,16,16,Ct),new Qe(8,16,32,32,Ct),new Qe(8,16,128,128,Ct),new Qe(8,32,128,256,Ct),new Qe(32,128,258,1024,Ct),new Qe(32,258,258,4096,Ct)],Bn=["need dictionary","stream end","","","stream error","data error","","buffer error","",""],Ke=0,Nn=1,Jt=2,Pn=3,hu=32,Wr=42,Hn=113,Qt=666,jr=8,fu=0,Vr=1,pu=2,ae=3,Xn=258,Me=Xn+ae+1;function qs(n,e,t,r){let i=n[e*2],s=n[t*2];return i<s||i==s&&r[e]<=r[t]}function gu(){let n=this,e,t,r,i,s,a,o,l,c,u,d,h,m,w,f,p,g,b,y,E,_,v,A,x,k,S,T,D,R,U,z,O,M,P=new se,Z=new se,B=new se;n.depth=[];let q,H,W,K,V,Y;n.bl_count=[],n.heap=[],z=[],O=[],M=[];function he(){c=2*s,d[m-1]=0;for(let C=0;C<m-1;C++)d[C]=0;S=Ze[T].max_lazy,R=Ze[T].good_length,U=Ze[T].nice_length,k=Ze[T].max_chain,_=0,g=0,A=0,b=x=ae-1,E=0,h=0}function fe(){let C;for(C=0;C<286;C++)z[C*2]=0;for(C=0;C<30;C++)O[C*2]=0;for(C=0;C<19;C++)M[C*2]=0;z[256*2]=1,n.opt_len=n.static_len=0,H=W=0}function ze(){P.dyn_tree=z,P.stat_desc=be.static_l_desc,Z.dyn_tree=O,Z.stat_desc=be.static_d_desc,B.dyn_tree=M,B.stat_desc=be.static_bl_desc,V=0,Y=0,K=8,fe()}n.pqdownheap=function(C,L){let I=n.heap,F=I[L],N=L<<1;for(;N<=n.heap_len&&(N<n.heap_len&&qs(C,I[N+1],I[N],n.depth)&&N++,!qs(C,F,I[N],n.depth));)I[L]=I[N],L=N,N<<=1;I[L]=F};function oe(C,L){let I=-1,F,N=C[0*2+1],$=0,G=7,Te=4;N===0&&(G=138,Te=3),C[(L+1)*2+1]=65535;for(let Xe=0;Xe<=L;Xe++)F=N,N=C[(Xe+1)*2+1],!(++$<G&&F==N)&&($<Te?M[F*2]+=$:F!==0?(F!=I&&M[F*2]++,M[16*2]++):$<=10?M[17*2]++:M[18*2]++,$=0,I=F,N===0?(G=138,Te=3):F==N?(G=6,Te=3):(G=7,Te=4))}function Oe(){let C;for(oe(z,P.max_code),oe(O,Z.max_code),B.build_tree(n),C=18;C>=3&&M[se.bl_order[C]*2+1]===0;C--);return n.opt_len+=3*(C+1)+5+5+4,C}function ke(C){n.pending_buf[n.pending++]=C}function Ne(C){ke(C&255),ke(C>>>8&255)}function De(C){ke(C>>8&255),ke(C&255&255)}function ue(C,L){let I,F=L;Y>16-F?(I=C,V|=I<<Y&65535,Ne(V),V=I>>>16-Y,Y+=F-16):(V|=C<<Y&65535,Y+=F)}function me(C,L){let I=C*2;ue(L[I]&65535,L[I+1]&65535)}function St(C,L){let I,F=-1,N,$=C[0*2+1],G=0,Te=7,Xe=4;for($===0&&(Te=138,Xe=3),I=0;I<=L;I++)if(N=$,$=C[(I+1)*2+1],!(++G<Te&&N==$)){if(G<Xe)do me(N,M);while(--G!==0);else N!==0?(N!=F&&(me(N,M),G--),me(16,M),ue(G-3,2)):G<=10?(me(17,M),ue(G-3,3)):(me(18,M),ue(G-11,7));G=0,F=N,$===0?(Te=138,Xe=3):N==$?(Te=6,Xe=3):(Te=7,Xe=4)}}function qe(C,L,I){let F;for(ue(C-257,5),ue(L-1,5),ue(I-4,4),F=0;F<I;F++)ue(M[se.bl_order[F]*2+1],3);St(z,C-1),St(O,L-1)}function fn(){Y==16?(Ne(V),V=0,Y=0):Y>=8&&(ke(V&255),V>>>=8,Y-=8)}function br(){ue(Vr<<1,3),me(256,be.static_ltree),fn(),1+K+10-Y<9&&(ue(Vr<<1,3),me(256,be.static_ltree),fn()),K=7}function st(C,L){let I,F,N;if(n.dist_buf[H]=C,n.lc_buf[H]=L&255,H++,C===0?z[L*2]++:(W++,C--,z[(se._length_code[L]+256+1)*2]++,O[se.d_code(C)*2]++),!(H&8191)&&T>2){for(I=H*8,F=_-g,N=0;N<30;N++)I+=O[N*2]*(5+se.extra_dbits[N]);if(I>>>=3,W<Math.floor(H/2)&&I<Math.floor(F/2))return!0}return H==q-1}function Vi(C,L){let I,F,N=0,$,G;if(H!==0)do I=n.dist_buf[N],F=n.lc_buf[N],N++,I===0?me(F,C):($=se._length_code[F],me($+256+1,C),G=se.extra_lbits[$],G!==0&&(F-=se.base_length[$],ue(F,G)),I--,$=se.d_code(I),me($,L),G=se.extra_dbits[$],G!==0&&(I-=se.base_dist[$],ue(I,G)));while(N<H);me(256,C),K=C[256*2+1]}function qi(){Y>8?Ne(V):Y>0&&ke(V&255),V=0,Y=0}function Tl(C,L,I){qi(),K=8,I&&(Ne(L),Ne(~L)),n.pending_buf.set(l.subarray(C,C+L),n.pending),n.pending+=L}function Xi(C,L,I){ue((fu<<1)+(I?1:0),3),Tl(C,L,!0)}function Cl(C,L,I){let F,N,$=0;T>0?(P.build_tree(n),Z.build_tree(n),$=Oe(),F=n.opt_len+3+7>>>3,N=n.static_len+3+7>>>3,N<=F&&(F=N)):F=N=L+5,L+4<=F&&C!=-1?Xi(C,L,I):N==F?(ue((Vr<<1)+(I?1:0),3),Vi(be.static_ltree,be.static_dtree)):(ue((pu<<1)+(I?1:0),3),qe(P.max_code+1,Z.max_code+1,$+1),Vi(z,O)),fe(),I&&qi()}function ht(C){Cl(g>=0?g:-1,_-g,C),g=_,e.flush_pending()}function yr(){let C,L,I,F;do{if(F=c-A-_,F===0&&_===0&&A===0)F=s;else if(F==-1)F--;else if(_>=s+s-Me){l.set(l.subarray(s,s+s),0),v-=s,_-=s,g-=s,C=m,I=C;do L=d[--I]&65535,d[I]=L>=s?L-s:0;while(--C!==0);C=s,I=C;do L=u[--I]&65535,u[I]=L>=s?L-s:0;while(--C!==0);F+=s}if(e.avail_in===0)return;C=e.read_buf(l,_+A,F),A+=C,A>=ae&&(h=l[_]&255,h=(h<<p^l[_+1]&255)&f)}while(A<Me&&e.avail_in!==0)}function Rl(C){let L=65535,I;for(L>r-5&&(L=r-5);;){if(A<=1){if(yr(),A===0&&C==0)return Ke;if(A===0)break}if(_+=A,A=0,I=g+L,(_===0||_>=I)&&(A=_-I,_=I,ht(!1),e.avail_out===0)||_-g>=s-Me&&(ht(!1),e.avail_out===0))return Ke}return ht(C==4),e.avail_out===0?C==4?Jt:Ke:C==4?Pn:Nn}function Gi(C){let L=k,I=_,F,N,$=x,G=_>s-Me?_-(s-Me):0,Te=U,Xe=o,vr=_+Xn,Zi=l[I+$-1],Ki=l[I+$];x>=R&&(L>>=2),Te>A&&(Te=A);do if(F=C,!(l[F+$]!=Ki||l[F+$-1]!=Zi||l[F]!=l[I]||l[++F]!=l[I+1])){I+=2,F++;do;while(l[++I]==l[++F]&&l[++I]==l[++F]&&l[++I]==l[++F]&&l[++I]==l[++F]&&l[++I]==l[++F]&&l[++I]==l[++F]&&l[++I]==l[++F]&&l[++I]==l[++F]&&I<vr);if(N=Xn-(vr-I),I=vr-Xn,N>$){if(v=C,$=N,N>=Te)break;Zi=l[I+$-1],Ki=l[I+$]}}while((C=u[C&Xe]&65535)>G&&--L!==0);return $<=A?$:A}function Il(C){let L=0,I;for(;;){if(A<Me){if(yr(),A<Me&&C==0)return Ke;if(A===0)break}if(A>=ae&&(h=(h<<p^l[_+(ae-1)]&255)&f,L=d[h]&65535,u[_&o]=d[h],d[h]=_),L!==0&&(_-L&65535)<=s-Me&&D!=2&&(b=Gi(L)),b>=ae)if(I=st(_-v,b-ae),A-=b,b<=S&&A>=ae){b--;do _++,h=(h<<p^l[_+(ae-1)]&255)&f,L=d[h]&65535,u[_&o]=d[h],d[h]=_;while(--b!==0);_++}else _+=b,b=0,h=l[_]&255,h=(h<<p^l[_+1]&255)&f;else I=st(0,l[_]&255),A--,_++;if(I&&(ht(!1),e.avail_out===0))return Ke}return ht(C==4),e.avail_out===0?C==4?Jt:Ke:C==4?Pn:Nn}function zl(C){let L=0,I,F;for(;;){if(A<Me){if(yr(),A<Me&&C==0)return Ke;if(A===0)break}if(A>=ae&&(h=(h<<p^l[_+(ae-1)]&255)&f,L=d[h]&65535,u[_&o]=d[h],d[h]=_),x=b,y=v,b=ae-1,L!==0&&x<S&&(_-L&65535)<=s-Me&&(D!=2&&(b=Gi(L)),b<=5&&(D==1||b==ae&&_-v>4096)&&(b=ae-1)),x>=ae&&b<=x){F=_+A-ae,I=st(_-1-y,x-ae),A-=x-1,x-=2;do++_<=F&&(h=(h<<p^l[_+(ae-1)]&255)&f,L=d[h]&65535,u[_&o]=d[h],d[h]=_);while(--x!==0);if(E=0,b=ae-1,_++,I&&(ht(!1),e.avail_out===0))return Ke}else if(E!==0){if(I=st(0,l[_-1]&255),I&&ht(!1),_++,A--,e.avail_out===0)return Ke}else E=1,_++,A--}return E!==0&&(I=st(0,l[_-1]&255),E=0),ht(C==4),e.avail_out===0?C==4?Jt:Ke:C==4?Pn:Nn}function Dl(C){return C.total_in=C.total_out=0,C.msg=null,n.pending=0,n.pending_out=0,t=Hn,i=0,ze(),he(),0}n.deflateInit=function(C,L,I,F,N,$){return F||(F=jr),N||(N=du),$||($=0),C.msg=null,L==-1&&(L=6),N<1||N>uu||F!=jr||I<9||I>15||L<0||L>9||$<0||$>2?-2:(C.dstate=n,a=I,s=1<<a,o=s-1,w=N+7,m=1<<w,f=m-1,p=Math.floor((w+ae-1)/ae),l=new Uint8Array(s*2),u=[],d=[],q=1<<N+6,n.pending_buf=new Uint8Array(q*4),r=q*4,n.dist_buf=new Uint16Array(q),n.lc_buf=new Uint8Array(q),T=L,D=$,Dl(C))},n.deflateEnd=function(){return t!=Wr&&t!=Hn&&t!=Qt?-2:(n.lc_buf=null,n.dist_buf=null,n.pending_buf=null,d=null,u=null,l=null,n.dstate=null,t==Hn?-3:0)},n.deflateParams=function(C,L,I){let F=0;return L==-1&&(L=6),L<0||L>9||I<0||I>2?-2:(Ze[T].func!=Ze[L].func&&C.total_in!==0&&(F=C.deflate(1)),T!=L&&(T=L,S=Ze[T].max_lazy,R=Ze[T].good_length,U=Ze[T].nice_length,k=Ze[T].max_chain),D=I,F)},n.deflateSetDictionary=function(C,L,I){let F=I,N,$=0;if(!L||t!=Wr)return-2;if(F<ae)return 0;for(F>s-Me&&(F=s-Me,$=I-F),l.set(L.subarray($,$+F),0),_=F,g=F,h=l[0]&255,h=(h<<p^l[1]&255)&f,N=0;N<=F-ae;N++)h=(h<<p^l[N+(ae-1)]&255)&f,u[N&o]=d[h],d[h]=N;return 0},n.deflate=function(C,L){let I,F,N,$,G;if(L>4||L<0)return-2;if(!C.next_out||!C.next_in&&C.avail_in!==0||t==Qt&&L!=4)return C.msg=Bn[4],-2;if(C.avail_out===0)return C.msg=Bn[7],-5;if(e=C,$=i,i=L,t==Wr&&(F=jr+(a-8<<4)<<8,N=(T-1&255)>>1,N>3&&(N=3),F|=N<<6,_!==0&&(F|=hu),F+=31-F%31,t=Hn,De(F)),n.pending!==0){if(e.flush_pending(),e.avail_out===0)return i=-1,0}else if(e.avail_in===0&&L<=$&&L!=4)return e.msg=Bn[7],-5;if(t==Qt&&e.avail_in!==0)return C.msg=Bn[7],-5;if(e.avail_in!==0||A!==0||L!=0&&t!=Qt){switch(G=-1,Ze[T].func){case La:G=Rl(L);break;case qn:G=Il(L);break;case Ct:G=zl(L);break;default:}if((G==Jt||G==Pn)&&(t=Qt),G==Ke||G==Jt)return e.avail_out===0&&(i=-1),0;if(G==Nn){if(L==1)br();else if(Xi(0,0,!1),L==3)for(I=0;I<m;I++)d[I]=0;if(e.flush_pending(),e.avail_out===0)return i=-1,0}}return L!=4?0:1}}function Fa(){let n=this;n.next_in_index=0,n.next_out_index=0,n.avail_in=0,n.total_in=0,n.avail_out=0,n.total_out=0}Fa.prototype={deflateInit(n,e){let t=this;return t.dstate=new gu,e||(e=15),t.dstate.deflateInit(t,n,e)},deflate(n){let e=this;return e.dstate?e.dstate.deflate(e,n):-2},deflateEnd(){let n=this;if(!n.dstate)return-2;let e=n.dstate.deflateEnd();return n.dstate=null,e},deflateParams(n,e){let t=this;return t.dstate?t.dstate.deflateParams(t,n,e):-2},deflateSetDictionary(n,e){let t=this;return t.dstate?t.dstate.deflateSetDictionary(t,n,e):-2},read_buf(n,e,t){let r=this,i=r.avail_in;return i>t&&(i=t),i===0?0:(r.avail_in-=i,n.set(r.next_in.subarray(r.next_in_index,r.next_in_index+i),e),r.next_in_index+=i,r.total_in+=i,i)},flush_pending(){let n=this,e=n.dstate.pending;e>n.avail_out&&(e=n.avail_out),e!==0&&(n.next_out.set(n.dstate.pending_buf.subarray(n.dstate.pending_out,n.dstate.pending_out+e),n.next_out_index),n.next_out_index+=e,n.dstate.pending_out+=e,n.total_out+=e,n.avail_out-=e,n.dstate.pending-=e,n.dstate.pending===0&&(n.dstate.pending_out=0))}};function mu(n){let e=this,t=new Fa,r=wu(n&&n.chunkSize?n.chunkSize:64*1024),i=0,s=new Uint8Array(r),a=n?n.level:-1;typeof a>"u"&&(a=-1),t.deflateInit(a),t.next_out=s,e.append=function(o,l){let c,u,d=0,h=0,m=0,w=[];if(o.length){t.next_in_index=0,t.next_in=o,t.avail_in=o.length;do{if(t.next_out_index=0,t.avail_out=r,c=t.deflate(i),c!=0)throw new Error("deflating: "+t.msg);t.next_out_index&&(t.next_out_index==r?w.push(new Uint8Array(s)):w.push(s.slice(0,t.next_out_index))),m+=t.next_out_index,l&&t.next_in_index>0&&t.next_in_index!=d&&(l(t.next_in_index),d=t.next_in_index)}while(t.avail_in>0||t.avail_out===0);return w.length>1?(u=new Uint8Array(m),w.forEach(function(f){u.set(f,h),h+=f.length})):u=w[0]||new Uint8Array,u}},e.flush=function(){let o,l,c=0,u=0,d=[];do{if(t.next_out_index=0,t.avail_out=r,o=t.deflate(4),o!=1&&o!=0)throw new Error("deflating: "+t.msg);r-t.avail_out>0&&d.push(s.slice(0,t.next_out_index)),u+=t.next_out_index}while(t.avail_in>0||t.avail_out===0);return t.deflateEnd(),l=new Uint8Array(u),d.forEach(function(h){l.set(h,c),c+=h.length}),l}}function wu(n){return n+5*(Math.floor(n/16383)+1)}var Ue=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],Oa=1440,bu=0,yu=4,vu=9,xu=5,_u=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],Au=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],Su=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Eu=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],ku=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Tu=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],wt=15;function ti(){let n=this,e,t,r,i,s,a;function o(c,u,d,h,m,w,f,p,g,b,y){let E,_,v,A,x,k,S,T,D,R,U,z,O,M,P;R=0,x=d;do r[c[u+R]]++,R++,x--;while(x!==0);if(r[0]==d)return f[0]=-1,p[0]=0,0;for(T=p[0],k=1;k<=wt&&r[k]===0;k++);for(S=k,T<k&&(T=k),x=wt;x!==0&&r[x]===0;x--);for(v=x,T>x&&(T=x),p[0]=T,M=1<<k;k<x;k++,M<<=1)if((M-=r[k])<0)return-3;if((M-=r[x])<0)return-3;for(r[x]+=M,a[1]=k=0,R=1,O=2;--x!==0;)a[O]=k+=r[R],O++,R++;x=0,R=0;do(k=c[u+R])!==0&&(y[a[k]++]=x),R++;while(++x<d);for(d=a[v],a[0]=x=0,R=0,A=-1,z=-T,s[0]=0,U=0,P=0;S<=v;S++)for(E=r[S];E--!==0;){for(;S>z+T;){if(A++,z+=T,P=v-z,P=P>T?T:P,(_=1<<(k=S-z))>E+1&&(_-=E+1,O=S,k<P))for(;++k<P&&!((_<<=1)<=r[++O]);)_-=r[O];if(P=1<<k,b[0]+P>Oa)return-3;s[A]=U=b[0],b[0]+=P,A!==0?(a[A]=x,i[0]=k,i[1]=T,k=x>>>z-T,i[2]=U-s[A-1]-k,g.set(i,(s[A-1]+k)*3)):f[0]=U}for(i[1]=S-z,R>=d?i[0]=192:y[R]<h?(i[0]=y[R]<256?0:96,i[2]=y[R++]):(i[0]=w[y[R]-h]+16+64,i[2]=m[y[R++]-h]),_=1<<S-z,k=x>>>z;k<P;k+=_)g.set(i,(U+k)*3);for(k=1<<S-1;x&k;k>>>=1)x^=k;for(x^=k,D=(1<<z)-1;(x&D)!=a[A];)A--,z-=T,D=(1<<z)-1}return M!==0&&v!=1?-5:0}function l(c){let u;for(e||(e=[],t=[],r=new Int32Array(wt+1),i=[],s=new Int32Array(wt),a=new Int32Array(wt+1)),t.length<c&&(t=[]),u=0;u<c;u++)t[u]=0;for(u=0;u<wt+1;u++)r[u]=0;for(u=0;u<3;u++)i[u]=0;s.set(r.subarray(0,wt),0),a.set(r.subarray(0,wt+1),0)}n.inflate_trees_bits=function(c,u,d,h,m){let w;return l(19),e[0]=0,w=o(c,0,19,19,null,null,d,u,h,e,t),w==-3?m.msg="oversubscribed dynamic bit lengths tree":(w==-5||u[0]===0)&&(m.msg="incomplete dynamic bit lengths tree",w=-3),w},n.inflate_trees_dynamic=function(c,u,d,h,m,w,f,p,g){let b;return l(288),e[0]=0,b=o(d,0,c,257,Su,Eu,w,h,p,e,t),b!=0||h[0]===0?(b==-3?g.msg="oversubscribed literal/length tree":b!=-4&&(g.msg="incomplete literal/length tree",b=-3),b):(l(288),b=o(d,c,u,0,ku,Tu,f,m,p,e,t),b!=0||m[0]===0&&c>257?(b==-3?g.msg="oversubscribed distance tree":b==-5?(g.msg="incomplete distance tree",b=-3):b!=-4&&(g.msg="empty distance tree with lengths",b=-3),b):0)}}ti.inflate_trees_fixed=function(n,e,t,r){return n[0]=vu,e[0]=xu,t[0]=_u,r[0]=Au,0};var $n=0,Xs=1,Gs=2,Zs=3,Ks=4,Ys=5,Js=6,qr=7,Qs=8,Wn=9;function Cu(){let n=this,e,t=0,r,i=0,s=0,a=0,o=0,l=0,c=0,u=0,d,h=0,m,w=0;function f(p,g,b,y,E,_,v,A){let x,k,S,T,D,R,U,z,O,M,P,Z,B,q,H,W;U=A.next_in_index,z=A.avail_in,D=v.bitb,R=v.bitk,O=v.write,M=O<v.read?v.read-O-1:v.end-O,P=Ue[p],Z=Ue[g];do{for(;R<20;)z--,D|=(A.read_byte(U++)&255)<<R,R+=8;if(x=D&P,k=b,S=y,W=(S+x)*3,(T=k[W])===0){D>>=k[W+1],R-=k[W+1],v.win[O++]=k[W+2],M--;continue}do{if(D>>=k[W+1],R-=k[W+1],T&16){for(T&=15,B=k[W+2]+(D&Ue[T]),D>>=T,R-=T;R<15;)z--,D|=(A.read_byte(U++)&255)<<R,R+=8;x=D&Z,k=E,S=_,W=(S+x)*3,T=k[W];do if(D>>=k[W+1],R-=k[W+1],T&16){for(T&=15;R<T;)z--,D|=(A.read_byte(U++)&255)<<R,R+=8;if(q=k[W+2]+(D&Ue[T]),D>>=T,R-=T,M-=B,O>=q)H=O-q,O-H>0&&2>O-H?(v.win[O++]=v.win[H++],v.win[O++]=v.win[H++],B-=2):(v.win.set(v.win.subarray(H,H+2),O),O+=2,H+=2,B-=2);else{H=O-q;do H+=v.end;while(H<0);if(T=v.end-H,B>T){if(B-=T,O-H>0&&T>O-H)do v.win[O++]=v.win[H++];while(--T!==0);else v.win.set(v.win.subarray(H,H+T),O),O+=T,H+=T,T=0;H=0}}if(O-H>0&&B>O-H)do v.win[O++]=v.win[H++];while(--B!==0);else v.win.set(v.win.subarray(H,H+B),O),O+=B,H+=B,B=0;break}else if(!(T&64))x+=k[W+2],x+=D&Ue[T],W=(S+x)*3,T=k[W];else return A.msg="invalid distance code",B=A.avail_in-z,B=R>>3<B?R>>3:B,z+=B,U-=B,R-=B<<3,v.bitb=D,v.bitk=R,A.avail_in=z,A.total_in+=U-A.next_in_index,A.next_in_index=U,v.write=O,-3;while(!0);break}if(T&64)return T&32?(B=A.avail_in-z,B=R>>3<B?R>>3:B,z+=B,U-=B,R-=B<<3,v.bitb=D,v.bitk=R,A.avail_in=z,A.total_in+=U-A.next_in_index,A.next_in_index=U,v.write=O,1):(A.msg="invalid literal/length code",B=A.avail_in-z,B=R>>3<B?R>>3:B,z+=B,U-=B,R-=B<<3,v.bitb=D,v.bitk=R,A.avail_in=z,A.total_in+=U-A.next_in_index,A.next_in_index=U,v.write=O,-3);if(x+=k[W+2],x+=D&Ue[T],W=(S+x)*3,(T=k[W])===0){D>>=k[W+1],R-=k[W+1],v.win[O++]=k[W+2],M--;break}}while(!0)}while(M>=258&&z>=10);return B=A.avail_in-z,B=R>>3<B?R>>3:B,z+=B,U-=B,R-=B<<3,v.bitb=D,v.bitk=R,A.avail_in=z,A.total_in+=U-A.next_in_index,A.next_in_index=U,v.write=O,0}n.init=function(p,g,b,y,E,_){e=$n,c=p,u=g,d=b,h=y,m=E,w=_,r=null},n.proc=function(p,g,b){let y,E,_,v=0,A=0,x=0,k,S,T,D;for(x=g.next_in_index,k=g.avail_in,v=p.bitb,A=p.bitk,S=p.write,T=S<p.read?p.read-S-1:p.end-S;;)switch(e){case $n:if(T>=258&&k>=10&&(p.bitb=v,p.bitk=A,g.avail_in=k,g.total_in+=x-g.next_in_index,g.next_in_index=x,p.write=S,b=f(c,u,d,h,m,w,p,g),x=g.next_in_index,k=g.avail_in,v=p.bitb,A=p.bitk,S=p.write,T=S<p.read?p.read-S-1:p.end-S,b!=0)){e=b==1?qr:Wn;break}s=c,r=d,i=h,e=Xs;case Xs:for(y=s;A<y;){if(k!==0)b=0;else return p.bitb=v,p.bitk=A,g.avail_in=k,g.total_in+=x-g.next_in_index,g.next_in_index=x,p.write=S,p.inflate_flush(g,b);k--,v|=(g.read_byte(x++)&255)<<A,A+=8}if(E=(i+(v&Ue[y]))*3,v>>>=r[E+1],A-=r[E+1],_=r[E],_===0){a=r[E+2],e=Js;break}if(_&16){o=_&15,t=r[E+2],e=Gs;break}if(!(_&64)){s=_,i=E/3+r[E+2];break}if(_&32){e=qr;break}return e=Wn,g.msg="invalid literal/length code",b=-3,p.bitb=v,p.bitk=A,g.avail_in=k,g.total_in+=x-g.next_in_index,g.next_in_index=x,p.write=S,p.inflate_flush(g,b);case Gs:for(y=o;A<y;){if(k!==0)b=0;else return p.bitb=v,p.bitk=A,g.avail_in=k,g.total_in+=x-g.next_in_index,g.next_in_index=x,p.write=S,p.inflate_flush(g,b);k--,v|=(g.read_byte(x++)&255)<<A,A+=8}t+=v&Ue[y],v>>=y,A-=y,s=u,r=m,i=w,e=Zs;case Zs:for(y=s;A<y;){if(k!==0)b=0;else return p.bitb=v,p.bitk=A,g.avail_in=k,g.total_in+=x-g.next_in_index,g.next_in_index=x,p.write=S,p.inflate_flush(g,b);k--,v|=(g.read_byte(x++)&255)<<A,A+=8}if(E=(i+(v&Ue[y]))*3,v>>=r[E+1],A-=r[E+1],_=r[E],_&16){o=_&15,l=r[E+2],e=Ks;break}if(!(_&64)){s=_,i=E/3+r[E+2];break}return e=Wn,g.msg="invalid distance code",b=-3,p.bitb=v,p.bitk=A,g.avail_in=k,g.total_in+=x-g.next_in_index,g.next_in_index=x,p.write=S,p.inflate_flush(g,b);case Ks:for(y=o;A<y;){if(k!==0)b=0;else return p.bitb=v,p.bitk=A,g.avail_in=k,g.total_in+=x-g.next_in_index,g.next_in_index=x,p.write=S,p.inflate_flush(g,b);k--,v|=(g.read_byte(x++)&255)<<A,A+=8}l+=v&Ue[y],v>>=y,A-=y,e=Ys;case Ys:for(D=S-l;D<0;)D+=p.end;for(;t!==0;){if(T===0&&(S==p.end&&p.read!==0&&(S=0,T=S<p.read?p.read-S-1:p.end-S),T===0&&(p.write=S,b=p.inflate_flush(g,b),S=p.write,T=S<p.read?p.read-S-1:p.end-S,S==p.end&&p.read!==0&&(S=0,T=S<p.read?p.read-S-1:p.end-S),T===0)))return p.bitb=v,p.bitk=A,g.avail_in=k,g.total_in+=x-g.next_in_index,g.next_in_index=x,p.write=S,p.inflate_flush(g,b);p.win[S++]=p.win[D++],T--,D==p.end&&(D=0),t--}e=$n;break;case Js:if(T===0&&(S==p.end&&p.read!==0&&(S=0,T=S<p.read?p.read-S-1:p.end-S),T===0&&(p.write=S,b=p.inflate_flush(g,b),S=p.write,T=S<p.read?p.read-S-1:p.end-S,S==p.end&&p.read!==0&&(S=0,T=S<p.read?p.read-S-1:p.end-S),T===0)))return p.bitb=v,p.bitk=A,g.avail_in=k,g.total_in+=x-g.next_in_index,g.next_in_index=x,p.write=S,p.inflate_flush(g,b);b=0,p.win[S++]=a,T--,e=$n;break;case qr:if(A>7&&(A-=8,k++,x--),p.write=S,b=p.inflate_flush(g,b),S=p.write,T=S<p.read?p.read-S-1:p.end-S,p.read!=p.write)return p.bitb=v,p.bitk=A,g.avail_in=k,g.total_in+=x-g.next_in_index,g.next_in_index=x,p.write=S,p.inflate_flush(g,b);e=Qs;case Qs:return b=1,p.bitb=v,p.bitk=A,g.avail_in=k,g.total_in+=x-g.next_in_index,g.next_in_index=x,p.write=S,p.inflate_flush(g,b);case Wn:return b=-3,p.bitb=v,p.bitk=A,g.avail_in=k,g.total_in+=x-g.next_in_index,g.next_in_index=x,p.write=S,p.inflate_flush(g,b);default:return b=-2,p.bitb=v,p.bitk=A,g.avail_in=k,g.total_in+=x-g.next_in_index,g.next_in_index=x,p.write=S,p.inflate_flush(g,b)}},n.free=function(){}}var ea=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Dt=0,Xr=1,ta=2,na=3,ra=4,ia=5,jn=6,Vn=7,sa=8,Tt=9;function Ru(n,e){let t=this,r=Dt,i=0,s=0,a=0,o,l=[0],c=[0],u=new Cu,d=0,h=new Int32Array(Oa*3),m=0,w=new ti;t.bitk=0,t.bitb=0,t.win=new Uint8Array(e),t.end=e,t.read=0,t.write=0,t.reset=function(f,p){p&&(p[0]=m),r==jn&&u.free(f),r=Dt,t.bitk=0,t.bitb=0,t.read=t.write=0},t.reset(n,null),t.inflate_flush=function(f,p){let g,b,y;return b=f.next_out_index,y=t.read,g=(y<=t.write?t.write:t.end)-y,g>f.avail_out&&(g=f.avail_out),g!==0&&p==-5&&(p=0),f.avail_out-=g,f.total_out+=g,f.next_out.set(t.win.subarray(y,y+g),b),b+=g,y+=g,y==t.end&&(y=0,t.write==t.end&&(t.write=0),g=t.write-y,g>f.avail_out&&(g=f.avail_out),g!==0&&p==-5&&(p=0),f.avail_out-=g,f.total_out+=g,f.next_out.set(t.win.subarray(y,y+g),b),b+=g,y+=g),f.next_out_index=b,t.read=y,p},t.proc=function(f,p){let g,b,y,E,_,v,A,x;for(E=f.next_in_index,_=f.avail_in,b=t.bitb,y=t.bitk,v=t.write,A=v<t.read?t.read-v-1:t.end-v;;){let k,S,T,D,R,U,z,O;switch(r){case Dt:for(;y<3;){if(_!==0)p=0;else return t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,t.inflate_flush(f,p);_--,b|=(f.read_byte(E++)&255)<<y,y+=8}switch(g=b&7,d=g&1,g>>>1){case 0:b>>>=3,y-=3,g=y&7,b>>>=g,y-=g,r=Xr;break;case 1:k=[],S=[],T=[[]],D=[[]],ti.inflate_trees_fixed(k,S,T,D),u.init(k[0],S[0],T[0],0,D[0],0),b>>>=3,y-=3,r=jn;break;case 2:b>>>=3,y-=3,r=na;break;case 3:return b>>>=3,y-=3,r=Tt,f.msg="invalid block type",p=-3,t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,t.inflate_flush(f,p)}break;case Xr:for(;y<32;){if(_!==0)p=0;else return t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,t.inflate_flush(f,p);_--,b|=(f.read_byte(E++)&255)<<y,y+=8}if((~b>>>16&65535)!=(b&65535))return r=Tt,f.msg="invalid stored block lengths",p=-3,t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,t.inflate_flush(f,p);i=b&65535,b=y=0,r=i!==0?ta:d!==0?Vn:Dt;break;case ta:if(_===0||A===0&&(v==t.end&&t.read!==0&&(v=0,A=v<t.read?t.read-v-1:t.end-v),A===0&&(t.write=v,p=t.inflate_flush(f,p),v=t.write,A=v<t.read?t.read-v-1:t.end-v,v==t.end&&t.read!==0&&(v=0,A=v<t.read?t.read-v-1:t.end-v),A===0)))return t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,t.inflate_flush(f,p);if(p=0,g=i,g>_&&(g=_),g>A&&(g=A),t.win.set(f.read_buf(E,g),v),E+=g,_-=g,v+=g,A-=g,(i-=g)!==0)break;r=d!==0?Vn:Dt;break;case na:for(;y<14;){if(_!==0)p=0;else return t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,t.inflate_flush(f,p);_--,b|=(f.read_byte(E++)&255)<<y,y+=8}if(s=g=b&16383,(g&31)>29||(g>>5&31)>29)return r=Tt,f.msg="too many length or distance symbols",p=-3,t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,t.inflate_flush(f,p);if(g=258+(g&31)+(g>>5&31),!o||o.length<g)o=[];else for(x=0;x<g;x++)o[x]=0;b>>>=14,y-=14,a=0,r=ra;case ra:for(;a<4+(s>>>10);){for(;y<3;){if(_!==0)p=0;else return t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,t.inflate_flush(f,p);_--,b|=(f.read_byte(E++)&255)<<y,y+=8}o[ea[a++]]=b&7,b>>>=3,y-=3}for(;a<19;)o[ea[a++]]=0;if(l[0]=7,g=w.inflate_trees_bits(o,l,c,h,f),g!=0)return p=g,p==-3&&(o=null,r=Tt),t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,t.inflate_flush(f,p);a=0,r=ia;case ia:for(;g=s,!(a>=258+(g&31)+(g>>5&31));){let M,P;for(g=l[0];y<g;){if(_!==0)p=0;else return t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,t.inflate_flush(f,p);_--,b|=(f.read_byte(E++)&255)<<y,y+=8}if(g=h[(c[0]+(b&Ue[g]))*3+1],P=h[(c[0]+(b&Ue[g]))*3+2],P<16)b>>>=g,y-=g,o[a++]=P;else{for(x=P==18?7:P-14,M=P==18?11:3;y<g+x;){if(_!==0)p=0;else return t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,t.inflate_flush(f,p);_--,b|=(f.read_byte(E++)&255)<<y,y+=8}if(b>>>=g,y-=g,M+=b&Ue[x],b>>>=x,y-=x,x=a,g=s,x+M>258+(g&31)+(g>>5&31)||P==16&&x<1)return o=null,r=Tt,f.msg="invalid bit length repeat",p=-3,t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,t.inflate_flush(f,p);P=P==16?o[x-1]:0;do o[x++]=P;while(--M!==0);a=x}}if(c[0]=-1,R=[],U=[],z=[],O=[],R[0]=9,U[0]=6,g=s,g=w.inflate_trees_dynamic(257+(g&31),1+(g>>5&31),o,R,U,z,O,h,f),g!=0)return g==-3&&(o=null,r=Tt),p=g,t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,t.inflate_flush(f,p);u.init(R[0],U[0],h,z[0],h,O[0]),r=jn;case jn:if(t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,(p=u.proc(t,f,p))!=1)return t.inflate_flush(f,p);if(p=0,u.free(f),E=f.next_in_index,_=f.avail_in,b=t.bitb,y=t.bitk,v=t.write,A=v<t.read?t.read-v-1:t.end-v,d===0){r=Dt;break}r=Vn;case Vn:if(t.write=v,p=t.inflate_flush(f,p),v=t.write,A=v<t.read?t.read-v-1:t.end-v,t.read!=t.write)return t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,t.inflate_flush(f,p);r=sa;case sa:return p=1,t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,t.inflate_flush(f,p);case Tt:return p=-3,t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,t.inflate_flush(f,p);default:return p=-2,t.bitb=b,t.bitk=y,f.avail_in=_,f.total_in+=E-f.next_in_index,f.next_in_index=E,t.write=v,t.inflate_flush(f,p)}}},t.free=function(f){t.reset(f,null),t.win=null,h=null},t.set_dictionary=function(f,p,g){t.win.set(f.subarray(p,p+g),0),t.read=t.write=g},t.sync_point=function(){return r==Xr?1:0}}var Iu=32,zu=8,Du=0,aa=1,oa=2,la=3,ca=4,ua=5,Gr=6,en=7,da=12,bt=13,Lu=[0,0,255,255];function Fu(){let n=this;n.mode=0,n.method=0,n.was=[0],n.need=0,n.marker=0,n.wbits=0;function e(t){return!t||!t.istate?-2:(t.total_in=t.total_out=0,t.msg=null,t.istate.mode=en,t.istate.blocks.reset(t,null),0)}n.inflateEnd=function(t){return n.blocks&&n.blocks.free(t),n.blocks=null,0},n.inflateInit=function(t,r){return t.msg=null,n.blocks=null,r<8||r>15?(n.inflateEnd(t),-2):(n.wbits=r,t.istate.blocks=new Ru(t,1<<r),e(t),0)},n.inflate=function(t,r){let i,s;if(!t||!t.istate||!t.next_in)return-2;let a=t.istate;for(r=r==yu?-5:0,i=-5;;)switch(a.mode){case Du:if(t.avail_in===0)return i;if(i=r,t.avail_in--,t.total_in++,((a.method=t.read_byte(t.next_in_index++))&15)!=zu){a.mode=bt,t.msg="unknown compression method",a.marker=5;break}if((a.method>>4)+8>a.wbits){a.mode=bt,t.msg="invalid win size",a.marker=5;break}a.mode=aa;case aa:if(t.avail_in===0)return i;if(i=r,t.avail_in--,t.total_in++,s=t.read_byte(t.next_in_index++)&255,((a.method<<8)+s)%31!==0){a.mode=bt,t.msg="incorrect header check",a.marker=5;break}if(!(s&Iu)){a.mode=en;break}a.mode=oa;case oa:if(t.avail_in===0)return i;i=r,t.avail_in--,t.total_in++,a.need=(t.read_byte(t.next_in_index++)&255)<<24&4278190080,a.mode=la;case la:if(t.avail_in===0)return i;i=r,t.avail_in--,t.total_in++,a.need+=(t.read_byte(t.next_in_index++)&255)<<16&16711680,a.mode=ca;case ca:if(t.avail_in===0)return i;i=r,t.avail_in--,t.total_in++,a.need+=(t.read_byte(t.next_in_index++)&255)<<8&65280,a.mode=ua;case ua:return t.avail_in===0?i:(i=r,t.avail_in--,t.total_in++,a.need+=t.read_byte(t.next_in_index++)&255,a.mode=Gr,2);case Gr:return a.mode=bt,t.msg="need dictionary",a.marker=0,-2;case en:if(i=a.blocks.proc(t,i),i==-3){a.mode=bt,a.marker=0;break}if(i==0&&(i=r),i!=1)return i;i=r,a.blocks.reset(t,a.was),a.mode=da;case da:return t.avail_in=0,1;case bt:return-3;default:return-2}},n.inflateSetDictionary=function(t,r,i){let s=0,a=i;if(!t||!t.istate||t.istate.mode!=Gr)return-2;let o=t.istate;return a>=1<<o.wbits&&(a=(1<<o.wbits)-1,s=i-a),o.blocks.set_dictionary(r,s,a),o.mode=en,0},n.inflateSync=function(t){let r,i,s,a,o;if(!t||!t.istate)return-2;let l=t.istate;if(l.mode!=bt&&(l.mode=bt,l.marker=0),(r=t.avail_in)===0)return-5;for(i=t.next_in_index,s=l.marker;r!==0&&s<4;)t.read_byte(i)==Lu[s]?s++:t.read_byte(i)!==0?s=0:s=4-s,i++,r--;return t.total_in+=i-t.next_in_index,t.next_in_index=i,t.avail_in=r,l.marker=s,s!=4?-3:(a=t.total_in,o=t.total_out,e(t),t.total_in=a,t.total_out=o,l.mode=en,0)},n.inflateSyncPoint=function(t){return!t||!t.istate||!t.istate.blocks?-2:t.istate.blocks.sync_point()}}function Ma(){}Ma.prototype={inflateInit(n){let e=this;return e.istate=new Fu,n||(n=15),e.istate.inflateInit(e,n)},inflate(n){let e=this;return e.istate?e.istate.inflate(e,n):-2},inflateEnd(){let n=this;if(!n.istate)return-2;let e=n.istate.inflateEnd(n);return n.istate=null,e},inflateSync(){let n=this;return n.istate?n.istate.inflateSync(n):-2},inflateSetDictionary(n,e){let t=this;return t.istate?t.istate.inflateSetDictionary(t,n,e):-2},read_byte(n){return this.next_in[n]},read_buf(n,e){return this.next_in.subarray(n,n+e)}};function Ou(n){let e=this,t=new Ma,r=n&&n.chunkSize?Math.floor(n.chunkSize*2):128*1024,i=bu,s=new Uint8Array(r),a=!1;t.inflateInit(),t.next_out=s,e.append=function(o,l){let c=[],u,d,h=0,m=0,w=0;if(o.length!==0){t.next_in_index=0,t.next_in=o,t.avail_in=o.length;do{if(t.next_out_index=0,t.avail_out=r,t.avail_in===0&&!a&&(t.next_in_index=0,a=!0),u=t.inflate(i),a&&u===-5){if(t.avail_in!==0)throw new Error("inflating: bad input")}else if(u!==0&&u!==1)throw new Error("inflating: "+t.msg);if((a||u===1)&&t.avail_in===o.length)throw new Error("inflating: bad input");t.next_out_index&&(t.next_out_index===r?c.push(new Uint8Array(s)):c.push(s.slice(0,t.next_out_index))),w+=t.next_out_index,l&&t.next_in_index>0&&t.next_in_index!=h&&(l(t.next_in_index),h=t.next_in_index)}while(t.avail_in>0||t.avail_out===0);return c.length>1?(d=new Uint8Array(w),c.forEach(function(f){d.set(f,m),m+=f.length})):d=c[0]||new Uint8Array,d}},e.flush=function(){t.inflateEnd()}}var Gn="/",ha=new Date(2107,11,31),fa=new Date(1980,0,1),de=void 0,Yn="undefined",Ua="function",pa=class{constructor(n){return class extends TransformStream{constructor(e,t){let r=new n(t);super({transform(i,s){s.enqueue(r.append(i))},flush(i){let s=r.flush();s&&i.enqueue(s)}})}}}},Mu=64,Ba=2;try{typeof navigator!=Yn&&navigator.hardwareConcurrency&&(Ba=navigator.hardwareConcurrency)}catch{}var Uu={chunkSize:512*1024,maxWorkers:Ba,terminateWorkerTimeout:5e3,useWebWorkers:!0,useCompressionStream:!0,workerScripts:de,CompressionStreamNative:typeof CompressionStream!=Yn&&CompressionStream,DecompressionStreamNative:typeof DecompressionStream!=Yn&&DecompressionStream},_t=Object.assign({},Uu);function fi(){return _t}function Na(n){return Math.max(n.chunkSize,Mu)}function ir(n){let{baseURL:e,chunkSize:t,maxWorkers:r,terminateWorkerTimeout:i,useCompressionStream:s,useWebWorkers:a,Deflate:o,Inflate:l,CompressionStream:c,DecompressionStream:u,workerScripts:d}=n;if(yt("baseURL",e),yt("chunkSize",t),yt("maxWorkers",r),yt("terminateWorkerTimeout",i),yt("useCompressionStream",s),yt("useWebWorkers",a),o&&(_t.CompressionStream=new pa(o)),l&&(_t.DecompressionStream=new pa(l)),yt("CompressionStream",c),yt("DecompressionStream",u),d!==de){let{deflate:h,inflate:m}=d;if((h||m)&&(_t.workerScripts||(_t.workerScripts={})),h){if(!Array.isArray(h))throw new Error("workerScripts.deflate must be an array");_t.workerScripts.deflate=h}if(m){if(!Array.isArray(m))throw new Error("workerScripts.inflate must be an array");_t.workerScripts.inflate=m}}}function yt(n,e){e!==de&&(_t[n]=e)}function Bu(){return"application/octet-stream"}var Pa=[];for(let n=0;n<256;n++){let e=n;for(let t=0;t<8;t++)e&1?e=e>>>1^3988292384:e=e>>>1;Pa[n]=e}var Jn=class{constructor(n){this.crc=n||-1}append(n){let e=this.crc|0;for(let t=0,r=n.length|0;t<r;t++)e=e>>>8^Pa[(e^n[t])&255];this.crc=e}get(){return~this.crc}},Ha=class extends TransformStream{constructor(){let n=new Jn;super({transform(e){n.append(e)},flush(e){let t=new Uint8Array(4);new DataView(t.buffer).setUint32(0,n.get()),e.enqueue(t)}})}};function ni(n){if(typeof TextEncoder>"u"){n=unescape(encodeURIComponent(n));let e=new Uint8Array(n.length);for(let t=0;t<e.length;t++)e[t]=n.charCodeAt(t);return e}else return new TextEncoder().encode(n)}var Ie={concat(n,e){if(n.length===0||e.length===0)return n.concat(e);let t=n[n.length-1],r=Ie.getPartial(t);return r===32?n.concat(e):Ie._shiftRight(e,r,t|0,n.slice(0,n.length-1))},bitLength(n){let e=n.length;if(e===0)return 0;let t=n[e-1];return(e-1)*32+Ie.getPartial(t)},clamp(n,e){if(n.length*32<e)return n;n=n.slice(0,Math.ceil(e/32));let t=n.length;return e=e&31,t>0&&e&&(n[t-1]=Ie.partial(e,n[t-1]&2147483648>>e-1,1)),n},partial(n,e,t){return n===32?e:(t?e|0:e<<32-n)+n*1099511627776},getPartial(n){return Math.round(n/1099511627776)||32},_shiftRight(n,e,t,r){for(r===void 0&&(r=[]);e>=32;e-=32)r.push(t),t=0;if(e===0)return r.concat(n);for(let a=0;a<n.length;a++)r.push(t|n[a]>>>e),t=n[a]<<32-e;let i=n.length?n[n.length-1]:0,s=Ie.getPartial(i);return r.push(Ie.partial(e+s&31,e+s>32?t:r.pop(),1)),r}},Qn={bytes:{fromBits(n){let e=Ie.bitLength(n)/8,t=new Uint8Array(e),r;for(let i=0;i<e;i++)i&3||(r=n[i/4]),t[i]=r>>>24,r<<=8;return t},toBits(n){let e=[],t,r=0;for(t=0;t<n.length;t++)r=r<<8|n[t],(t&3)===3&&(e.push(r),r=0);return t&3&&e.push(Ie.partial(8*(t&3),r)),e}}},$a={};$a.sha1=class{constructor(n){let e=this;e.blockSize=512,e._init=[1732584193,4023233417,2562383102,271733878,3285377520],e._key=[1518500249,1859775393,2400959708,3395469782],n?(e._h=n._h.slice(0),e._buffer=n._buffer.slice(0),e._length=n._length):e.reset()}reset(){let n=this;return n._h=n._init.slice(0),n._buffer=[],n._length=0,n}update(n){let e=this;typeof n=="string"&&(n=Qn.utf8String.toBits(n));let t=e._buffer=Ie.concat(e._buffer,n),r=e._length,i=e._length=r+Ie.bitLength(n);if(i>9007199254740991)throw new Error("Cannot hash more than 2^53 - 1 bits");let s=new Uint32Array(t),a=0;for(let o=e.blockSize+r-(e.blockSize+r&e.blockSize-1);o<=i;o+=e.blockSize)e._block(s.subarray(16*a,16*(a+1))),a+=1;return t.splice(0,16*a),e}finalize(){let n=this,e=n._buffer,t=n._h;e=Ie.concat(e,[Ie.partial(1,1)]);for(let r=e.length+2;r&15;r++)e.push(0);for(e.push(Math.floor(n._length/4294967296)),e.push(n._length|0);e.length;)n._block(e.splice(0,16));return n.reset(),t}_f(n,e,t,r){if(n<=19)return e&t|~e&r;if(n<=39)return e^t^r;if(n<=59)return e&t|e&r|t&r;if(n<=79)return e^t^r}_S(n,e){return e<<n|e>>>32-n}_block(n){let e=this,t=e._h,r=Array(80);for(let c=0;c<16;c++)r[c]=n[c];let i=t[0],s=t[1],a=t[2],o=t[3],l=t[4];for(let c=0;c<=79;c++){c>=16&&(r[c]=e._S(1,r[c-3]^r[c-8]^r[c-14]^r[c-16]));let u=e._S(5,i)+e._f(c,s,a,o)+l+r[c]+e._key[Math.floor(c/20)]|0;l=o,o=a,a=e._S(30,s),s=i,i=u}t[0]=t[0]+i|0,t[1]=t[1]+s|0,t[2]=t[2]+a|0,t[3]=t[3]+o|0,t[4]=t[4]+l|0}};var Wa={};Wa.aes=class{constructor(n){let e=this;e._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],e._tables[0][0][0]||e._precompute();let t=e._tables[0][4],r=e._tables[1],i=n.length,s,a,o,l=1;if(i!==4&&i!==6&&i!==8)throw new Error("invalid aes key size");for(e._key=[a=n.slice(0),o=[]],s=i;s<4*i+28;s++){let c=a[s-1];(s%i===0||i===8&&s%i===4)&&(c=t[c>>>24]<<24^t[c>>16&255]<<16^t[c>>8&255]<<8^t[c&255],s%i===0&&(c=c<<8^c>>>24^l<<24,l=l<<1^(l>>7)*283)),a[s]=a[s-i]^c}for(let c=0;s;c++,s--){let u=a[c&3?s:s-4];s<=4||c<4?o[c]=u:o[c]=r[0][t[u>>>24]]^r[1][t[u>>16&255]]^r[2][t[u>>8&255]]^r[3][t[u&255]]}}encrypt(n){return this._crypt(n,0)}decrypt(n){return this._crypt(n,1)}_precompute(){let n=this._tables[0],e=this._tables[1],t=n[4],r=e[4],i=[],s=[],a,o,l,c;for(let u=0;u<256;u++)s[(i[u]=u<<1^(u>>7)*283)^u]=u;for(let u=a=0;!t[u];u^=o||1,a=s[a]||1){let d=a^a<<1^a<<2^a<<3^a<<4;d=d>>8^d&255^99,t[u]=d,r[d]=u,c=i[l=i[o=i[u]]];let h=c*16843009^l*65537^o*257^u*16843008,m=i[d]*257^d*16843008;for(let w=0;w<4;w++)n[w][u]=m=m<<24^m>>>8,e[w][d]=h=h<<24^h>>>8}for(let u=0;u<5;u++)n[u]=n[u].slice(0),e[u]=e[u].slice(0)}_crypt(n,e){if(n.length!==4)throw new Error("invalid aes block size");let t=this._key[e],r=t.length/4-2,i=[0,0,0,0],s=this._tables[e],a=s[0],o=s[1],l=s[2],c=s[3],u=s[4],d=n[0]^t[0],h=n[e?3:1]^t[1],m=n[2]^t[2],w=n[e?1:3]^t[3],f=4,p,g,b;for(let y=0;y<r;y++)p=a[d>>>24]^o[h>>16&255]^l[m>>8&255]^c[w&255]^t[f],g=a[h>>>24]^o[m>>16&255]^l[w>>8&255]^c[d&255]^t[f+1],b=a[m>>>24]^o[w>>16&255]^l[d>>8&255]^c[h&255]^t[f+2],w=a[w>>>24]^o[d>>16&255]^l[h>>8&255]^c[m&255]^t[f+3],f+=4,d=p,h=g,m=b;for(let y=0;y<4;y++)i[e?3&-y:y]=u[d>>>24]<<24^u[h>>16&255]<<16^u[m>>8&255]<<8^u[w&255]^t[f++],p=d,d=h,h=m,m=w,w=p;return i}};var Nu={getRandomValues(n){let e=new Uint32Array(n.buffer),t=r=>{let i=987654321,s=4294967295;return function(){return i=36969*(i&65535)+(i>>16)&s,r=18e3*(r&65535)+(r>>16)&s,(((i<<16)+r&s)/4294967296+.5)*(Math.random()>.5?1:-1)}};for(let r=0,i;r<n.length;r+=4){let s=t((i||Math.random())*4294967296);i=s()*987654071,e[r/4]=s()*4294967296|0}return n}},ja={};ja.ctrGladman=class{constructor(n,e){this._prf=n,this._initIv=e,this._iv=e}reset(){this._iv=this._initIv}update(n){return this.calculate(this._prf,n,this._iv)}incWord(n){if((n>>24&255)===255){let e=n>>16&255,t=n>>8&255,r=n&255;e===255?(e=0,t===255?(t=0,r===255?r=0:++r):++t):++e,n=0,n+=e<<16,n+=t<<8,n+=r}else n+=1<<24;return n}incCounter(n){(n[0]=this.incWord(n[0]))===0&&(n[1]=this.incWord(n[1]))}calculate(n,e,t){let r;if(!(r=e.length))return[];let i=Ie.bitLength(e);for(let s=0;s<r;s+=4){this.incCounter(t);let a=n.encrypt(t);e[s]^=a[0],e[s+1]^=a[1],e[s+2]^=a[2],e[s+3]^=a[3]}return Ie.clamp(e,i)}};var Rt={importKey(n){return new Rt.hmacSha1(Qn.bytes.toBits(n))},pbkdf2(n,e,t,r){if(t=t||1e4,r<0||t<0)throw new Error("invalid params to pbkdf2");let i=(r>>5)+1<<2,s,a,o,l,c,u=new ArrayBuffer(i),d=new DataView(u),h=0,m=Ie;for(e=Qn.bytes.toBits(e),c=1;h<(i||1);c++){for(s=a=n.encrypt(m.concat(e,[c])),o=1;o<t;o++)for(a=n.encrypt(a),l=0;l<a.length;l++)s[l]^=a[l];for(o=0;h<(i||1)&&o<s.length;o++)d.setInt32(h,s[o]),h+=4}return u.slice(0,r/8)}};Rt.hmacSha1=class{constructor(n){let e=this,t=e._hash=$a.sha1,r=[[],[]];e._baseHash=[new t,new t];let i=e._baseHash[0].blockSize/32;n.length>i&&(n=new t().update(n).finalize());for(let s=0;s<i;s++)r[0][s]=n[s]^909522486,r[1][s]=n[s]^1549556828;e._baseHash[0].update(r[0]),e._baseHash[1].update(r[1]),e._resultHash=new t(e._baseHash[0])}reset(){let n=this;n._resultHash=new n._hash(n._baseHash[0]),n._updated=!1}update(n){let e=this;e._updated=!0,e._resultHash.update(n)}digest(){let n=this,e=n._resultHash.finalize(),t=new n._hash(n._baseHash[1]).update(e).finalize();return n.reset(),t}encrypt(n){if(this._updated)throw new Error("encrypt on already updated hmac called!");return this.update(n),this.digest(n)}};var Pu=typeof crypto<"u"&&typeof crypto.getRandomValues=="function",pi="Invalid password",gi="Invalid signature";function Va(n){return Pu?crypto.getRandomValues(n):Nu.getRandomValues(n)}var Lt=16,Hu="raw",qa={name:"PBKDF2"},$u={name:"HMAC"},Wu="SHA-1",ju=Object.assign({hash:$u},qa),ri=Object.assign({iterations:1e3,hash:{name:Wu}},qa),Vu=["deriveBits"],nn=[8,12,16],tn=[16,24,32],vt=10,qu=[0,0,0,0],Xa="undefined",Ga="function",sr=typeof crypto!=Xa,on=sr&&crypto.subtle,Za=sr&&typeof on!=Xa,tt=Qn.bytes,Xu=Wa.aes,Gu=ja.ctrGladman,Zu=Rt.hmacSha1,ga=sr&&Za&&typeof on.importKey==Ga,ma=sr&&Za&&typeof on.deriveBits==Ga,Ku=class extends TransformStream{constructor({password:n,signed:e,encryptionStrength:t}){super({start(){Object.assign(this,{ready:new Promise(r=>this.resolveReady=r),password:n,signed:e,strength:t-1,pending:new Uint8Array})},async transform(r,i){let s=this,{password:a,strength:o,resolveReady:l,ready:c}=s;a?(await Ju(s,o,a,$e(r,0,nn[o]+2)),r=$e(r,nn[o]+2),l()):await c;let u=new Uint8Array(r.length-vt-(r.length-vt)%Lt);i.enqueue(Ka(s,r,u,0,vt,!0))},async flush(r){let{signed:i,ctr:s,hmac:a,pending:o,ready:l}=this;await l;let c=$e(o,0,o.length-vt),u=$e(o,o.length-vt),d=new Uint8Array;if(c.length){let h=sn(tt,c);a.update(h);let m=s.update(h);d=rn(tt,m)}if(i){let h=$e(rn(tt,a.digest()),0,vt);for(let m=0;m<vt;m++)if(h[m]!=u[m])throw new Error(gi)}r.enqueue(d)}})}},Yu=class extends TransformStream{constructor({password:n,encryptionStrength:e}){let t;super({start(){Object.assign(this,{ready:new Promise(r=>this.resolveReady=r),password:n,strength:e-1,pending:new Uint8Array})},async transform(r,i){let s=this,{password:a,strength:o,resolveReady:l,ready:c}=s,u=new Uint8Array;a?(u=await Qu(s,o,a),l()):await c;let d=new Uint8Array(u.length+r.length-r.length%Lt);d.set(u,0),i.enqueue(Ka(s,r,d,u.length,0))},async flush(r){let{ctr:i,hmac:s,pending:a,ready:o}=this;await o;let l=new Uint8Array;if(a.length){let c=i.update(sn(tt,a));s.update(c),l=rn(tt,c)}t.signature=rn(tt,s.digest()).slice(0,vt),r.enqueue(mi(l,t.signature))}}),t=this}};function Ka(n,e,t,r,i,s){let{ctr:a,hmac:o,pending:l}=n,c=e.length-i;l.length&&(e=mi(l,e),t=nd(t,c-c%Lt));let u;for(u=0;u<=c-Lt;u+=Lt){let d=sn(tt,$e(e,u,u+Lt));s&&o.update(d);let h=a.update(d);s||o.update(h),t.set(rn(tt,h),u+r)}return n.pending=$e(e,u),t}async function Ju(n,e,t,r){let i=await Ya(n,e,t,$e(r,0,nn[e])),s=$e(r,nn[e]);if(i[0]!=s[0]||i[1]!=s[1])throw new Error(pi)}async function Qu(n,e,t){let r=Va(new Uint8Array(nn[e])),i=await Ya(n,e,t,r);return mi(r,i)}async function Ya(n,e,t,r){n.password=null;let i=ni(t),s=await ed(Hu,i,ju,!1,Vu),a=await td(Object.assign({salt:r},ri),s,8*(tn[e]*2+2)),o=new Uint8Array(a),l=sn(tt,$e(o,0,tn[e])),c=sn(tt,$e(o,tn[e],tn[e]*2)),u=$e(o,tn[e]*2);return Object.assign(n,{keys:{key:l,authentication:c,passwordVerification:u},ctr:new Gu(new Xu(l),Array.from(qu)),hmac:new Zu(c)}),u}async function ed(n,e,t,r,i){if(ga)try{return await on.importKey(n,e,t,r,i)}catch{return ga=!1,Rt.importKey(e)}else return Rt.importKey(e)}async function td(n,e,t){if(ma)try{return await on.deriveBits(n,e,t)}catch{return ma=!1,Rt.pbkdf2(e,n.salt,ri.iterations,t)}else return Rt.pbkdf2(e,n.salt,ri.iterations,t)}function mi(n,e){let t=n;return n.length+e.length&&(t=new Uint8Array(n.length+e.length),t.set(n,0),t.set(e,n.length)),t}function nd(n,e){if(e&&e>n.length){let t=n;n=new Uint8Array(e),n.set(t,0)}return n}function $e(n,e,t){return n.subarray(e,t)}function rn(n,e){return n.fromBits(e)}function sn(n,e){return n.toBits(e)}var Ft=12,rd=class extends TransformStream{constructor({password:n,passwordVerification:e}){super({start(){Object.assign(this,{password:n,passwordVerification:e}),Ja(this,n)},transform(t,r){let i=this;if(i.password){let s=wa(i,t.subarray(0,Ft));if(i.password=null,s[Ft-1]!=i.passwordVerification)throw new Error(pi);t=t.subarray(Ft)}r.enqueue(wa(i,t))}})}},id=class extends TransformStream{constructor({password:n,passwordVerification:e}){super({start(){Object.assign(this,{password:n,passwordVerification:e}),Ja(this,n)},transform(t,r){let i=this,s,a;if(i.password){i.password=null;let o=Va(new Uint8Array(Ft));o[Ft-1]=i.passwordVerification,s=new Uint8Array(t.length+o.length),s.set(ba(i,o),0),a=Ft}else s=new Uint8Array(t.length),a=0;s.set(ba(i,t),a),r.enqueue(s)}})}};function wa(n,e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=Qa(n)^e[r],wi(n,t[r]);return t}function ba(n,e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=Qa(n)^e[r],wi(n,e[r]);return t}function Ja(n,e){let t=[305419896,591751049,878082192];Object.assign(n,{keys:t,crcKey0:new Jn(t[0]),crcKey2:new Jn(t[2])});for(let r=0;r<e.length;r++)wi(n,e.charCodeAt(r))}function wi(n,e){let[t,r,i]=n.keys;n.crcKey0.append([e]),t=~n.crcKey0.get(),r=ya(Math.imul(ya(r+eo(t)),134775813)+1),n.crcKey2.append([r>>>24]),i=~n.crcKey2.get(),n.keys=[t,r,i]}function Qa(n){let e=n.keys[2]|2;return eo(Math.imul(e,e^1)>>>8)}function eo(n){return n&255}function ya(n){return n&4294967295}var va="deflate-raw",sd=class extends TransformStream{constructor(n,{chunkSize:e,CompressionStream:t,CompressionStreamNative:r}){super({});let{compressed:i,encrypted:s,useCompressionStream:a,zipCrypto:o,signed:l,level:c}=n,u=this,d,h,m=to(super.readable);(!s||o)&&l&&([m,d]=m.tee(),d=nt(d,new Ha)),i&&(m=ro(m,a,{level:c,chunkSize:e},r,t)),s&&(o?m=nt(m,new id(n)):(h=new Yu(n),m=nt(m,h))),no(u,m,async()=>{let w;s&&!o&&(w=h.signature),(!s||o)&&l&&(w=await d.getReader().read(),w=new DataView(w.value.buffer).getUint32(0)),u.signature=w})}},ad=class extends TransformStream{constructor(n,{chunkSize:e,DecompressionStream:t,DecompressionStreamNative:r}){super({});let{zipCrypto:i,encrypted:s,signed:a,signature:o,compressed:l,useCompressionStream:c}=n,u,d,h=to(super.readable);s&&(i?h=nt(h,new rd(n)):(d=new Ku(n),h=nt(h,d))),l&&(h=ro(h,c,{chunkSize:e},r,t)),(!s||i)&&a&&([h,u]=h.tee(),u=nt(u,new Ha)),no(this,h,async()=>{if((!s||i)&&a){let m=await u.getReader().read(),w=new DataView(m.value.buffer);if(o!=w.getUint32(0,!1))throw new Error(gi)}})}};function to(n){return nt(n,new TransformStream({transform(e,t){e&&e.length&&t.enqueue(e)}}))}function no(n,e,t){e=nt(e,new TransformStream({flush:t})),Object.defineProperty(n,"readable",{get(){return e}})}function ro(n,e,t,r,i){try{let s=e&&r?r:i;n=nt(n,new s(va,t))}catch(s){if(e)n=nt(n,new i(va,t));else throw s}return n}function nt(n,e){return n.pipeThrough(e)}var od="message",ld="start",cd="pull",xa="data",ud="ack",dd="close",io="deflate",so="inflate",hd=class extends TransformStream{constructor(n,e){super({});let t=this,{codecType:r}=n,i;r.startsWith(io)?i=sd:r.startsWith(so)&&(i=ad);let s=0,a=new i(n,e),o=super.readable,l=new TransformStream({transform(c,u){c&&c.length&&(s+=c.length,u.enqueue(c))},flush(){let{signature:c}=a;Object.assign(t,{signature:c,size:s})}});Object.defineProperty(t,"readable",{get(){return o.pipeThrough(a).pipeThrough(l)}})}},fd=typeof Worker!=Yn,Zr=class{constructor(n,{readable:e,writable:t},{options:r,config:i,streamOptions:s,useWebWorkers:a,transferStreams:o,scripts:l},c){let{signal:u}=s;return Object.assign(n,{busy:!0,readable:e.pipeThrough(new pd(e,s,i),{signal:u}),writable:t,options:Object.assign({},r),scripts:l,transferStreams:o,terminate(){let{worker:d,busy:h}=n;d&&!h&&(d.terminate(),n.interface=null)},onTaskFinished(){n.busy=!1,c(n)}}),(a&&fd?md:gd)(n,i)}},pd=class extends TransformStream{constructor(n,{onstart:e,onprogress:t,size:r,onend:i},{chunkSize:s}){let a=0;super({start(){e&&Kr(e,r)},async transform(o,l){a+=o.length,t&&await Kr(t,a,r),l.enqueue(o)},flush(){n.size=a,i&&Kr(i,a)}},{highWaterMark:1,size:()=>s})}};async function Kr(n,...e){try{await n(...e)}catch{}}function gd(n,e){return{run:()=>wd(n,e)}}function md(n,{baseURL:e,chunkSize:t}){return n.interface||Object.assign(n,{worker:vd(n.scripts[0],e,n),interface:{run:()=>bd(n,{chunkSize:t})}}),n.interface}async function wd({options:n,readable:e,writable:t,onTaskFinished:r},i){let s=new hd(n,i);try{await e.pipeThrough(s).pipeTo(t,{preventClose:!0,preventAbort:!0});let{signature:a,size:o}=s;return{signature:a,size:o}}finally{r()}}async function bd(n,e){let t,r,i=new Promise((d,h)=>{t=d,r=h});Object.assign(n,{reader:null,writer:null,resolveResult:t,rejectResult:r,result:i});let{readable:s,options:a,scripts:o}=n,{writable:l,closed:c}=yd(n.writable);ii({type:ld,scripts:o.slice(1),options:a,config:e,readable:s,writable:l},n)||Object.assign(n,{reader:s.getReader(),writer:l.getWriter()});let u=await i;try{await l.close()}catch{}return await c,u}function yd(n){let e=n.getWriter(),t,r=new Promise(i=>t=i);return{writable:new WritableStream({async write(i){await e.ready,await e.write(i)},close(){e.releaseLock(),t()},abort(i){return e.abort(i)}}),closed:r}}var _a=!0,Aa=!0;function vd(n,e,t){let r={type:"module"},i,s;typeof n==Ua&&(n=n());try{i=new URL(n,e)}catch{i=n}if(_a)try{s=new Worker(i)}catch{_a=!1,s=new Worker(i,r)}else s=new Worker(i,r);return s.addEventListener(od,a=>xd(a,t)),s}function ii(n,{worker:e,writer:t,onTaskFinished:r,transferStreams:i}){try{let{value:s,readable:a,writable:o}=n,l=[];if(s){let{buffer:c,length:u}=s;u!=c.byteLength&&(s=new Uint8Array(s)),n.value=s.buffer,l.push(n.value)}if(i&&Aa?(a&&l.push(a),o&&l.push(o)):n.readable=n.writable=null,l.length)try{return e.postMessage(n,l),!0}catch{Aa=!1,n.readable=n.writable=null,e.postMessage(n)}else e.postMessage(n)}catch(s){throw t&&t.releaseLock(),r(),s}}async function xd({data:n},e){let{type:t,value:r,messageId:i,result:s,error:a}=n,{reader:o,writer:l,resolveResult:c,rejectResult:u,onTaskFinished:d}=e;try{if(a){let{message:m,stack:w,code:f,name:p}=a,g=new Error(m);Object.assign(g,{stack:w,code:f,name:p}),h(g)}else{if(t==cd){let{value:m,done:w}=await o.read();ii({type:xa,value:m,done:w,messageId:i},e)}t==xa&&(await l.ready,await l.write(new Uint8Array(r)),ii({type:ud,messageId:i},e)),t==dd&&h(null,s)}}catch(m){h(m)}function h(m,w){m?u(m):c(w),l&&l.releaseLock(),d()}}var xt=[],Yr=[],Sa=0;async function ao(n,e){let{options:t,config:r}=e,{transferStreams:i,useWebWorkers:s,useCompressionStream:a,codecType:o,compressed:l,signed:c,encrypted:u}=t,{workerScripts:d,maxWorkers:h,terminateWorkerTimeout:m}=r;e.transferStreams=i||i===de;let w=!l&&!c&&!u&&!e.transferStreams;e.useWebWorkers=!w&&(s||s===de&&r.useWebWorkers),e.scripts=e.useWebWorkers&&d?d[o]:[],t.useCompressionStream=a||a===de&&r.useCompressionStream;let f,p=xt.find(b=>!b.busy);if(p)si(p),f=new Zr(p,n,e,g);else if(xt.length<h){let b={indexWorker:Sa};Sa++,xt.push(b),f=new Zr(b,n,e,g)}else f=await new Promise(b=>Yr.push({resolve:b,stream:n,workerOptions:e}));return f.run();function g(b){if(Yr.length){let[{resolve:y,stream:E,workerOptions:_}]=Yr.splice(0,1);y(new Zr(b,E,_,g))}else b.worker?(si(b),Number.isFinite(m)&&m>=0&&(b.terminateTimeout=setTimeout(()=>{xt=xt.filter(y=>y!=b),b.terminate()},m))):xt=xt.filter(y=>y!=b)}}function si(n){let{terminateTimeout:e}=n;e&&(clearTimeout(e),n.terminateTimeout=null)}function _d(){xt.forEach(n=>{si(n),n.terminate()})}var oo="HTTP error ",ln="HTTP Range not supported",lo="Writer iterator completed too soon",Ad="text/plain",Sd="Content-Length",Ed="Content-Range",kd="Accept-Ranges",Td="Range",Cd="Content-Type",Rd="HEAD",bi="GET",co="bytes",Id=64*1024,yi="writable",ar=class{constructor(){this.size=0}init(){this.initialized=!0}},At=class extends ar{get readable(){let n=this,{chunkSize:e=Id}=n,t=new ReadableStream({start(){this.chunkOffset=0},async pull(r){let{offset:i=0,size:s,diskNumberStart:a}=t,{chunkOffset:o}=this;r.enqueue(await Se(n,i+o,Math.min(e,s-o),a)),o+e>s?r.close():this.chunkOffset+=e}});return t}},vi=class extends ar{constructor(){super();let n=this,e=new WritableStream({write(t){return n.writeUint8Array(t)}});Object.defineProperty(n,yi,{get(){return e}})}writeUint8Array(){}},zd=class extends At{constructor(n){super();let e=n.length;for(;n.charAt(e-1)=="=";)e--;let t=n.indexOf(",")+1;Object.assign(this,{dataURI:n,dataStart:t,size:Math.floor((e-t)*.75)})}readUint8Array(n,e){let{dataStart:t,dataURI:r}=this,i=new Uint8Array(e),s=Math.floor(n/3)*4,a=atob(r.substring(s+t,Math.ceil((n+e)/3)*4+t)),o=n-Math.floor(s/4)*3;for(let l=o;l<o+e;l++)i[l-o]=a.charCodeAt(l);return i}},Dd=class extends vi{constructor(n){super(),Object.assign(this,{data:"data:"+(n||"")+";base64,",pending:[]})}writeUint8Array(n){let e=this,t=0,r=e.pending,i=e.pending.length;for(e.pending="",t=0;t<Math.floor((i+n.length)/3)*3-i;t++)r+=String.fromCharCode(n[t]);for(;t<n.length;t++)e.pending+=String.fromCharCode(n[t]);r.length>2?e.data+=btoa(r):e.pending=r}getData(){return this.data+btoa(this.pending)}},xi=class extends At{constructor(n){super(),Object.assign(this,{blob:n,size:n.size})}async readUint8Array(n,e){let t=this,r=n+e,i=n||r<t.size?t.blob.slice(n,r):t.blob;return new Uint8Array(await i.arrayBuffer())}},_i=class extends ar{constructor(n){super();let e=this,t=new TransformStream,r=[];n&&r.push([Cd,n]),Object.defineProperty(e,yi,{get(){return t.writable}}),e.blob=new Response(t.readable,{headers:r}).blob()}getData(){return this.blob}},Ld=class extends xi{constructor(n){super(new Blob([n],{type:Ad}))}},Fd=class extends _i{constructor(n){super(n),Object.assign(this,{encoding:n,utf8:!n||n.toLowerCase()=="utf-8"})}async getData(){let{encoding:n,utf8:e}=this,t=await super.getData();if(t.text&&e)return t.text();{let r=new FileReader;return new Promise((i,s)=>{Object.assign(r,{onload:({target:a})=>i(a.result),onerror:()=>s(r.error)}),r.readAsText(t,n)})}}},Od=class extends At{constructor(n,e){super(),uo(this,n,e)}async init(){await ho(this,ai,Ea),super.init()}readUint8Array(n,e){return fo(this,n,e,ai,Ea)}},Md=class extends At{constructor(n,e){super(),uo(this,n,e)}async init(){await ho(this,oi,ka),super.init()}readUint8Array(n,e){return fo(this,n,e,oi,ka)}};function uo(n,e,t){let{preventHeadRequest:r,useRangeHeader:i,forceRangeRequests:s}=t;t=Object.assign({},t),delete t.preventHeadRequest,delete t.useRangeHeader,delete t.forceRangeRequests,delete t.useXHR,Object.assign(n,{url:e,options:t,preventHeadRequest:r,useRangeHeader:i,forceRangeRequests:s})}async function ho(n,e,t){let{url:r,useRangeHeader:i,forceRangeRequests:s}=n;if(Pd(r)&&(i||s)){let{headers:a}=await e(bi,n,po(n));if(!s&&a.get(kd)!=co)throw new Error(ln);{let o,l=a.get(Ed);if(l){let c=l.trim().split(/\s*\/\s*/);if(c.length){let u=c[1];u&&u!="*"&&(o=Number(u))}}o===de?await Ta(n,e,t):n.size=o}}else await Ta(n,e,t)}async function fo(n,e,t,r,i){let{useRangeHeader:s,forceRangeRequests:a,options:o}=n;if(s||a){let l=await r(bi,n,po(n,e,t));if(l.status!=206)throw new Error(ln);return new Uint8Array(await l.arrayBuffer())}else{let{data:l}=n;return l||await i(n,o),new Uint8Array(n.data.subarray(e,e+t))}}function po(n,e=0,t=1){return Object.assign({},Ai(n),{[Td]:co+"="+e+"-"+(e+t-1)})}function Ai({options:n}){let{headers:e}=n;if(e)return Symbol.iterator in e?Object.fromEntries(e):e}async function Ea(n){await go(n,ai)}async function ka(n){await go(n,oi)}async function go(n,e){let t=await e(bi,n,Ai(n));n.data=new Uint8Array(await t.arrayBuffer()),n.size||(n.size=n.data.length)}async function Ta(n,e,t){if(n.preventHeadRequest)await t(n,n.options);else{let r=(await e(Rd,n,Ai(n))).headers.get(Sd);r?n.size=Number(r):await t(n,n.options)}}async function ai(n,{options:e,url:t},r){let i=await fetch(t,Object.assign({},e,{method:n,headers:r}));if(i.status<400)return i;throw i.status==416?new Error(ln):new Error(oo+(i.statusText||i.status))}function oi(n,{url:e},t){return new Promise((r,i)=>{let s=new XMLHttpRequest;if(s.addEventListener("load",()=>{if(s.status<400){let a=[];s.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach(o=>{let l=o.trim().split(/\s*:\s*/);l[0]=l[0].trim().replace(/^[a-z]|-[a-z]/g,c=>c.toUpperCase()),a.push(l)}),r({status:s.status,arrayBuffer:()=>s.response,headers:new Map(a)})}else i(s.status==416?new Error(ln):new Error(oo+(s.statusText||s.status)))},!1),s.addEventListener("error",a=>i(a.detail.error),!1),s.open(n,e),t)for(let a of Object.entries(t))s.setRequestHeader(a[0],a[1]);s.responseType="arraybuffer",s.send()})}var mo=class extends At{constructor(n,e={}){super(),Object.assign(this,{url:n,reader:e.useXHR?new Md(n,e):new Od(n,e)})}set size(n){}get size(){return this.reader.size}async init(){await this.reader.init(),super.init()}readUint8Array(n,e){return this.reader.readUint8Array(n,e)}},Ud=class extends mo{constructor(n,e={}){e.useRangeHeader=!0,super(n,e)}},Bd=class extends At{constructor(n){super(),Object.assign(this,{array:n,size:n.length})}readUint8Array(n,e){return this.array.slice(n,n+e)}},Nd=class extends vi{init(n=0){Object.assign(this,{offset:0,array:new Uint8Array(n)}),super.init()}writeUint8Array(n){let e=this;if(e.offset+n.length>e.array.length){let t=e.array;e.array=new Uint8Array(t.length+n.length),e.array.set(t)}e.array.set(n,e.offset),e.offset+=n.length}getData(){return this.array}},Si=class extends At{constructor(n){super(),this.readers=n}async init(){let n=this,{readers:e}=n;n.lastDiskNumber=0,await Promise.all(e.map(async t=>{await t.init(),n.size+=t.size})),super.init()}async readUint8Array(n,e,t=0){let r=this,{readers:i}=this,s,a=t;a==-1&&(a=i.length-1);let o=n;for(;o>=i[a].size;)o-=i[a].size,a++;let l=i[a],c=l.size;if(o+e<=c)s=await Se(l,o,e);else{let u=c-o;s=new Uint8Array(e),s.set(await Se(l,o,u)),s.set(await r.readUint8Array(n+u,e-u,t),u)}return r.lastDiskNumber=Math.max(a,r.lastDiskNumber),s}},an=class extends ar{constructor(n,e=4294967295){super();let t=this;Object.assign(t,{diskNumber:0,diskOffset:0,size:0,maxSize:e,availableSize:e});let r,i,s,a=new WritableStream({async write(c){let{availableSize:u}=t;if(s)c.length>=u?(await o(c.slice(0,u)),await l(),t.diskOffset+=r.size,t.diskNumber++,s=null,await this.write(c.slice(u))):await o(c);else{let{value:d,done:h}=await n.next();if(h&&!d)throw new Error(lo);r=d,r.size=0,r.maxSize&&(t.maxSize=r.maxSize),t.availableSize=t.maxSize,await ot(r),i=d.writable,s=i.getWriter(),await this.write(c)}},async close(){await s.ready,await l()}});Object.defineProperty(t,yi,{get(){return a}});async function o(c){let u=c.length;u&&(await s.ready,await s.write(c),r.size+=u,t.size+=u,t.availableSize-=u)}async function l(){i.size=r.size,await s.close()}}};function Pd(n){let{baseURL:e}=fi(),{protocol:t}=new URL(n,e);return t=="http:"||t=="https:"}async function ot(n,e){n.init&&!n.initialized&&await n.init(e)}function Ei(n){return Array.isArray(n)&&(n=new Si(n)),n instanceof ReadableStream&&(n={readable:n}),n}function ki(n){n.writable===de&&typeof n.next==Ua&&(n=new an(n)),n instanceof WritableStream&&(n={writable:n});let{writable:e}=n;return e.size===de&&(e.size=0),n instanceof an||Object.assign(n,{diskNumber:0,diskOffset:0,availableSize:1/0,maxSize:1/0}),n}function Se(n,e,t,r){return n.readUint8Array(e,t,r)}var Hd=Si,$d=an,wo="\0\u263A\u263B\u2665\u2666\u2663\u2660\u2022\u25D8\u25CB\u25D9\u2642\u2640\u266A\u266B\u263C\u25BA\u25C4\u2195\u203C\xB6\xA7\u25AC\u21A8\u2191\u2193\u2192\u2190\u221F\u2194\u25B2\u25BC !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2302\xC7\xFC\xE9\xE2\xE4\xE0\xE5\xE7\xEA\xEB\xE8\xEF\xEE\xEC\xC4\xC5\xC9\xE6\xC6\xF4\xF6\xF2\xFB\xF9\xFF\xD6\xDC\xA2\xA3\xA5\u20A7\u0192\xE1\xED\xF3\xFA\xF1\xD1\xAA\xBA\xBF\u2310\xAC\xBD\xBC\xA1\xAB\xBB\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255D\u255C\u255B\u2510\u2514\u2534\u252C\u251C\u2500\u253C\u255E\u255F\u255A\u2554\u2569\u2566\u2560\u2550\u256C\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256B\u256A\u2518\u250C\u2588\u2584\u258C\u2590\u2580\u03B1\xDF\u0393\u03C0\u03A3\u03C3\xB5\u03C4\u03A6\u0398\u03A9\u03B4\u221E\u03C6\u03B5\u2229\u2261\xB1\u2265\u2264\u2320\u2321\xF7\u2248\xB0\u2219\xB7\u221A\u207F\xB2\u25A0 ".split(""),Wd=wo.length==256;function jd(n){if(Wd){let e="";for(let t=0;t<n.length;t++)e+=wo[n[t]];return e}else return new TextDecoder().decode(n)}function li(n,e){return e&&e.trim().toLowerCase()=="cp437"?jd(n):new TextDecoder(e).decode(n)}var bo="filename",yo="rawFilename",vo="comment",xo="rawComment",_o="uncompressedSize",Ao="compressedSize",So="offset",ci="diskNumberStart",Ti="lastModDate",Eo="rawLastModDate",Ci="lastAccessDate",Vd="rawLastAccessDate",Ri="creationDate",qd="rawCreationDate",ko="internalFileAttribute",To="externalFileAttribute",Co="msDosCompatible",Ro="zip64",Xd=[bo,yo,Ao,_o,Ti,Eo,vo,xo,Ci,Ri,So,ci,ci,ko,To,Co,Ro,"directory","bitFlag","encrypted","signature","filenameUTF8","commentUTF8","compressionMethod","version","versionMadeBy","extraField","rawExtraField","extraFieldZip64","extraFieldUnicodePath","extraFieldUnicodeComment","extraFieldAES","extraFieldNTFS","extraFieldExtendedTimestamp"],er=class{constructor(n){Xd.forEach(e=>this[e]=n[e])}},Zn="File format is not recognized",Io="End of central directory not found",zo="End of Zip64 central directory not found",Do="End of Zip64 central directory locator not found",Lo="Central directory header not found",Fo="Local file header not found",Oo="Zip64 extra field not found",Mo="File contains encrypted entry",Uo="Encryption method not supported",ui="Compression method not supported",di="Split zip file",Ca="utf-8",Ra="cp437",Gd=[[_o,4294967295],[Ao,4294967295],[So,4294967295],[ci,65535]],Zd={65535:{getValue:le,bytes:4},4294967295:{getValue:Kn,bytes:8}},Kd=class{constructor(n,e={}){Object.assign(this,{reader:Ei(n),options:e,config:fi()})}async*getEntriesGenerator(n={}){let e=this,{reader:t}=e,{config:r}=e;if(await ot(t),(t.size===de||!t.readUint8Array)&&(t=new xi(await new Response(t.readable).blob()),await ot(t)),t.size<22)throw new Error(Zn);t.chunkSize=Na(r);let i=await nh(t,101010256,t.size,22,65535*16);if(!i){let x=await Se(t,0,4),k=ye(x);throw le(k)==134695760?new Error(di):new Error(Io)}let s=ye(i),a=le(s,12),o=le(s,16),l=i.offset,c=pe(s,20),u=l+22+c,d=pe(s,4),h=t.lastDiskNumber||0,m=pe(s,6),w=pe(s,8),f=0,p=0;if(o==4294967295||a==4294967295||w==65535||m==65535){let x=await Se(t,i.offset-20,20),k=ye(x);if(le(k,0)!=117853008)throw new Error(zo);o=Kn(k,8);let S=await Se(t,o,56,-1),T=ye(S),D=i.offset-20-56;if(le(T,0)!=101075792&&o!=D){let R=o;o=D,f=o-R,S=await Se(t,o,56,-1),T=ye(S)}if(le(T,0)!=101075792)throw new Error(Do);d==65535&&(d=le(T,16)),m==65535&&(m=le(T,20)),w==65535&&(w=Kn(T,32)),a==4294967295&&(a=Kn(T,40)),o-=a}if(h!=d)throw new Error(di);if(o<0||o>=t.size)throw new Error(Zn);let g=0,b=await Se(t,o,a,m),y=ye(b);if(a){let x=i.offset-a;if(le(y,g)!=33639248&&o!=x){let k=o;o=x,f=o-k,b=await Se(t,o,a,m),y=ye(b)}}if(o<0||o>=t.size)throw new Error(Zn);let E=Ye(e,n,"filenameEncoding"),_=Ye(e,n,"commentEncoding");for(let x=0;x<w;x++){let k=new Yd(t,r,e.options);if(le(y,g)!=33639248)throw new Error(Lo);Bo(k,y,g+6);let S=!!k.bitFlag.languageEncodingFlag,T=g+46,D=T+k.filenameLength,R=D+k.extraFieldLength,U=pe(y,g+4),z=(U&0)==0,O=b.subarray(T,D),M=pe(y,g+32),P=R+M,Z=b.subarray(R,P),B=S,q=S,H=z&&(Ot(y,g+38)&16)==16,W=le(y,g+42)+f;Object.assign(k,{versionMadeBy:U,msDosCompatible:z,compressedSize:0,uncompressedSize:0,commentLength:M,directory:H,offset:W,diskNumberStart:pe(y,g+34),internalFileAttribute:pe(y,g+36),externalFileAttribute:le(y,g+38),rawFilename:O,filenameUTF8:B,commentUTF8:q,rawExtraField:b.subarray(D,R)});let[K,V]=await Promise.all([li(O,B?Ca:E||Ra),li(Z,q?Ca:_||Ra)]);Object.assign(k,{rawComment:Z,filename:K,comment:V,directory:H||K.endsWith(Gn)}),p=Math.max(W,p),await No(k,k,y,g+6);let Y=new er(k);Y.getData=(fe,ze)=>k.getData(fe,Y,ze),g=P;let{onprogress:he}=n;if(he)try{await he(x+1,w,new er(k))}catch{}yield Y}let v=Ye(e,n,"extractPrependedData"),A=Ye(e,n,"extractAppendedData");return v&&(e.prependedData=p>0?await Se(t,0,p):new Uint8Array),e.comment=c?await Se(t,l+22,c):new Uint8Array,A&&(e.appendedData=u<t.size?await Se(t,u,t.size-u):new Uint8Array),!0}async getEntries(n={}){let e=[];for await(let t of this.getEntriesGenerator(n))e.push(t);return e}async close(){}},Yd=class{constructor(n,e,t){Object.assign(this,{reader:n,config:e,options:t})}async getData(n,e,t={}){let r=this,{reader:i,offset:s,diskNumberStart:a,extraFieldAES:o,compressionMethod:l,config:c,bitFlag:u,signature:d,rawLastModDate:h,uncompressedSize:m,compressedSize:w}=r,f=r.localDirectory={},p=await Se(i,s,30,a),g=ye(p),b=Ye(r,t,"password");if(b=b&&b.length&&b,o&&o.originalCompressionMethod!=99)throw new Error(ui);if(l!=0&&l!=8)throw new Error(ui);if(le(g,0)!=67324752)throw new Error(Fo);Bo(f,g,4),f.rawExtraField=f.extraFieldLength?await Se(i,s+30+f.filenameLength,f.extraFieldLength,a):new Uint8Array,await No(r,f,g,4),Object.assign(e,{lastAccessDate:f.lastAccessDate,creationDate:f.creationDate});let y=r.encrypted&&f.encrypted,E=y&&!o;if(y){if(!E&&o.strength===de)throw new Error(Uo);if(!b)throw new Error(Mo)}let _=s+30+f.filenameLength+f.extraFieldLength,v=i.readable;v.diskNumberStart=a,v.offset=_;let A=v.size=w,x=Ye(r,t,"signal");n=ki(n),await ot(n,m);let{writable:k}=n,{onstart:S,onprogress:T,onend:D}=t,R={options:{codecType:so,password:b,zipCrypto:E,encryptionStrength:o&&o.strength,signed:Ye(r,t,"checkSignature"),passwordVerification:E&&(u.dataDescriptor?h>>>8&255:d>>>24&255),signature:d,compressed:l!=0,encrypted:y,useWebWorkers:Ye(r,t,"useWebWorkers"),useCompressionStream:Ye(r,t,"useCompressionStream"),transferStreams:Ye(r,t,"transferStreams")},config:c,streamOptions:{signal:x,size:A,onstart:S,onprogress:T,onend:D}};return k.size+=(await ao({readable:v,writable:k},R)).size,Ye(r,t,"preventClose")||await k.close(),n.getData?n.getData():k}};function Bo(n,e,t){let r=n.rawBitFlag=pe(e,t+2),i=(r&1)==1,s=le(e,t+6);Object.assign(n,{encrypted:i,version:pe(e,t),bitFlag:{level:(r&6)>>1,dataDescriptor:(r&8)==8,languageEncodingFlag:(r&2048)==2048},rawLastModDate:s,lastModDate:rh(s),filenameLength:pe(e,t+22),extraFieldLength:pe(e,t+24)})}async function No(n,e,t,r){let{rawExtraField:i}=e,s=e.extraField=new Map,a=ye(new Uint8Array(i)),o=0;try{for(;o<i.length;){let f=pe(a,o),p=pe(a,o+2);s.set(f,{type:f,data:i.slice(o+4,o+4+p)}),o+=4+p}}catch{}let l=pe(t,r+4);Object.assign(e,{signature:le(t,r+10),uncompressedSize:le(t,r+18),compressedSize:le(t,r+14)});let c=s.get(1);c&&(Jd(c,e),e.extraFieldZip64=c);let u=s.get(28789);u&&(await Ia(u,bo,yo,e,n),e.extraFieldUnicodePath=u);let d=s.get(25461);d&&(await Ia(d,vo,xo,e,n),e.extraFieldUnicodeComment=d);let h=s.get(39169);h?(Qd(h,e,l),e.extraFieldAES=h):e.compressionMethod=l;let m=s.get(10);m&&(eh(m,e),e.extraFieldNTFS=m);let w=s.get(21589);w&&(th(w,e),e.extraFieldExtendedTimestamp=w)}function Jd(n,e){e.zip64=!0;let t=ye(n.data),r=Gd.filter(([i,s])=>e[i]==s);for(let i=0,s=0;i<r.length;i++){let[a,o]=r[i];if(e[a]==o){let l=Zd[o];e[a]=n[a]=l.getValue(t,s),s+=l.bytes}else if(n[a])throw new Error(Oo)}}async function Ia(n,e,t,r,i){let s=ye(n.data),a=new Jn;a.append(i[t]);let o=ye(new Uint8Array(4));o.setUint32(0,a.get(),!0),Object.assign(n,{version:Ot(s,0),signature:le(s,1),[e]:await li(n.data.subarray(5)),valid:!i.bitFlag.languageEncodingFlag&&n.signature==le(o,0)}),n.valid&&(r[e]=n[e],r[e+"UTF8"]=!0)}function Qd(n,e,t){let r=ye(n.data),i=Ot(r,4);Object.assign(n,{vendorVersion:Ot(r,0),vendorId:Ot(r,2),strength:i,originalCompressionMethod:t,compressionMethod:pe(r,5)}),e.compressionMethod=n.compressionMethod}function eh(n,e){let t=ye(n.data),r=4,i;try{for(;r<n.data.length&&!i;){let s=pe(t,r),a=pe(t,r+2);s==1&&(i=n.data.slice(r+4,r+4+a)),r+=4+a}}catch{}try{if(i&&i.length==24){let s=ye(i),a=s.getBigUint64(0,!0),o=s.getBigUint64(8,!0),l=s.getBigUint64(16,!0);Object.assign(n,{rawLastModDate:a,rawLastAccessDate:o,rawCreationDate:l});let c=Jr(a),u=Jr(o),d=Jr(l),h={lastModDate:c,lastAccessDate:u,creationDate:d};Object.assign(n,h),Object.assign(e,h)}}catch{}}function th(n,e){let t=ye(n.data),r=Ot(t,0),i=[],s=[];(r&1)==1&&(i.push(Ti),s.push(Eo)),(r&2)==2&&(i.push(Ci),s.push(Vd)),(r&4)==4&&(i.push(Ri),s.push(qd));let a=1;i.forEach((o,l)=>{if(n.data.length>=a+4){let c=le(t,a);e[o]=n[o]=new Date(c*1e3);let u=s[l];n[u]=c}a+=4})}async function nh(n,e,t,r,i){let s=new Uint8Array(4),a=ye(s);ih(a,0,e);let o=r+i;return await l(r)||await l(Math.min(o,t));async function l(c){let u=t-c,d=await Se(n,u,c);for(let h=d.length-r;h>=0;h--)if(d[h]==s[0]&&d[h+1]==s[1]&&d[h+2]==s[2]&&d[h+3]==s[3])return{offset:u+h,buffer:d.slice(h,h+r).buffer}}}function Ye(n,e,t){return e[t]===de?n.options[t]:e[t]}function rh(n){let e=(n&4294901760)>>16,t=n&65535;try{return new Date(1980+((e&65024)>>9),((e&480)>>5)-1,e&31,(t&63488)>>11,(t&2016)>>5,(t&31)*2,0)}catch{}}function Jr(n){return new Date(Number(n/BigInt(1e4)-BigInt(116444736e5)))}function Ot(n,e){return n.getUint8(e)}function pe(n,e){return n.getUint16(e,!0)}function le(n,e){return n.getUint32(e,!0)}function Kn(n,e){return Number(n.getBigUint64(e,!0))}function ih(n,e,t){n.setUint32(e,t,!0)}function ye(n){return new DataView(n.buffer)}var Po="File already exists",Ho="Zip file comment exceeds 64KB",$o="File entry comment exceeds 64KB",Wo="File entry name exceeds 64KB",hi="Version exceeds 65535",jo="The strength must equal 1, 2, or 3",Vo="Extra field type exceeds 65535",qo="Extra field data exceeds 64KB",or="Zip64 is not supported (make sure 'keepOrder' is set to 'true')",za=new Uint8Array([7,0,2,0,65,69,3,0,0]),Qr=0,Da=[],sh=class{constructor(n,e={}){n=ki(n),Object.assign(this,{writer:n,addSplitZipSignature:n instanceof an,options:e,config:fi(),files:new Map,filenames:new Set,offset:n.writable.size,pendingEntriesSize:0,pendingAddFileCalls:new Set,bufferedWrites:0})}async add(n="",e,t={}){let r=this,{pendingAddFileCalls:i,config:s}=r;Qr<s.maxWorkers?Qr++:await new Promise(o=>Da.push(o));let a;try{if(n=n.trim(),r.filenames.has(n))throw new Error(Po);return r.filenames.add(n),a=ah(r,n,e,t),i.add(a),await a}catch(o){throw r.filenames.delete(n),o}finally{i.delete(a);let o=Da.shift();o?o():Qr--}}async close(n=new Uint8Array,e={}){let t=this,{pendingAddFileCalls:r,writer:i}=this,{writable:s}=i;for(;r.size;)await Promise.all(Array.from(r));return await ph(this,n,e),ie(t,e,"preventClose")||await s.close(),i.getData?i.getData():s}};async function ah(n,e,t,r){e=e.trim(),r.directory&&!e.endsWith(Gn)?e+=Gn:r.directory=e.endsWith(Gn);let i=ni(e);if(J(i)>65535)throw new Error(Wo);let s=r.comment||"",a=ni(s);if(J(a)>65535)throw new Error($o);let o=ie(n,r,"version",20);if(o>65535)throw new Error(hi);let l=ie(n,r,"versionMadeBy",20);if(l>65535)throw new Error(hi);let c=ie(n,r,Ti,new Date),u=ie(n,r,Ci),d=ie(n,r,Ri),h=ie(n,r,Co,!0),m=ie(n,r,ko,0),w=ie(n,r,To,0),f=ie(n,r,"password"),p=ie(n,r,"encryptionStrength",3),g=ie(n,r,"zipCrypto"),b=ie(n,r,"extendedTimestamp",!0),y=ie(n,r,"keepOrder",!0),E=ie(n,r,"level"),_=ie(n,r,"useWebWorkers"),v=ie(n,r,"bufferedWrite"),A=ie(n,r,"dataDescriptorSignature",!1),x=ie(n,r,"signal"),k=ie(n,r,"useCompressionStream"),S=ie(n,r,"dataDescriptor",!0),T=ie(n,r,Ro);if(f!==de&&p!==de&&(p<1||p>3))throw new Error(jo);let D=new Uint8Array,{extraField:R}=r;if(R){let fe=0,ze=0;R.forEach(oe=>fe+=4+J(oe)),D=new Uint8Array(fe),R.forEach((oe,Oe)=>{if(Oe>65535)throw new Error(Vo);if(J(oe)>65535)throw new Error(qo);ge(D,new Uint16Array([Oe]),ze),ge(D,new Uint16Array([J(oe)]),ze+2),ge(D,oe,ze+4),ze+=4+J(oe)})}let U=0,z=0,O=0,M=T===!0;t&&(t=Ei(t),await ot(t),t.size===de?(S=!0,(T||T===de)&&(T=!0,U=4294967295)):(O=t.size,U=mh(O)));let{diskOffset:P,diskNumber:Z,maxSize:B}=n.writer,q=M||O>=4294967295,H=M||U>=4294967295,W=M||n.offset+n.pendingEntriesSize-P>=4294967295,K=ie(n,r,"supportZip64SplitFile",!0)&&M||Z+Math.ceil(n.pendingEntriesSize/B)>=65535;if(W||q||H||K){if(T===!1||!y)throw new Error(or);T=!0}T=T||!1,r=Object.assign({},r,{rawFilename:i,rawComment:a,version:o,versionMadeBy:l,lastModDate:c,lastAccessDate:u,creationDate:d,rawExtraField:D,zip64:T,zip64UncompressedSize:q,zip64CompressedSize:H,zip64Offset:W,zip64DiskNumberStart:K,password:f,level:E,useWebWorkers:_,encryptionStrength:p,extendedTimestamp:b,zipCrypto:g,bufferedWrite:v,keepOrder:y,dataDescriptor:S,dataDescriptorSignature:A,signal:x,msDosCompatible:h,internalFileAttribute:m,externalFileAttribute:w,useCompressionStream:k});let V=ch(r),Y=uh(r);z=J(V.localHeaderArray,Y.dataDescriptorArray)+U,n.pendingEntriesSize+=z;let he;try{he=await oh(n,e,t,{headerInfo:V,dataDescriptorInfo:Y},r)}finally{n.pendingEntriesSize-=z}return Object.assign(he,{name:e,comment:s,extraField:R}),new er(he)}async function oh(n,e,t,r,i){let{files:s,writer:a}=n,{keepOrder:o,dataDescriptor:l,signal:c}=i,{headerInfo:u}=r,d=Array.from(s.values()).pop(),h={},m,w,f,p,g,b;s.set(e,h);try{let v;o&&(v=d&&d.lock,y()),i.bufferedWrite||n.writerLocked||n.bufferedWrites&&o||!l?(b=new _i,b.writable.size=0,m=!0,n.bufferedWrites++,await ot(a)):(b=a,await E()),await ot(b);let{writable:A}=a,{diskOffset:x}=a;if(n.addSplitZipSignature){delete n.addSplitZipSignature;let S=new Uint8Array(4),T=Fe(S);X(T,0,134695760),await et(A,S),n.offset+=4}m||(await v,await _(A));let{diskNumber:k}=a;if(g=!0,h.diskNumberStart=k,h=await lh(t,b,h,r,n.config,i),g=!1,s.set(e,h),h.filename=e,m){await b.writable.close();let S=await b.getData();await v,await E(),p=!0,l||(S=await hh(h,S,A,i)),await _(A),h.diskNumberStart=a.diskNumber,x=a.diskOffset,await S.stream().pipeTo(A,{preventClose:!0,preventAbort:!0,signal:c}),A.size+=S.size,p=!1}if(h.offset=n.offset-x,h.zip64)fh(h,i);else if(h.offset>=4294967295)throw new Error(or);return n.offset+=h.length,h}catch(v){if(m&&p||!m&&g){if(n.hasCorruptedEntries=!0,v)try{v.corruptedEntry=!0}catch{}m?n.offset+=b.writable.size:n.offset=b.writable.size}throw s.delete(e),v}finally{m&&n.bufferedWrites--,f&&f(),w&&w()}function y(){h.lock=new Promise(v=>f=v)}async function E(){n.writerLocked=!0;let{lockWriter:v}=n;n.lockWriter=new Promise(A=>w=()=>{n.writerLocked=!1,A()}),await v}async function _(v){u.localHeaderArray.length>a.availableSize&&(a.availableSize=0,await et(v,new Uint8Array))}}async function lh(n,e,{diskNumberStart:t,lock:r},i,s,a){let{headerInfo:o,dataDescriptorInfo:l}=i,{localHeaderArray:c,headerArray:u,lastModDate:d,rawLastModDate:h,encrypted:m,compressed:w,version:f,compressionMethod:p,rawExtraFieldExtendedTimestamp:g,rawExtraFieldNTFS:b,rawExtraFieldAES:y}=o,{dataDescriptorArray:E}=l,{rawFilename:_,lastAccessDate:v,creationDate:A,password:x,level:k,zip64:S,zip64UncompressedSize:T,zip64CompressedSize:D,zip64Offset:R,zip64DiskNumberStart:U,zipCrypto:z,dataDescriptor:O,directory:M,versionMadeBy:P,rawComment:Z,rawExtraField:B,useWebWorkers:q,onstart:H,onprogress:W,onend:K,signal:V,encryptionStrength:Y,extendedTimestamp:he,msDosCompatible:fe,internalFileAttribute:ze,externalFileAttribute:oe,useCompressionStream:Oe}=a,ke={lock:r,versionMadeBy:P,zip64:S,directory:!!M,filenameUTF8:!0,rawFilename:_,commentUTF8:!0,rawComment:Z,rawExtraFieldExtendedTimestamp:g,rawExtraFieldNTFS:b,rawExtraFieldAES:y,rawExtraField:B,extendedTimestamp:he,msDosCompatible:fe,internalFileAttribute:ze,externalFileAttribute:oe,diskNumberStart:t},Ne=0,De=0,ue,{writable:me}=e;if(n){n.chunkSize=Na(s),await et(me,c);let qe=n.readable,fn=qe.size=n.size,br={options:{codecType:io,level:k,password:x,encryptionStrength:Y,zipCrypto:m&&z,passwordVerification:m&&z&&h>>8&255,signed:!0,compressed:w,encrypted:m,useWebWorkers:q,useCompressionStream:Oe,transferStreams:!1},config:s,streamOptions:{signal:V,size:fn,onstart:H,onprogress:W,onend:K}},st=await ao({readable:qe,writable:me},br);me.size+=st.size,ue=st.signature,De=n.size=qe.size,Ne=st.size}else await et(me,c);let St;if(S){let qe=4;T&&(qe+=8),D&&(qe+=8),R&&(qe+=8),U&&(qe+=4),St=new Uint8Array(qe)}else St=new Uint8Array;return n&&dh({signature:ue,rawExtraFieldZip64:St,compressedSize:Ne,uncompressedSize:De,headerInfo:o,dataDescriptorInfo:l},a),O&&await et(me,E),Object.assign(ke,{uncompressedSize:De,compressedSize:Ne,lastModDate:d,rawLastModDate:h,creationDate:A,lastAccessDate:v,encrypted:m,length:J(c,E)+Ne,compressionMethod:p,version:f,headerArray:u,signature:ue,rawExtraFieldZip64:St,zip64UncompressedSize:T,zip64CompressedSize:D,zip64Offset:R,zip64DiskNumberStart:U}),ke}function ch(n){let{rawFilename:e,lastModDate:t,lastAccessDate:r,creationDate:i,password:s,level:a,zip64:o,zipCrypto:l,dataDescriptor:c,directory:u,rawExtraField:d,encryptionStrength:h,extendedTimestamp:m}=n,w=a!==0&&!u,f=!!(s&&J(s)),p=n.version,g;if(f&&!l){g=new Uint8Array(J(za)+2);let z=Fe(g);ee(z,0,39169),ge(g,za,2),tr(z,8,h)}else g=new Uint8Array;let b,y;if(m){y=new Uint8Array(9+(r?4:0)+(i?4:0));let z=Fe(y);ee(z,0,21589),ee(z,2,J(y)-4);let O=1+(r?2:0)+(i?4:0);tr(z,4,O),X(z,5,Math.floor(t.getTime()/1e3)),r&&X(z,9,Math.floor(r.getTime()/1e3)),i&&X(z,13,Math.floor(i.getTime()/1e3));try{b=new Uint8Array(36);let M=Fe(b),P=ei(t);ee(M,0,10),ee(M,2,32),ee(M,8,1),ee(M,10,24),Le(M,12,P),Le(M,20,ei(r)||P),Le(M,28,ei(i)||P)}catch{b=new Uint8Array}}else b=y=new Uint8Array;let E=2048;c&&(E=E|8);let _=0;w&&(_=8),o&&(p=p>45?p:45),f&&(E=E|1,l||(p=p>51?p:51,_=99,w&&(g[9]=8)));let v=new Uint8Array(26),A=Fe(v);ee(A,0,p),ee(A,2,E),ee(A,4,_);let x=new Uint32Array(1),k=Fe(x),S;t<fa?S=fa:t>ha?S=ha:S=t,ee(k,0,(S.getHours()<<6|S.getMinutes())<<5|S.getSeconds()/2),ee(k,2,(S.getFullYear()-1980<<4|S.getMonth()+1)<<5|S.getDate());let T=x[0];X(A,6,T),ee(A,22,J(e));let D=J(g,y,b,d);ee(A,24,D);let R=new Uint8Array(30+J(e)+D),U=Fe(R);return X(U,0,67324752),ge(R,v,4),ge(R,e,30),ge(R,g,30+J(e)),ge(R,y,30+J(e,g)),ge(R,b,30+J(e,g,y)),ge(R,d,30+J(e,g,y,b)),{localHeaderArray:R,headerArray:v,headerView:A,lastModDate:t,rawLastModDate:T,encrypted:f,compressed:w,version:p,compressionMethod:_,rawExtraFieldExtendedTimestamp:y,rawExtraFieldNTFS:b,rawExtraFieldAES:g}}function uh(n){let{zip64:e,dataDescriptor:t,dataDescriptorSignature:r}=n,i=new Uint8Array,s,a=0;return t&&(i=new Uint8Array(e?r?24:20:r?16:12),s=Fe(i),r&&(a=4,X(s,0,134695760))),{dataDescriptorArray:i,dataDescriptorView:s,dataDescriptorOffset:a}}function dh(n,e){let{signature:t,rawExtraFieldZip64:r,compressedSize:i,uncompressedSize:s,headerInfo:a,dataDescriptorInfo:o}=n,{headerView:l,encrypted:c}=a,{dataDescriptorView:u,dataDescriptorOffset:d}=o,{zip64:h,zip64UncompressedSize:m,zip64CompressedSize:w,zipCrypto:f,dataDescriptor:p}=e;if((!c||f)&&t!==de&&(X(l,10,t),p&&X(u,d,t)),h){let g=Fe(r);ee(g,0,1),ee(g,2,r.length-4);let b=4;m&&(X(l,18,4294967295),Le(g,b,BigInt(s)),b+=8),w&&(X(l,14,4294967295),Le(g,b,BigInt(i))),p&&(Le(u,d+4,BigInt(i)),Le(u,d+12,BigInt(s)))}else X(l,14,i),X(l,18,s),p&&(X(u,d+4,i),X(u,d+8,s))}async function hh(n,e,t,{zipCrypto:r}){let i=await gh(e,0,26),s=new DataView(i);return(!n.encrypted||r)&&X(s,14,n.signature),n.zip64?(X(s,18,4294967295),X(s,22,4294967295)):(X(s,18,n.compressedSize),X(s,22,n.uncompressedSize)),await et(t,new Uint8Array(i)),e.slice(i.byteLength)}function fh(n,e){let{rawExtraFieldZip64:t,offset:r,diskNumberStart:i}=n,{zip64UncompressedSize:s,zip64CompressedSize:a,zip64Offset:o,zip64DiskNumberStart:l}=e,c=Fe(t),u=4;s&&(u+=8),a&&(u+=8),o&&(Le(c,u,BigInt(r)),u+=8),l&&X(c,u,i)}async function ph(n,e,t){let{files:r,writer:i}=n,{diskOffset:s,writable:a}=i,{diskNumber:o}=i,l=0,c=0,u=n.offset-s,d=r.size;for(let[,{rawFilename:_,rawExtraFieldZip64:v,rawExtraFieldAES:A,rawExtraField:x,rawComment:k,rawExtraFieldExtendedTimestamp:S,rawExtraFieldNTFS:T}]of r)c+=46+J(_,k,v,A,S,T,x);let h=new Uint8Array(c),m=Fe(h);await ot(i);let w=0;for(let[_,v]of Array.from(r.values()).entries()){let{offset:A,rawFilename:x,rawExtraFieldZip64:k,rawExtraFieldAES:S,rawExtraFieldNTFS:T,rawExtraField:D,rawComment:R,versionMadeBy:U,headerArray:z,directory:O,zip64:M,zip64UncompressedSize:P,zip64CompressedSize:Z,zip64DiskNumberStart:B,zip64Offset:q,msDosCompatible:H,internalFileAttribute:W,externalFileAttribute:K,extendedTimestamp:V,lastModDate:Y,diskNumberStart:he,uncompressedSize:fe,compressedSize:ze}=v,oe;if(V){oe=new Uint8Array(9);let De=Fe(oe);ee(De,0,21589),ee(De,2,J(oe)-4),tr(De,4,1),X(De,5,Math.floor(Y.getTime()/1e3))}else oe=new Uint8Array;let Oe=J(k,S,oe,T,D);X(m,l,33639248),ee(m,l+4,U);let ke=Fe(z);P||X(ke,18,fe),Z||X(ke,14,ze),ge(h,z,l+6),ee(m,l+30,Oe),ee(m,l+32,J(R)),ee(m,l+34,M&&B?65535:he),ee(m,l+36,W),K?X(m,l+38,K):O&&H&&tr(m,l+38,16),X(m,l+42,M&&q?4294967295:A),ge(h,x,l+46),ge(h,k,l+46+J(x)),ge(h,S,l+46+J(x,k)),ge(h,oe,l+46+J(x,k,S)),ge(h,T,l+46+J(x,k,S,oe)),ge(h,D,l+46+J(x,k,S,oe,T)),ge(h,R,l+46+J(x)+Oe);let Ne=46+J(x,R)+Oe;if(l-w>i.availableSize&&(i.availableSize=0,await et(a,h.slice(w,l)),w=l),l+=Ne,t.onprogress)try{await t.onprogress(_+1,r.size,new er(v))}catch{}}await et(a,w?h.slice(w):h);let f=i.diskNumber,{availableSize:p}=i;p<22&&f++;let g=ie(n,t,"zip64");if(u>=4294967295||c>=4294967295||d>=65535||f>=65535){if(g===!1)throw new Error(or);g=!0}let b=new Uint8Array(g?98:22),y=Fe(b);l=0,g&&(X(y,0,101075792),Le(y,4,BigInt(44)),ee(y,12,45),ee(y,14,45),X(y,16,f),X(y,20,o),Le(y,24,BigInt(d)),Le(y,32,BigInt(d)),Le(y,40,BigInt(c)),Le(y,48,BigInt(u)),X(y,56,117853008),Le(y,64,BigInt(u)+BigInt(c)),X(y,72,f+1),ie(n,t,"supportZip64SplitFile",!0)&&(f=65535,o=65535),d=65535,u=4294967295,c=4294967295,l+=76),X(y,l,101010256),ee(y,l+4,f),ee(y,l+6,o),ee(y,l+8,d),ee(y,l+10,d),X(y,l+12,c),X(y,l+16,u);let E=J(e);if(E)if(E<=65535)ee(y,l+20,E);else throw new Error(Ho);await et(a,b),E&&await et(a,e)}function gh(n,e,t){return e||t?n.slice(e,t).arrayBuffer():n.arrayBuffer()}async function et(n,e){let t=n.getWriter();await t.ready,n.size+=J(e),await t.write(e),t.releaseLock()}function ei(n){if(n)return(BigInt(n.getTime())+BigInt(116444736e5))*BigInt(1e4)}function ie(n,e,t,r){let i=e[t]===de?n.options[t]:e[t];return i===de?r:i}function mh(n){return n+5*(Math.floor(n/16383)+1)}function tr(n,e,t){n.setUint8(e,t)}function ee(n,e,t){n.setUint16(e,t,!0)}function X(n,e,t){n.setUint32(e,t,!0)}function Le(n,e,t){n.setBigUint64(e,t,!0)}function ge(n,e,t){n.set(e,t)}function Fe(n){return new DataView(n.buffer)}function J(...n){let e=0;return n.forEach(t=>t&&(e+=t.length)),e}ir({Deflate:mu,Inflate:Ou});var Xo={},wh=function(n,e,t,r,i){var s=new Worker(Xo[e]||(Xo[e]=URL.createObjectURL(new Blob([n+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return s.onmessage=function(a){var o=a.data,l=o.$e$;if(l){var c=new Error(l[0]);c.code=l[1],c.stack=l[2],i(c,null)}else i(null,o)},s.postMessage(t,r),s},te=Uint8Array,Ee=Uint16Array,Ht=Uint32Array,$t=new te([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Wt=new te([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),cn=new te([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Qo=function(n,e){for(var t=new Ee(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];for(var i=new Ht(t[30]),r=1;r<30;++r)for(var s=t[r];s<t[r+1];++s)i[s]=s-t[r]<<5|r;return[t,i]},el=Qo($t,2),Ni=el[0],fr=el[1];Ni[28]=258,fr[258]=28;var tl=Qo(Wt,0),nl=tl[0],Di=tl[1],un=new Ee(32768);for(Q=0;Q<32768;++Q)lt=(Q&43690)>>>1|(Q&21845)<<1,lt=(lt&52428)>>>2|(lt&13107)<<2,lt=(lt&61680)>>>4|(lt&3855)<<4,un[Q]=((lt&65280)>>>8|(lt&255)<<8)>>>1;var lt,Q,je=function(n,e,t){for(var r=n.length,i=0,s=new Ee(e);i<r;++i)n[i]&&++s[n[i]-1];var a=new Ee(e);for(i=0;i<e;++i)a[i]=a[i-1]+s[i-1]<<1;var o;if(t){o=new Ee(1<<e);var l=15-e;for(i=0;i<r;++i)if(n[i])for(var c=i<<4|n[i],u=e-n[i],d=a[n[i]-1]++<<u,h=d|(1<<u)-1;d<=h;++d)o[un[d]>>>l]=c}else for(o=new Ee(r),i=0;i<r;++i)n[i]&&(o[i]=un[a[n[i]-1]++]>>>15-n[i]);return o},ut=new te(288);for(Q=0;Q<144;++Q)ut[Q]=8;var Q;for(Q=144;Q<256;++Q)ut[Q]=9;var Q;for(Q=256;Q<280;++Q)ut[Q]=7;var Q;for(Q=280;Q<288;++Q)ut[Q]=8;var Q,Pt=new te(32);for(Q=0;Q<32;++Q)Pt[Q]=5;var Q,rl=je(ut,9,0),il=je(ut,9,1),sl=je(Pt,5,0),al=je(Pt,5,1),cr=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},We=function(n,e,t){var r=e/8|0;return(n[r]|n[r+1]<<8)>>(e&7)&t},ur=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},dn=function(n){return(n+7)/8|0},it=function(n,e,t){(e==null||e<0)&&(e=0),(t==null||t>n.length)&&(t=n.length);var r=new(n.BYTES_PER_ELEMENT==2?Ee:n.BYTES_PER_ELEMENT==4?Ht:te)(t-e);return r.set(n.subarray(e,t)),r};var ol=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],j=function(n,e,t){var r=new Error(e||ol[n]);if(r.code=n,Error.captureStackTrace&&Error.captureStackTrace(r,j),!t)throw r;return r},wr=function(n,e,t){var r=n.length;if(!r||t&&t.f&&!t.l)return e||new te(0);var i=!e||t,s=!t||t.i;t||(t={}),e||(e=new te(r*3));var a=function(Y){var he=e.length;if(Y>he){var fe=new te(Math.max(he*2,Y));fe.set(e),e=fe}},o=t.f||0,l=t.p||0,c=t.b||0,u=t.l,d=t.d,h=t.m,m=t.n,w=r*8;do{if(!u){o=We(n,l,1);var f=We(n,l+1,3);if(l+=3,f)if(f==1)u=il,d=al,h=9,m=5;else if(f==2){var p=We(n,l,31)+257,g=We(n,l+10,15)+4,b=p+We(n,l+5,31)+1;l+=14;for(var y=new te(b),E=new te(19),_=0;_<g;++_)E[cn[_]]=We(n,l+_*3,7);l+=g*3;for(var v=cr(E),A=(1<<v)-1,x=je(E,v,1),_=0;_<b;){var k=x[We(n,l,A)];l+=k&15;var S=k>>>4;if(S<16)y[_++]=S;else{var T=0,D=0;for(S==16?(D=3+We(n,l,3),l+=2,T=y[_-1]):S==17?(D=3+We(n,l,7),l+=3):S==18&&(D=11+We(n,l,127),l+=7);D--;)y[_++]=T}}var R=y.subarray(0,p),U=y.subarray(p);h=cr(R),m=cr(U),u=je(R,h,1),d=je(U,m,1)}else j(1);else{var S=dn(l)+4,z=n[S-4]|n[S-3]<<8,O=S+z;if(O>r){s&&j(0);break}i&&a(c+z),e.set(n.subarray(S,O),c),t.b=c+=z,t.p=l=O*8,t.f=o;continue}if(l>w){s&&j(0);break}}i&&a(c+131072);for(var M=(1<<h)-1,P=(1<<m)-1,Z=l;;Z=l){var T=u[ur(n,l)&M],B=T>>>4;if(l+=T&15,l>w){s&&j(0);break}if(T||j(2),B<256)e[c++]=B;else if(B==256){Z=l,u=null;break}else{var q=B-254;if(B>264){var _=B-257,H=$t[_];q=We(n,l,(1<<H)-1)+Ni[_],l+=H}var W=d[ur(n,l)&P],K=W>>>4;W||j(3),l+=W&15;var U=nl[K];if(K>3){var H=Wt[K];U+=ur(n,l)&(1<<H)-1,l+=H}if(l>w){s&&j(0);break}i&&a(c+131072);for(var V=c+q;c<V;c+=4)e[c]=e[c-U],e[c+1]=e[c+1-U],e[c+2]=e[c+2-U],e[c+3]=e[c+3-U];c=V}}t.l=u,t.p=Z,t.b=c,t.f=o,u&&(o=1,t.m=h,t.d=d,t.n=m)}while(!o);return c==e.length?e:it(e,0,c)},rt=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>>8},Mt=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>>8,n[r+2]|=t>>>16},dr=function(n,e){for(var t=[],r=0;r<n.length;++r)n[r]&&t.push({s:r,f:n[r]});var i=t.length,s=t.slice();if(!i)return[ct,0];if(i==1){var a=new te(t[0].s+1);return a[t[0].s]=1,[a,1]}t.sort(function(_,v){return _.f-v.f}),t.push({s:-1,f:25001});var o=t[0],l=t[1],c=0,u=1,d=2;for(t[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=i-1;)o=t[t[c].f<t[d].f?c++:d++],l=t[c!=u&&t[c].f<t[d].f?c++:d++],t[u++]={s:-1,f:o.f+l.f,l:o,r:l};for(var h=s[0].s,r=1;r<i;++r)s[r].s>h&&(h=s[r].s);var m=new Ee(h+1),w=pr(t[u-1],m,0);if(w>e){var r=0,f=0,p=w-e,g=1<<p;for(s.sort(function(v,A){return m[A.s]-m[v.s]||v.f-A.f});r<i;++r){var b=s[r].s;if(m[b]>e)f+=g-(1<<w-m[b]),m[b]=e;else break}for(f>>>=p;f>0;){var y=s[r].s;m[y]<e?f-=1<<e-m[y]++-1:++r}for(;r>=0&&f;--r){var E=s[r].s;m[E]==e&&(--m[E],++f)}w=e}return[new te(m),w]},pr=function(n,e,t){return n.s==-1?Math.max(pr(n.l,e,t+1),pr(n.r,e,t+1)):e[n.s]=t},Li=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new Ee(++e),r=0,i=n[0],s=1,a=function(l){t[r++]=l},o=1;o<=e;++o)if(n[o]==i&&o!=e)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=n[o]}return[t.subarray(0,r),e]},Ut=function(n,e){for(var t=0,r=0;r<e.length;++r)t+=n[r]*e[r];return t},gr=function(n,e,t){var r=t.length,i=dn(e+2);n[i]=r&255,n[i+1]=r>>>8,n[i+2]=n[i]^255,n[i+3]=n[i+1]^255;for(var s=0;s<r;++s)n[i+s+4]=t[s];return(i+4+r)*8},Fi=function(n,e,t,r,i,s,a,o,l,c,u){rt(e,u++,t),++i[256];for(var d=dr(i,15),h=d[0],m=d[1],w=dr(s,15),f=w[0],p=w[1],g=Li(h),b=g[0],y=g[1],E=Li(f),_=E[0],v=E[1],A=new Ee(19),x=0;x<b.length;++x)A[b[x]&31]++;for(var x=0;x<_.length;++x)A[_[x]&31]++;for(var k=dr(A,7),S=k[0],T=k[1],D=19;D>4&&!S[cn[D-1]];--D);var R=c+5<<3,U=Ut(i,ut)+Ut(s,Pt)+a,z=Ut(i,h)+Ut(s,f)+a+14+3*D+Ut(A,S)+(2*A[16]+3*A[17]+7*A[18]);if(R<=U&&R<=z)return gr(e,u,n.subarray(l,l+c));var O,M,P,Z;if(rt(e,u,1+(z<U)),u+=2,z<U){O=je(h,m,0),M=h,P=je(f,p,0),Z=f;var B=je(S,T,0);rt(e,u,y-257),rt(e,u+5,v-1),rt(e,u+10,D-4),u+=14;for(var x=0;x<D;++x)rt(e,u+3*x,S[cn[x]]);u+=3*D;for(var q=[b,_],H=0;H<2;++H)for(var W=q[H],x=0;x<W.length;++x){var K=W[x]&31;rt(e,u,B[K]),u+=S[K],K>15&&(rt(e,u,W[x]>>>5&127),u+=W[x]>>>12)}}else O=rl,M=ut,P=sl,Z=Pt;for(var x=0;x<o;++x)if(r[x]>255){var K=r[x]>>>18&31;Mt(e,u,O[K+257]),u+=M[K+257],K>7&&(rt(e,u,r[x]>>>23&31),u+=$t[K]);var V=r[x]&31;Mt(e,u,P[V]),u+=Z[V],V>3&&(Mt(e,u,r[x]>>>5&8191),u+=Wt[V])}else Mt(e,u,O[r[x]]),u+=M[r[x]];return Mt(e,u,O[256]),u+M[256]},ll=new Ht([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ct=new te(0),cl=function(n,e,t,r,i,s){var a=n.length,o=new te(r+a+5*(1+Math.ceil(a/7e3))+i),l=o.subarray(r,o.length-i),c=0;if(!e||a<8)for(var u=0;u<=a;u+=65535){var d=u+65535;d>=a&&(l[c>>3]=s),c=gr(l,c+1,n.subarray(u,d))}else{for(var h=ll[e-1],m=h>>>13,w=h&8191,f=(1<<t)-1,p=new Ee(32768),g=new Ee(f+1),b=Math.ceil(t/3),y=2*b,E=function(De){return(n[De]^n[De+1]<<b^n[De+2]<<y)&f},_=new Ht(25e3),v=new Ee(288),A=new Ee(32),x=0,k=0,u=0,S=0,T=0,D=0;u<a;++u){var R=E(u),U=u&32767,z=g[R];if(p[U]=z,g[R]=U,T<=u){var O=a-u;if((x>7e3||S>24576)&&O>423){c=Fi(n,l,0,_,v,A,k,S,D,u-D,c),S=x=k=0,D=u;for(var M=0;M<286;++M)v[M]=0;for(var M=0;M<30;++M)A[M]=0}var P=2,Z=0,B=w,q=U-z&32767;if(O>2&&R==E(u-q))for(var H=Math.min(m,O)-1,W=Math.min(32767,u),K=Math.min(258,O);q<=W&&--B&&U!=z;){if(n[u+P]==n[u+P-q]){for(var V=0;V<K&&n[u+V]==n[u+V-q];++V);if(V>P){if(P=V,Z=q,V>H)break;for(var Y=Math.min(q,V-2),he=0,M=0;M<Y;++M){var fe=u-q+M+32768&32767,ze=p[fe],oe=fe-ze+32768&32767;oe>he&&(he=oe,z=fe)}}}U=z,z=p[U],q+=U-z+32768&32767}if(Z){_[S++]=268435456|fr[P]<<18|Di[Z];var Oe=fr[P]&31,ke=Di[Z]&31;k+=$t[Oe]+Wt[ke],++v[257+Oe],++A[ke],T=u+P,++x}else _[S++]=n[u],++v[n[u]]}}c=Fi(n,l,s,_,v,A,k,S,D,u-D,c),!s&&c&7&&(c=gr(l,c+1,ct))}return it(o,0,r+dn(c)+i)},ul=function(){for(var n=new Int32Array(256),e=0;e<256;++e){for(var t=e,r=9;--r;)t=(t&1&&-306674912)^t>>>1;n[e]=t}return n}(),Pi=function(){var n=-1;return{p:function(e){for(var t=n,r=0;r<e.length;++r)t=ul[t&255^e[r]]^t>>>8;n=t},d:function(){return~n}}},dl=function(){var n=1,e=0;return{p:function(t){for(var r=n,i=e,s=t.length|0,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)i+=r+=t[a];r=(r&65535)+15*(r>>16),i=(i&65535)+15*(i>>16)}n=r,e=i},d:function(){return n%=65521,e%=65521,(n&255)<<24|n>>>8<<16|(e&255)<<8|e>>>8}}},hn=function(n,e,t,r,i){return cl(n,e.level==null?6:e.level,e.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):12+e.mem,t,r,!i)},hl=function(n,e){var t={};for(var r in n)t[r]=n[r];for(var r in e)t[r]=e[r];return t},Go=function(n,e,t){for(var r=n(),i=n.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),a=0;a<r.length;++a){var o=r[a],l=s[a];if(typeof o=="function"){e+=";"+l+"=";var c=o.toString();if(o.prototype)if(c.indexOf("[native code]")!=-1){var u=c.indexOf(" ",8)+1;e+=c.slice(u,c.indexOf("(",u))}else{e+=c;for(var d in o.prototype)e+=";"+l+".prototype."+d+"="+o.prototype[d].toString()}else e+=c}else t[l]=o}return[e,t]},lr=[],bh=function(n){var e=[];for(var t in n)n[t].buffer&&e.push((n[t]=new n[t].constructor(n[t])).buffer);return e},yh=function(n,e,t,r){var i;if(!lr[t]){for(var s="",a={},o=n.length-1,l=0;l<o;++l)i=Go(n[l],s,a),s=i[0],a=i[1];lr[t]=Go(n[o],s,a)}var c=hl({},lr[t][1]);return wh(lr[t][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",t,c,bh(c),r)},Hi=function(){return[te,Ee,Ht,$t,Wt,cn,Ni,nl,il,al,un,ol,je,cr,We,ur,dn,it,j,wr,Ch,fl,Sh]},$i=function(){return[te,Ee,Ht,$t,Wt,cn,fr,Di,rl,ut,sl,Pt,un,ll,ct,je,rt,Mt,dr,pr,Li,Ut,gr,Fi,dn,it,cl,hn,Th,fl]},vh=function(){return[pl,ml,ne,Pi,ul]},xh=function(){return[gl,Eh]},_h=function(){return[wl,ne,dl]},Ah=function(){return[bl]},fl=function(n){return postMessage(n,[n.buffer])},Sh=function(n){return n&&n.size&&new te(n.size)};var Ve=function(n){return n.ondata=function(e,t){return postMessage([e,t],[e.buffer])},function(e){return n.push(e.data[0],e.data[1])}},jt=function(n,e,t,r,i){var s,a=yh(n,r,i,function(o,l){o?(a.terminate(),e.ondata.call(e,o)):(l[1]&&a.terminate(),e.ondata.call(e,o,l[0],l[1]))});a.postMessage(t),e.push=function(o,l){e.ondata||j(5),s&&e.ondata(j(4,0,1),null,!!l),a.postMessage([o,s=l],[o.buffer])},e.terminate=function(){a.terminate()}},Bt=function(n,e){return n[e]|n[e+1]<<8},Nt=function(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0},zi=function(n,e){return Nt(n,e)+Nt(n,e+4)*4294967296},ne=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},pl=function(n,e){var t=e.filename;if(n[0]=31,n[1]=139,n[2]=8,n[8]=e.level<2?4:e.level==9?2:0,n[9]=3,e.mtime!=0&&ne(n,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),t){n[3]=8;for(var r=0;r<=t.length;++r)n[r+10]=t.charCodeAt(r)}},gl=function(n){(n[0]!=31||n[1]!=139||n[2]!=8)&&j(6,"invalid gzip data");var e=n[3],t=10;e&4&&(t+=n[10]|(n[11]<<8)+2);for(var r=(e>>3&1)+(e>>4&1);r>0;r-=!n[t++]);return t+(e&2)},Eh=function(n){var e=n.length;return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0},ml=function(n){return 10+(n.filename&&n.filename.length+1||0)},wl=function(n,e){var t=e.level,r=t==0?0:t<6?1:t==9?3:2;n[0]=120,n[1]=r<<6|(r?32-2*r:1)},bl=function(n){((n[0]&15)!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)&&j(6,"invalid zlib data"),n[1]&32&&j(6,"invalid zlib data: preset dictionaries not supported")};function Wi(n,e){return!e&&typeof n=="function"&&(e=n,n={}),this.ondata=e,n}var dt=function(){function n(e,t){!t&&typeof e=="function"&&(t=e,e={}),this.ondata=t,this.o=e||{}}return n.prototype.p=function(e,t){this.ondata(hn(e,this.o,0,0,!t),t)},n.prototype.push=function(e,t){this.ondata||j(5),this.d&&j(4),this.d=t,this.p(e,t||!1)},n}(),kh=function(){function n(e,t){jt([$i,function(){return[Ve,dt]}],this,Wi.call(this,e,t),function(r){var i=new dt(r.data);onmessage=Ve(i)},6)}return n}();function Th(n,e){return hn(n,e||{},0,0)}var Be=function(){function n(e){this.s={},this.p=new te(0),this.ondata=e}return n.prototype.e=function(e){this.ondata||j(5),this.d&&j(4);var t=this.p.length,r=new te(t+e.length);r.set(this.p),r.set(e,t),this.p=r},n.prototype.c=function(e){this.d=this.s.i=e||!1;var t=this.s.b,r=wr(this.p,this.o,this.s);this.ondata(it(r,t,this.s.b),this.d),this.o=it(r,this.s.b-32768),this.s.b=this.o.length,this.p=it(this.p,this.s.p/8|0),this.s.p&=7},n.prototype.push=function(e,t){this.e(e),this.c(t)},n}(),yl=function(){function n(e){this.ondata=e,jt([Hi,function(){return[Ve,Be]}],this,0,function(){var t=new Be;onmessage=Ve(t)},7)}return n}();function Ch(n,e){return wr(n,e)}var Zo=function(){function n(e,t){this.c=Pi(),this.l=0,this.v=1,dt.call(this,e,t)}return n.prototype.push=function(e,t){dt.prototype.push.call(this,e,t)},n.prototype.p=function(e,t){this.c.p(e),this.l+=e.length;var r=hn(e,this.o,this.v&&ml(this.o),t&&8,!t);this.v&&(pl(r,this.o),this.v=0),t&&(ne(r,r.length-8,this.c.d()),ne(r,r.length-4,this.l)),this.ondata(r,t)},n}(),C0=function(){function n(e,t){jt([$i,vh,function(){return[Ve,dt,Zo]}],this,Wi.call(this,e,t),function(r){var i=new Zo(r.data);onmessage=Ve(i)},8)}return n}();var Oi=function(){function n(e){this.v=1,Be.call(this,e)}return n.prototype.push=function(e,t){if(Be.prototype.e.call(this,e),this.v){var r=this.p.length>3?gl(this.p):4;if(r>=this.p.length&&!t)return;this.p=this.p.subarray(r),this.v=0}t&&(this.p.length<8&&j(6,"invalid gzip data"),this.p=this.p.subarray(0,-8)),Be.prototype.c.call(this,t)},n}(),Rh=function(){function n(e){this.ondata=e,jt([Hi,xh,function(){return[Ve,Be,Oi]}],this,0,function(){var t=new Oi;onmessage=Ve(t)},9)}return n}();var Ko=function(){function n(e,t){this.c=dl(),this.v=1,dt.call(this,e,t)}return n.prototype.push=function(e,t){dt.prototype.push.call(this,e,t)},n.prototype.p=function(e,t){this.c.p(e);var r=hn(e,this.o,this.v&&2,t&&4,!t);this.v&&(wl(r,this.o),this.v=0),t&&ne(r,r.length-4,this.c.d()),this.ondata(r,t)},n}(),R0=function(){function n(e,t){jt([$i,_h,function(){return[Ve,dt,Ko]}],this,Wi.call(this,e,t),function(r){var i=new Ko(r.data);onmessage=Ve(i)},10)}return n}();var Mi=function(){function n(e){this.v=1,Be.call(this,e)}return n.prototype.push=function(e,t){if(Be.prototype.e.call(this,e),this.v){if(this.p.length<2&&!t)return;this.p=this.p.subarray(2),this.v=0}t&&(this.p.length<4&&j(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),Be.prototype.c.call(this,t)},n}(),Ih=function(){function n(e){this.ondata=e,jt([Hi,Ah,function(){return[Ve,Be,Mi]}],this,0,function(){var t=new Mi;onmessage=Ve(t)},11)}return n}();function vl(n,e){return wr((bl(n),n.subarray(2,-4)),e)}var zh=function(){function n(e){this.G=Oi,this.I=Be,this.Z=Mi,this.ondata=e}return n.prototype.push=function(e,t){if(this.ondata||j(5),this.s)this.s.push(e,t);else{if(this.p&&this.p.length){var r=new te(this.p.length+e.length);r.set(this.p),r.set(e,this.p.length)}else this.p=e;if(this.p.length>2){var i=this,s=function(){i.ondata.apply(i,arguments)};this.s=this.p[0]==31&&this.p[1]==139&&this.p[2]==8?new this.G(s):(this.p[0]&15)!=8||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(s):new this.Z(s),this.s.push(this.p,t),this.p=null}}},n}(),I0=function(){function n(e){this.G=Rh,this.I=yl,this.Z=Ih,this.ondata=e}return n.prototype.push=function(e,t){zh.prototype.push.call(this,e,t)},n}();var Yo=typeof TextEncoder<"u"&&new TextEncoder,Ui=typeof TextDecoder<"u"&&new TextDecoder,xl=0;try{Ui.decode(ct,{stream:!0}),xl=1}catch{}var _l=function(n){for(var e="",t=0;;){var r=n[t++],i=(r>127)+(r>223)+(r>239);if(t+i>n.length)return[e,it(n,t-1)];i?i==3?(r=((r&15)<<18|(n[t++]&63)<<12|(n[t++]&63)<<6|n[t++]&63)-65536,e+=String.fromCharCode(55296|r>>10,56320|r&1023)):i&1?e+=String.fromCharCode((r&31)<<6|n[t++]&63):e+=String.fromCharCode((r&15)<<12|(n[t++]&63)<<6|n[t++]&63):e+=String.fromCharCode(r)}},z0=function(){function n(e){this.ondata=e,xl?this.t=new TextDecoder:this.p=ct}return n.prototype.push=function(e,t){if(this.ondata||j(5),t=!!t,this.t){this.ondata(this.t.decode(e,{stream:!0}),t),t&&(this.t.decode().length&&j(8),this.t=null);return}this.p||j(4);var r=new te(this.p.length+e.length);r.set(this.p),r.set(e,this.p.length);var i=_l(r),s=i[0],a=i[1];t?(a.length&&j(8),this.p=null):this.p=a,this.ondata(s,t)},n}(),D0=function(){function n(e){this.ondata=e}return n.prototype.push=function(e,t){this.ondata||j(5),this.d&&j(4),this.ondata(Bi(e),this.d=t||!1)},n}();function Bi(n,e){if(e){for(var t=new te(n.length),r=0;r<n.length;++r)t[r]=n.charCodeAt(r);return t}if(Yo)return Yo.encode(n);for(var i=n.length,s=new te(n.length+(n.length>>1)),a=0,o=function(d){s[a++]=d},r=0;r<i;++r){if(a+5>s.length){var l=new te(a+8+(i-r<<1));l.set(s),s=l}var c=n.charCodeAt(r);c<128||e?o(c):c<2048?(o(192|c>>6),o(128|c&63)):c>55295&&c<57344?(c=65536+(c&1047552)|n.charCodeAt(++r)&1023,o(240|c>>18),o(128|c>>12&63),o(128|c>>6&63),o(128|c&63)):(o(224|c>>12),o(128|c>>6&63),o(128|c&63))}return it(s,0,a)}function Dh(n,e){if(e){for(var t="",r=0;r<n.length;r+=16384)t+=String.fromCharCode.apply(null,n.subarray(r,r+16384));return t}else{if(Ui)return Ui.decode(n);var i=_l(n),s=i[0],a=i[1];return a.length&&j(8),s}}var Al=function(n){return n==1?3:n<6?2:n==9?1:0};var Lh=function(n,e){for(;Bt(n,e)!=1;e+=4+Bt(n,e+2));return[zi(n,e+12),zi(n,e+4),zi(n,e+20)]},hr=function(n){var e=0;if(n)for(var t in n){var r=n[t].length;r>65535&&j(9),e+=r+4}return e},Jo=function(n,e,t,r,i,s,a,o){var l=r.length,c=t.extra,u=o&&o.length,d=hr(c);ne(n,e,a!=null?33639248:67324752),e+=4,a!=null&&(n[e++]=20,n[e++]=t.os),n[e]=20,e+=2,n[e++]=t.flag<<1|(s<0&&8),n[e++]=i&&8,n[e++]=t.compression&255,n[e++]=t.compression>>8;var h=new Date(t.mtime==null?Date.now():t.mtime),m=h.getFullYear()-1980;if((m<0||m>119)&&j(10),ne(n,e,m<<25|h.getMonth()+1<<21|h.getDate()<<16|h.getHours()<<11|h.getMinutes()<<5|h.getSeconds()>>>1),e+=4,s!=-1&&(ne(n,e,t.crc),ne(n,e+4,s<0?-s-2:s),ne(n,e+8,t.size)),ne(n,e+12,l),ne(n,e+14,d),e+=16,a!=null&&(ne(n,e,u),ne(n,e+6,t.attrs),ne(n,e+10,a),e+=14),n.set(r,e),e+=l,d)for(var w in c){var f=c[w],p=f.length;ne(n,e,+w),ne(n,e+2,p),n.set(f,e+4),e+=4+p}return u&&(n.set(o,e),e+=u),e},Fh=function(n,e,t,r,i){ne(n,e,101010256),ne(n,e+8,t),ne(n,e+10,t),ne(n,e+12,r),ne(n,e+16,i)},mr=function(){function n(e){this.filename=e,this.c=Pi(),this.size=0,this.compression=0}return n.prototype.process=function(e,t){this.ondata(null,e,t)},n.prototype.push=function(e,t){this.ondata||j(5),this.c.p(e),this.size+=e.length,t&&(this.crc=this.c.d()),this.process(e,t||!1)},n}(),L0=function(){function n(e,t){var r=this;t||(t={}),mr.call(this,e),this.d=new dt(t,function(i,s){r.ondata(null,i,s)}),this.compression=8,this.flag=Al(t.level)}return n.prototype.process=function(e,t){try{this.d.push(e,t)}catch(r){this.ondata(r,null,t)}},n.prototype.push=function(e,t){mr.prototype.push.call(this,e,t)},n}(),F0=function(){function n(e,t){var r=this;t||(t={}),mr.call(this,e),this.d=new kh(t,function(i,s,a){r.ondata(i,s,a)}),this.compression=8,this.flag=Al(t.level),this.terminate=this.d.terminate}return n.prototype.process=function(e,t){this.d.push(e,t)},n.prototype.push=function(e,t){mr.prototype.push.call(this,e,t)},n}(),O0=function(){function n(e){this.ondata=e,this.u=[],this.d=1}return n.prototype.add=function(e){var t=this;if(this.ondata||j(5),this.d&2)this.ondata(j(4+(this.d&1)*8,0,1),null,!1);else{var r=Bi(e.filename),i=r.length,s=e.comment,a=s&&Bi(s),o=i!=e.filename.length||a&&s.length!=a.length,l=i+hr(e.extra)+30;i>65535&&this.ondata(j(11,0,1),null,!1);var c=new te(l);Jo(c,0,e,r,o,-1);var u=[c],d=function(){for(var p=0,g=u;p<g.length;p++){var b=g[p];t.ondata(null,b,!1)}u=[]},h=this.d;this.d=0;var m=this.u.length,w=hl(e,{f:r,u:o,o:a,t:function(){e.terminate&&e.terminate()},r:function(){if(d(),h){var p=t.u[m+1];p?p.r():t.d=1}h=1}}),f=0;e.ondata=function(p,g,b){if(p)t.ondata(p,g,b),t.terminate();else if(f+=g.length,u.push(g),b){var y=new te(16);ne(y,0,134695760),ne(y,4,e.crc),ne(y,8,f),ne(y,12,e.size),u.push(y),w.c=f,w.b=l+f+16,w.crc=e.crc,w.size=e.size,h&&w.r(),h=1}else h&&d()},this.u.push(w)}},n.prototype.end=function(){var e=this;if(this.d&2){this.ondata(j(4+(this.d&1)*8,0,1),null,!0);return}this.d?this.e():this.u.push({r:function(){e.d&1&&(e.u.splice(-1,1),e.e())},t:function(){}}),this.d=3},n.prototype.e=function(){for(var e=0,t=0,r=0,i=0,s=this.u;i<s.length;i++){var a=s[i];r+=46+a.f.length+hr(a.extra)+(a.o?a.o.length:0)}for(var o=new te(r+22),l=0,c=this.u;l<c.length;l++){var a=c[l];Jo(o,e,a,a.f,a.u,-a.c-2,t,a.o),e+=46+a.f.length+hr(a.extra)+(a.o?a.o.length:0),t+=a.b}Fh(o,e,this.u.length,r,t),this.ondata(null,o,!0),this.d=2},n.prototype.terminate=function(){for(var e=0,t=this.u;e<t.length;e++){var r=t[e];r.t()}this.d=2},n}();var Oh=function(){function n(){}return n.prototype.push=function(e,t){this.ondata(null,e,t)},n.compression=0,n}(),M0=function(){function n(){var e=this;this.i=new Be(function(t,r){e.ondata(null,t,r)})}return n.prototype.push=function(e,t){try{this.i.push(e,t)}catch(r){this.ondata(r,null,t)}},n.compression=8,n}(),U0=function(){function n(e,t){var r=this;t<32e4?this.i=new Be(function(i,s){r.ondata(null,i,s)}):(this.i=new yl(function(i,s,a){r.ondata(i,s,a)}),this.terminate=this.i.terminate)}return n.prototype.push=function(e,t){this.i.terminate&&(e=it(e,0)),this.i.push(e,t)},n.compression=8,n}(),B0=function(){function n(e){this.onfile=e,this.k=[],this.o={0:Oh},this.p=ct}return n.prototype.push=function(e,t){var r=this;if(this.onfile||j(5),this.p||j(4),this.c>0){var i=Math.min(this.c,e.length),s=e.subarray(0,i);if(this.c-=i,this.d?this.d.push(s,!this.c):this.k[0].push(s),e=e.subarray(i),e.length)return this.push(e,t)}else{var a=0,o=0,l=void 0,c=void 0;this.p.length?e.length?(c=new te(this.p.length+e.length),c.set(this.p),c.set(e,this.p.length)):c=this.p:c=e;for(var u=c.length,d=this.c,h=d&&this.d,m=function(){var g,b=Nt(c,o);if(b==67324752){a=1,l=o,w.d=null,w.c=0;var y=Bt(c,o+6),E=Bt(c,o+8),_=y&2048,v=y&8,A=Bt(c,o+26),x=Bt(c,o+28);if(u>o+30+A+x){var k=[];w.k.unshift(k),a=2;var S=Nt(c,o+18),T=Nt(c,o+22),D=Dh(c.subarray(o+30,o+=30+A),!_);S==4294967295?(g=v?[-2]:Lh(c,o),S=g[0],T=g[1]):v&&(S=-1),o+=x,w.c=S;var R,U={name:D,compression:E,start:function(){if(U.ondata||j(5),!S)U.ondata(null,ct,!0);else{var z=r.o[E];z||U.ondata(j(14,"unknown compression type "+E,1),null,!1),R=S<0?new z(D):new z(D,S,T),R.ondata=function(Z,B,q){U.ondata(Z,B,q)};for(var O=0,M=k;O<M.length;O++){var P=M[O];R.push(P,!1)}r.k[0]==k&&r.c?r.d=R:R.push(ct,!0)}},terminate:function(){R&&R.terminate&&R.terminate()}};S>=0&&(U.size=S,U.originalSize=T),w.onfile(U)}return"break"}else if(d){if(b==134695760)return l=o+=12+(d==-2&&8),a=3,w.c=0,"break";if(b==33639248)return l=o-=4,a=3,w.c=0,"break"}},w=this;o<u-4;++o){var f=m();if(f==="break")break}if(this.p=ct,d<0){var p=a?c.subarray(0,l-12-(d==-2&&8)-(Nt(c,l-16)==134695760&&4)):c.subarray(0,o);h?h.push(p,!!a):this.k[+(a==2)].push(p)}if(a&2)return this.push(c.subarray(o),t);this.p=c.subarray(o)}t&&(this.c&&j(13),this.p=null)},n.prototype.register=function(e){this.o[e.compression]=e},n}();var{ZipReader:Uh,BlobReader:Bh,TextWriter:Nh,BlobWriter:Ph}=Ii;ir({useWebWorkers:!1});var Hh=async n=>{let e=new Uint8Array(await n.slice(0,4).arrayBuffer());return e[0]===80&&e[1]===75&&e[2]===3&&e[3]===4},$h=async n=>{let t=await new Uh(new Bh(n)).getEntries();n.name&&n.name.endsWith(".zip")&&t.every(c=>c.filename.startsWith(n.name.slice(0,-4)+"/"))&&(t=t.map(c=>(c.filename=c.filename.slice(n.name.length-3),c)));let r=new Map(t.map(l=>[l.filename,l])),i=l=>(c,...u)=>r.has(c)?l(r.get(c),...u):null,s=i(l=>l.getData(new Nh)),a=i((l,c)=>l.getData(new Ph(c)));return{entries:t,loadText:s,loadBlob:a,getSize:l=>r.get(l)?.uncompressedSize??0}},Sl=async n=>n.isFile?n:(await Promise.all(Array.from(await new Promise((e,t)=>n.createReader().readEntries(r=>e(r),r=>t(r))),Sl))).flat(),Wh=async n=>{let e=await Sl(n),t=await Promise.all(e.map(u=>new Promise((d,h)=>u.file(m=>d([m,u.fullPath]),m=>h(m))))),r=new Map(t.map(([u,d])=>[d.replace(n.fullPath+"/",""),u])),i=new TextDecoder,s=u=>u?i.decode(u):null,a=u=>r.get(u)?.arrayBuffer()??null;return{loadText:async u=>s(await a(u)),loadBlob:u=>r.get(u),getSize:u=>r.get(u)?.size??0}},jh=({name:n,type:e})=>e==="application/vnd.comicbook+zip"||n.endsWith(".cbz"),Vh=({name:n,type:e})=>e==="application/x-fictionbook+xml"||n.endsWith(".fb2"),qh=({name:n,type:e})=>e==="application/x-zip-compressed-fb2"||n.endsWith(".fb2.zip")||n.endsWith(".fbz"),Xh=async(n,e)=>{let t="";n&&n.name&&(t=us(n.name+"-"+(n.size||"directory")));let r;if(n.isDirectory){let a=await Wh(n);r=await new Kt(a).init()}else if(n.size)if(await Hh(n)){let a=await $h(n);if(jh(n))r=Ts(a,n);else if(qh(n)){let{entries:o}=a,l=o.find(u=>u.filename.endsWith(".fb2")),c=await a.loadBlob((l??o[0]).filename);r=await Fr(c)}else r=await new Kt(a).init()}else await Ns(n)?r=await new Fn({unzlib:vl}).open(n):Vh(n)&&(r=await Fr(n));else throw new Error("File not found");r||alert("File type not supported"),r._hash=t;let i=new Tn(r,e),s=await i.display();return document.body.append(s),i},Gh=({spacing:n,justify:e,hyphenate:t})=>`
    @namespace epub "http://www.idpf.org/2007/ops";
    html {
        color-scheme: light dark;
    }
    /* https://github.com/whatwg/html/issues/5426 */
    @media (prefers-color-scheme: dark) {
        a:link {
            color: lightblue;
        }
    }
    p, li, blockquote, dd {
        line-height: ${n};
        text-align: ${e?"justify":"start"};
        -webkit-hyphens: ${t?"auto":"manual"};
        hyphens: ${t?"auto":"manual"};
        -webkit-hyphenate-limit-before: 3;
        -webkit-hyphenate-limit-after: 2;
        -webkit-hyphenate-limit-lines: 2;
        hanging-punctuation: allow-end last;
        widows: 2;
    }
    /* prevent the above from overriding the align attribute */
    [align="left"] { text-align: left; }
    [align="right"] { text-align: right; }
    [align="center"] { text-align: center; }
    [align="justify"] { text-align: justify; }

    pre {
        white-space: pre-wrap !important;
    }
    aside[epub|type~="endnote"],
    aside[epub|type~="footnote"],
    aside[epub|type~="note"],
    aside[epub|type~="rearnote"] {
        display: none;
    }
`,Zh="en",Kh=new Intl.NumberFormat(Zh,{style:"percent"}),re=document.querySelector.bind(document),ji=class{#e;style={spacing:1.4,justify:!0,hyphenate:!0};layout={margin:48,gap:48,maxColumnWidth:720};closeSideBar(){re("#dimming-overlay").classList.remove("show"),re("#side-bar").classList.remove("show")}constructor(){re("#side-bar-button").addEventListener("click",()=>{re("#dimming-overlay").classList.add("show"),re("#side-bar").classList.add("show")}),re("#dimming-overlay").addEventListener("click",()=>this.closeSideBar());let e=Ss([{name:"layout",label:"Layout",type:"radio",items:[["Paginated","paginated"],["Scrolled","scrolled"]],onclick:t=>{this.layout.flow=t,this.setAppearance()}}]);e.element.classList.add("menu"),re("#menu-button").append(e.element),re("#menu-button > button").addEventListener("click",()=>e.element.classList.toggle("show")),e.groups.layout.select("paginated")}async open(e){this.view=await Xh(e,this.#t.bind(this));let{book:t}=this.view;this.setAppearance(),this.view.renderer.next(),re("#header-bar").style.visibility="visible",re("#nav-bar").style.visibility="visible",re("#left-button").addEventListener("click",()=>this.view.goLeft()),re("#right-button").addEventListener("click",()=>this.view.goRight()),re("#left-big-bar").classList.remove("none"),re("#right-big-bar").classList.remove("none"),re("#left-big-bar").addEventListener("click",()=>this.view.goLeft()),re("#right-big-bar").addEventListener("click",()=>this.view.goRight());let r=re("#progress-slider");r.dir=t.dir,r.addEventListener("input",l=>this.view.goToFraction(parseFloat(l.target.value)));let i=t.sections.filter(l=>l.linear!=="no").map(l=>l.size);if(i.length<100){let l=i.reduce((u,d)=>u+d,0),c=0;for(let u of i.slice(0,-1)){c+=u;let d=document.createElement("option");d.value=c/l,re("#tick-marks").append(d)}}document.addEventListener("keydown",this.#n.bind(this));let s=t.metadata?.title??"Untitled Book";document.title=s,re("#side-bar-title").innerText=s;let a=t.metadata?.author;re("#side-bar-author").innerText=typeof a=="string"?a:a?.map(l=>typeof l=="string"?l:l.name)?.join(", ")??"",Promise.resolve(t.getCover?.())?.then(l=>l?re("#side-bar-cover").src=URL.createObjectURL(l):null);let o=t.toc;o&&(this.#e=As(o,l=>{this.view.goTo(l).catch(c=>{}),this.closeSideBar()}),re("#toc-view").append(this.#e.element))}setAppearance=()=>{this.view?.setAppearance({css:Gh(this.style),layout:this.layout});let e=this.layout.flow==="scrolled";document.documentElement.classList.toggle("scrolled",e)};#t(e){switch(e.type){case"loaded":this.#r(e);break;case"relocated":this.#i(e);break;case"reference":this.#s(e);break;case"external-link":globalThis.open(e.uri,"_blank");break}}#n(e){let t=e.key;t==="ArrowLeft"||t==="h"?this.view.goLeft():(t==="ArrowRight"||t==="l")&&this.view.goRight()}#r({doc:e}){e.addEventListener("keydown",this.#n.bind(this)),document.dispatchEvent(new CustomEvent("immersiveTranslateEbookLoaded"))}lastTocItemhref="";#i(e){let{fraction:t,location:r,tocItem:i,pageItem:s}=e,a=Kh.format(t),o=s?`Page ${s.label}`:`Loc ${r.current}`,l=re("#progress-slider");l.style.visibility="visible",l.value=t,l.title=`${a} \xB7 ${o}`,i?.href&&i?.href!=this.lastTocItemhref&&(this.lastTocItemhref=i?.href,this.#e?.setCurrentHref?.(i.href))}#s(e){let{content:t,element:r}=e,{point:i,dir:s}=xs(r),a=document.createElement("iframe");a.sandbox="allow-same-origin",a.srcdoc=t,a.onload=()=>{let u=a.contentDocument;u.documentElement.style.colorScheme="light dark",u.body.style.margin="18px"},Object.assign(a.style,{border:"0",width:"100%",height:"100%"});let{popover:o,arrow:l,overlay:c}=ks(300,250,i,s);c.style.zIndex=3,o.style.zIndex=3,l.style.zIndex=3,o.append(a),document.body.append(c),document.body.append(o),document.body.append(l)}},El=async n=>{document.body.removeChild(re("#drop-target"));let e=new ji;globalThis.reader=e,await e.open(n)},Yh=n=>n.preventDefault(),Jh=n=>{n.preventDefault();let e=Array.from(n.dataTransfer.items).find(t=>t.kind==="file");if(e){let t=e.webkitGetAsEntry();El(t.isFile?e.getAsFile():t).catch(r=>{})}},kl=re("#drop-target");kl.addEventListener("drop",Jh);kl.addEventListener("dragover",Yh);re("#file-input").addEventListener("change",n=>El(n.target.files[0]).catch(e=>{}));re("#file-button").addEventListener("click",()=>{document.querySelector("#file-input").click()});})();
